{"componentChunkName":"component---src-templates-post-js","path":"/metricas-logs-o-monitorizacion","result":{"data":{"markdownRemark":{"html":"<h1 id=\"graphite--grafana--centreon\"><a href=\"#graphite--grafana--centreon\" aria-label=\"graphite  grafana  centreon permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Graphite + Grafana + Centreon</h1>\n<p>Descripción</p>\n<p>Utiliza una de las instancias de OpenStack y realiza una de las partes que elijas entre las siguientes sobre el servidor de OVH, dulcinea, sancho, quijote y frestón:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Métricas: recolección, gestión centralizada, filtrado o selección de los parámetros relevantes y representación gráfica que permita controlar la evolución temporal de parámetros esenciales de todos los servidores.\nMonitorización: Configuración de un sistema de monitorización que controle servidores y servicios en tiempo real y envíe alertas por uso excesivo de recursos (memoria, disco raíz, etc.) y disponibilidad de los servicios. Alertas por correo, telegram, etc.\nGestión de logs: Implementa un sistema que centralice los logs de todos los servidores y que filtre los registros con prioridad error, critical, alert o emergency. Representa gráficamente los datos relevantes extraídos de los logs o configura el envío por correo al administrador de los logs relevantes (una opción o ambas).</code></pre></div>\n<p>Detalla en la documentación claramente las características de la implementación elegida, así como la forma de poder verificarla (envía si es necesario usuario y contraseña por correo a los profesores, para el panel web si lo hubiera, p.ej.).</p>\n<p>Antes de comenzar la tarea debes notificarla en la wiki y debes elegir un conjunto de herramientas diferentes a las elegidas por tus compañeros.</p>\n<h2 id=\"graphite\"><a href=\"#graphite\" aria-label=\"graphite permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Graphite</h2>\n<p>Requerimientos</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> yum -y update\n<span class=\"token function\">sudo</span> yum -y <span class=\"token function\">install</span> httpd gcc gcc-c++ <span class=\"token function\">git</span> pycairo mod_wsgi epel-release\n<span class=\"token function\">sudo</span> yum -y <span class=\"token function\">install</span> python-pip python-devel blas-devel lapack-devel libffi-devel</code></pre></div>\n<p>Descarga e instalación</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token builtin class-name\">cd</span> /usr/local/src\n<span class=\"token function\">sudo</span> <span class=\"token function\">git</span> clone https://github.com/graphite-project/graphite-web.git\n<span class=\"token function\">sudo</span> <span class=\"token function\">git</span> clone https://github.com/graphite-project/carbon.git\n \n<span class=\"token function\">sudo</span> pip <span class=\"token function\">install</span> -r /usr/local/src/graphite-web/requirements.txt\n \n<span class=\"token builtin class-name\">cd</span> /usr/local/src/carbon/\n<span class=\"token function\">sudo</span> python setup.py <span class=\"token function\">install</span>\n \n<span class=\"token builtin class-name\">cd</span> /usr/local/src/graphite-web/\n<span class=\"token function\">sudo</span> python setup.py <span class=\"token function\">install</span>\n \n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/conf/carbon.conf.example /opt/graphite/conf/carbon.conf\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/conf/storage-schemas.conf.example /opt/graphite/conf/storage-schemas.conf\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/conf/storage-aggregation.conf.example /opt/graphite/conf/storage-aggregation.conf\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/conf/relay-rules.conf.example /opt/graphite/cyum <span class=\"token function\">install</span> collectd collectd-snmponf/relay-rules.conf\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/webapp/graphite/local_settings.py.example /opt/graphite/webapp/graphite/local_settings.py\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/conf/graphite.wsgi.example /opt/graphite/conf/graphite.wsgi\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /opt/graphite/examples/example-graphite-vhost.conf /etc/httpd/conf.d/graphite.conf\n \n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /usr/local/src/carbon/distro/redhat/init.d/carbon-* /etc/init.d/\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> +x /etc/init.d/carbon-*</code></pre></div>\n<p>pip3 install 'django&#x3C;1.6'\npip3 install 'Twisted&#x3C;12'\npip3 install django-tagging\npip3 install whisper\npip3 install graphite-web\npip3 install carbon</p>\n<p>yum install collectd collectd-snmp</p>\n<p>cp /opt/graphite/examples/example-graphite-vhost.conf /etc/httpd/conf.d/graphite.conf\ncp /opt/graphite/conf/storage-schemas.conf.example /opt/graphite/conf/storage-schemas.conf\ncp /opt/graphite/conf/storage-aggregation.conf.example /opt/graphite/conf/storage-aggregation.conf\ncp /opt/graphite/conf/graphite.wsgi.example /opt/graphite/conf/graphite.wsgi\ncp /opt/graphite/conf/graphTemplates.conf.example /opt/graphite/conf/graphTemplates.conf\ncp /opt/graphite/conf/carbon.conf.example /opt/graphite/conf/carbon.conf</p>\n<p>chown -R apache:apache /opt/graphite/storage/</p>\n<p>vi /opt/graphite/conf/storage-schemas.conf</p>\n<p>[default]\npattern = .*\nretentions = 10s:4h, 1m:3d, 5m:8d, 15m:32d, 1h:1y</p>\n<p>[centos@quijote graphite]$ systemctl status carbon-cache.service\n● carbon-cache.service - SYSV: carbon-cache\nLoaded: loaded (/etc/rc.d/init.d/carbon-cache; generated)\nActive: inactive (dead)\nDocs: man:systemd-sysv-generator(8)\n[centos@quijote graphite]$ systemctl start carbon-cache.service\n==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-units ====\nAuthentication is required to start 'carbon-cache.service'.\nAuthenticating as: Cloud User (centos)\nPassword:\n==== AUTHENTICATION COMPLETE ====\n[centos@quijote graphite]$ systemctl status carbon-cache.service\n● carbon-cache.service - SYSV: carbon-cache\nLoaded: loaded (/etc/rc.d/init.d/carbon-cache; generated)\nActive: active (running) since Mon 2021-02-01 11:30:19 UTC; 8s ago\nDocs: man:systemd-sysv-generator(8)\nProcess: 1144 ExecStart=/etc/rc.d/init.d/carbon-cache start (code=exited, status=0/SUCCESS)\nTasks: 3 (limit: 2591)\nMemory: 31.4M\nCGroup: /system.slice/carbon-cache.service\n└─1161 /usr/bin/python3.6 bin/carbon-cache.py --instance=a start</p>\n<p>Feb 01 11:30:17 quijote.madu.gonzalonazareno.org systemd[1]: Starting SYSV: carbon-cache...\nFeb 01 11:30:17 quijote.madu.gonzalonazareno.org carbon-cache[1144]: Starting carbon-cache:a...\nFeb 01 11:30:19 quijote.madu.gonzalonazareno.org carbon-cache[1144]: [  OK  ]\nFeb 01 11:30:19 quijote.madu.gonzalonazareno.org systemd[1]: Started SYSV: carbon-cache.</p>\n<p>Editamos el fichero de bienvenida y lo comentamos todo con almohadillas (#).\nvim /etc/httpd/conf.d/welcome.conf</p>\n<p>Modificamos el fichero ‘/etc/httpd/conf.d/graphite-web.conf’ para permitir acceso desde cualquier IP:</p>\n<h1 id=\"graphite-web-basic-mod-wsgi-vhost\"><a href=\"#graphite-web-basic-mod-wsgi-vhost\" aria-label=\"graphite web basic mod wsgi vhost permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Graphite Web Basic mod wsgi vhost</h1>\n<p>&#x3C;VirtualHost *:80>\n##ServerName graphite-web\nDocumentRoot \"/usr/share/graphite/webapp\"\nErrorLog /var/log/httpd/graphite-web-error.log\nCustomLog /var/log/httpd/graphite-web-access.log common</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    # Header set Access-Control-Allow-Origin &quot;*&quot; \n    # Header set Access-Control-Allow-Methods &quot;GET, OPTIONS&quot; \n    # Header set Access-Control-Allow-Headers &quot;origin, authorization, accept&quot; \n    # Header set Access-Control-Allow-Credentials true \n\n    VSGIScriptAlias / /usr/share/graphite/graphite-web.wsgi\n    VSGIImportScript /usr/share/graphite/graphite-web.wsgi process-group=&quot;i(GLOBAL) application-grou$\n\n    &lt;Location &quot;/content/&quot;&gt; \n            SetHandler None \n    &lt;/Location&gt;\n\n    Alias /media/ &quot;/usr/lib/python2.7/site-packages/django/contrib/admin/media,&quot;\n\n    &lt;Location &quot;/media/&quot;&gt; \n            SetHandler None \n    &lt;/Location&gt;\n\n    &lt;Directory &quot;/usr/share/graphite/&quot;&gt; \n            &lt;IfModule mod_authz_core.c&gt; \n                    # Apache 2.4 \n                    #Require local Require all granted \n            &lt;/IfModule&gt; \n            &lt;IfModule !mod_authz_core.c&gt; \n                    # Apache 2.2 \n                    Order Deny,Allow \n                    #Deny from all \n                    #Allow from 127.0.0.1 \n                    #Allow from ::1 \n                    Allow from all \n            &lt;/IfModule&gt; \n    &lt;/Directory&gt;</code></pre></div>\n</VirtualHost> \n<hr>","timeToRead":4,"excerpt":"Graphite + Grafana + Centreon Descripción Utiliza una de las instancias de OpenStack y realiza una de las partes que elijas entre las…","frontmatter":{"title":"Métricas, logs o monitorización","cover":"https://img.icons8.com/ios/452/work.png","date":"2021-02-01T00:00:00.000Z","categories":["ASO"],"tags":["Métricas","Logs","Monitorización","Graphite","Grafana","Centreon"]},"fields":{"slug":"/metricas-logs-o-monitorizacion","date":"January 31, 2021"}}},"pageContext":{"slug":"/metricas-logs-o-monitorizacion","nexttitle":"Práctica Umbral de Rentabilidad","nextslug":"/practica-umbral-de-rentabilidad","prevtitle":"Práctica 2: rclone - Gestionando nuestro almacenamiento en la nube (unidad 1)","prevslug":"/practica-2-rclone-gestionando-nuestro-almacenamiento-en-la-nube-unidad-1"}}}