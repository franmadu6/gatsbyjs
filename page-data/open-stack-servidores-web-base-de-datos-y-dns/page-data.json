{"componentChunkName":"component---src-templates-post-js","path":"/open-stack-servidores-web-base-de-datos-y-dns","result":{"data":{"markdownRemark":{"html":"<p><a href=\"https://dit.gonzalonazareno.org/redmine/projects/asir2/wiki/Servidores_Web_y_DNS\">https://dit.gonzalonazareno.org/redmine/projects/asir2/wiki/Servidores_Web_y_DNS</a></p>\n<h2 id=\"servidor-dns\"><a href=\"#servidor-dns\" aria-label=\"servidor dns permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Servidor DNS</h2>\n<p>El primer paso será instalar bind9 en nuestro servidro</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># apt-get install bind9</span></code></pre></div>\n<p>Modificaremos /etc/bind/named.conf.options para establecer las opciones de nuestro DNS.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /etc/bind/named.conf.options</span>\nlisten-on <span class=\"token punctuation\">{</span> any<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nallow-transfer <span class=\"token punctuation\">{</span> none<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nrecursion <span class=\"token function\">yes</span><span class=\"token punctuation\">;</span>\nallow-recursion <span class=\"token punctuation\">{</span> any<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h3 id=\"configuración-dns-localdmzexterna\"><a href=\"#configuraci%C3%B3n-dns-localdmzexterna\" aria-label=\"configuración dns localdmzexterna permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Configuración DNS local,DMZ,Externa.</h3>\n<p>En /etc/bind/named.conf.local</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">view interna <span class=\"token punctuation\">{</span>\n        match-clients <span class=\"token punctuation\">{</span> <span class=\"token number\">10.0</span>.1.0/24<span class=\"token punctuation\">;</span> localhost<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"madu.gonzalonazareno.org\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.madu.interna\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"1.0.10.in-addr.arpa\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.1.0.10\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"2.0.10.in-addr.arpa\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.2.0.10\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        include <span class=\"token string\">\"/etc/bind/zones.rfc1918\"</span><span class=\"token punctuation\">;</span>\n        include <span class=\"token string\">\"/etc/bind/named.conf.default-zones\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nview dmz <span class=\"token punctuation\">{</span>\n        match-clients <span class=\"token punctuation\">{</span> <span class=\"token number\">10.0</span>.2.0/24<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"madu.gonzalonazareno.org\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.madu.dmz\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"1.0.10.in-addr.arpa\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.1.0.10\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"2.0.10.in-addr.arpa\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.2.0.10\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        include <span class=\"token string\">\"/etc/bind/zones.rfc1918\"</span><span class=\"token punctuation\">;</span>\n        include <span class=\"token string\">\"/etc/bind/named.conf.default-zones\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nview externa <span class=\"token punctuation\">{</span>\n        match-clients <span class=\"token punctuation\">{</span> <span class=\"token number\">172.22</span>.0.0/15<span class=\"token punctuation\">;</span> <span class=\"token number\">192.168</span>.202.2<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        zone <span class=\"token string\">\"madu.gonzalonazareno.org\"</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token builtin class-name\">type</span> master<span class=\"token punctuation\">;</span>\n                <span class=\"token function\">file</span> <span class=\"token string\">\"db.madu.externa\"</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n        include <span class=\"token string\">\"/etc/bind/zones.rfc1918\"</span><span class=\"token punctuation\">;</span>\n        include <span class=\"token string\">\"/etc/bind/named.conf.default-zones\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Deberemos comentar la siguiente linea en /etc/bind/named.conf</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">include <span class=\"token string\">\"/etc/bind/named.conf.options\"</span><span class=\"token punctuation\">;</span>\ninclude <span class=\"token string\">\"/etc/bind/named.conf.local\"</span><span class=\"token punctuation\">;</span>\n//include <span class=\"token string\">\"/etc/bind/named.conf.default-zones\"</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Crearemos el archivo db.madu.interna:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /var/cache/bind/db.madu.interna</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token variable\">$TTL</span>    <span class=\"token number\">86400</span>\n@       IN      SOA     freston.madu.gonzalonazareno.org. admin.madu.gonzalonazareno.org. <span class=\"token punctuation\">(</span>\n                              <span class=\"token number\">1</span>         <span class=\"token punctuation\">;</span> Serial\n                         <span class=\"token number\">604800</span>         <span class=\"token punctuation\">;</span> Refresh\n                          <span class=\"token number\">86400</span>         <span class=\"token punctuation\">;</span> Retry\n                        <span class=\"token number\">2419200</span>         <span class=\"token punctuation\">;</span> Expire\n                          <span class=\"token number\">86400</span> <span class=\"token punctuation\">)</span>       <span class=\"token punctuation\">;</span> Negative Cache TTL\n<span class=\"token punctuation\">;</span>\n@       IN      NS      freston.madu.gonzalonazareno.org.\n\n<span class=\"token variable\">$ORIGIN</span> madu.gonzalonazareno.org.\n\ndulcinea        IN      A       <span class=\"token number\">10.0</span>.1.7\nsancho  IN      A       <span class=\"token number\">10.0</span>.1.10\nquijote IN      A       <span class=\"token number\">10.0</span>.2.4\nfreston IN      A       <span class=\"token number\">10.0</span>.1.3\nwww     IN      CNAME   quijote\nbd      IN      CNAME   sancho</code></pre></div>\n<p>Crearemos ahora db.madu.dmz:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /var/cache/bind/db.madu.dmz</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token variable\">$TTL</span>    <span class=\"token number\">86400</span>\n@       IN      SOA     freston.madu.gonzalonazareno.org. admin.madu.gonzalonazareno.org. <span class=\"token punctuation\">(</span>\n                              <span class=\"token number\">1</span>         <span class=\"token punctuation\">;</span> Serial\n                         <span class=\"token number\">604800</span>         <span class=\"token punctuation\">;</span> Refresh\n                          <span class=\"token number\">86400</span>         <span class=\"token punctuation\">;</span> Retry\n                        <span class=\"token number\">2419200</span>         <span class=\"token punctuation\">;</span> Expire\n                          <span class=\"token number\">86400</span> <span class=\"token punctuation\">)</span>       <span class=\"token punctuation\">;</span> Negative Cache TTL\n<span class=\"token punctuation\">;</span>\n@       IN      NS      freston.madu.gonzalonazareno.org.\n\n<span class=\"token variable\">$ORIGIN</span> madu.gonzalonazareno.org.\n\ndulcinea        IN      A       <span class=\"token number\">10.0</span>.2.6\nsancho  IN      A       <span class=\"token number\">10.0</span>.1.10\nquijote IN      A       <span class=\"token number\">10.0</span>.2.4\nfreston IN      A       <span class=\"token number\">10.0</span>.1.3\nwww     IN      CNAME   quijote\nbd      IN      CNAME   sancho</code></pre></div>\n<p>La externa:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /var/cache/bind/db.madu.externa</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token variable\">$TTL</span>    <span class=\"token number\">86400</span>\n@       IN      SOA     dulcinea.madu.gonzalonazareno.org. admin.madu.gonzalonazareno.org. <span class=\"token punctuation\">(</span>\n                              <span class=\"token number\">1</span>         <span class=\"token punctuation\">;</span> Serial\n                         <span class=\"token number\">604800</span>         <span class=\"token punctuation\">;</span> Refresh\n                          <span class=\"token number\">86400</span>         <span class=\"token punctuation\">;</span> Retry\n                        <span class=\"token number\">2419200</span>         <span class=\"token punctuation\">;</span> Expire\n                          <span class=\"token number\">86400</span> <span class=\"token punctuation\">)</span>       <span class=\"token punctuation\">;</span> Negative Cache TTL\n<span class=\"token punctuation\">;</span>\n@       IN      NS      dulcinea.madu.gonzalonazareno.org.\n\n<span class=\"token variable\">$ORIGIN</span> madu.gonzalonazareno.org.\n\ndulcinea        IN      A       <span class=\"token number\">172.22</span>.201.38\nwww     IN      CNAME   dulcinea\n<span class=\"token builtin class-name\">test</span>    IN      CNAME   dulcinea</code></pre></div>\n<h3 id=\"resoluciones-inversas\"><a href=\"#resoluciones-inversas\" aria-label=\"resoluciones inversas permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Resoluciones inversas:</h3>\n<p>En /var/cache/bind/db.1.0.10</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /var/cache/bind/db.1.0.10</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token variable\">$TTL</span>    <span class=\"token number\">86400</span>\n@       IN      SOA     freston.madu.gonzalonazareno.org. admin.madu.gonzalonazareno.org. <span class=\"token punctuation\">(</span>\n                              <span class=\"token number\">1</span>         <span class=\"token punctuation\">;</span> Serial\n                         <span class=\"token number\">604800</span>         <span class=\"token punctuation\">;</span> Refresh\n                          <span class=\"token number\">86400</span>         <span class=\"token punctuation\">;</span> Retry\n                        <span class=\"token number\">2419200</span>         <span class=\"token punctuation\">;</span> Expire\n                          <span class=\"token number\">86400</span> <span class=\"token punctuation\">)</span>       <span class=\"token punctuation\">;</span> Negative Cache TTL\n<span class=\"token punctuation\">;</span>\n@       IN      NS      freston.madu.gonzalonazareno.org.\n\n\n<span class=\"token variable\">$ORIGIN</span> <span class=\"token number\">1.0</span>.10.in-addr.arpa.\n\n<span class=\"token number\">7</span>       IN      PTR     dulcinea\n<span class=\"token number\">10</span>      IN      PTR     sancho\n<span class=\"token number\">3</span>       IN      PTR     freston</code></pre></div>\n<p>En /var/cache/bind/db.2.0.10</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /var/cache/bind/db.2.0.10</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token variable\">$TTL</span>    <span class=\"token number\">86400</span>\n@       IN      SOA     freston.madu.gonzalonazareno.org. admin.madu.gonzalonazareno.org. <span class=\"token punctuation\">(</span>\n                               <span class=\"token number\">1</span>         <span class=\"token punctuation\">;</span> Serial\n                         <span class=\"token number\">604800</span>         <span class=\"token punctuation\">;</span> Refresh\n                          <span class=\"token number\">86400</span>         <span class=\"token punctuation\">;</span> Retry\n                        <span class=\"token number\">2419200</span>         <span class=\"token punctuation\">;</span> Expire\n                          <span class=\"token number\">86400</span> <span class=\"token punctuation\">)</span>       <span class=\"token punctuation\">;</span> Negative Cache TTL\n<span class=\"token punctuation\">;</span>\n@       IN      NS      freston.madu.gonzalonazareno.org.\n\n\n<span class=\"token variable\">$ORIGIN</span> <span class=\"token number\">2.0</span>.10.in-addr.arpa.\n\n<span class=\"token number\">6</span>\tIN      PTR     dulcinea\n<span class=\"token number\">4</span>       IN      PTR     quijote</code></pre></div>\n<p>Con este comando comprobaremos que los archivos de configuración que acabamos de crear esten bien escritos.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># named-checkconf</span></code></pre></div>\n<p>Para finalizar reiniciamos el servicio bind9</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># systemctl restart bind9</span></code></pre></div>\n<p>Tuve problemas con ipv6 asi que la deshabilite.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">debian@freston:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/default/bind9 \n<span class=\"token comment\"># run resolvconf?</span>\n<span class=\"token assign-left variable\">RESOLVCONF</span><span class=\"token operator\">=</span>yes\n\n<span class=\"token comment\"># startup options for the server</span>\n<span class=\"token assign-left variable\">OPTIONS</span><span class=\"token operator\">=</span><span class=\"token string\">\"-4 -u bind\"</span></code></pre></div>\n<p>STATUS</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">debian@freston:~$ <span class=\"token function\">sudo</span> systemctl status bind9.service\n● bind9.service - BIND Domain Name Server\n   Loaded: loaded <span class=\"token punctuation\">(</span>/lib/systemd/system/bind9.service<span class=\"token punctuation\">;</span> enabled<span class=\"token punctuation\">;</span> vendor preset: enabled<span class=\"token punctuation\">)</span>\n   Active: active <span class=\"token punctuation\">(</span>running<span class=\"token punctuation\">)</span> since Tue <span class=\"token number\">2021</span>-01-19 <span class=\"token number\">20</span>:18:56 CET<span class=\"token punctuation\">;</span> 3s ago\n     Docs: man:named<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n  Process: <span class=\"token number\">1482</span> <span class=\"token assign-left variable\">ExecStart</span><span class=\"token operator\">=</span>/usr/sbin/named <span class=\"token variable\">$OPTIONS</span> <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>/SUCCESS<span class=\"token punctuation\">)</span>\n Main PID: <span class=\"token number\">1483</span> <span class=\"token punctuation\">(</span>named<span class=\"token punctuation\">)</span>\n    Tasks: <span class=\"token number\">4</span> <span class=\"token punctuation\">(</span>limit: <span class=\"token number\">562</span><span class=\"token punctuation\">)</span>\n   Memory: <span class=\"token number\">18</span>.3M\n   CGroup: /system.slice/bind9.service\n           └─1483 /usr/sbin/named -4 -u <span class=\"token builtin class-name\">bind</span>\n\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: zone <span class=\"token number\">30.172</span>.in-addr.arpa/IN/externa: loaded serial <span class=\"token number\">1</span>\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: all zones loaded\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston systemd<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>: Started BIND Domain Name Server.\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: running\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: managed-keys-zone/externa: Key <span class=\"token number\">20326</span> <span class=\"token keyword\">for</span> zone <span class=\"token builtin class-name\">.</span> acceptance timer complete: key now trusted\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: resolver priming query complete\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:56 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: managed-keys-zone/dmz: Key <span class=\"token number\">20326</span> <span class=\"token keyword\">for</span> zone <span class=\"token builtin class-name\">.</span> acceptance timer complete: key now trusted\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:57 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: managed-keys-zone/interna: Key <span class=\"token number\">20326</span> <span class=\"token keyword\">for</span> zone <span class=\"token builtin class-name\">.</span> acceptance timer complete: key now trusted\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:57 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: resolver priming query complete\nJan <span class=\"token number\">19</span> <span class=\"token number\">20</span>:18:57 freston named<span class=\"token punctuation\">[</span><span class=\"token number\">1483</span><span class=\"token punctuation\">]</span>: resolver priming query complete</code></pre></div>\n<hr>\n<h3 id=\"en-dulcinea\"><a href=\"#en-dulcinea\" aria-label=\"en dulcinea permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>En Dulcinea</h3>\n<p><strong>Reglas de encaminamiento:</strong>\n(A las que añadiremos el puerto 80 para esta práctica mas adelante y el 443 para la próxima(https).)</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@dulcinea:~<span class=\"token comment\"># nft add chain nat prerouting { type nat hook prerouting priority 0 \\; }</span>\nroot@dulcinea:~<span class=\"token comment\"># nft add rule ip nat prerouting iifname \"eth0\" udp dport 53 counter dnat to 10.0.1.3</span>\nroot@dulcinea:~<span class=\"token comment\"># nft add rule ip nat prerouting iifname \"eth0\" tcp dport 80 counter dnat to 10.0.2.4</span>\nroot@dulcinea:~<span class=\"token comment\"># nft add rule ip nat prerouting iifname \"eth0\" tcp dport 443 counter dnat to 10.0.2.4</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@dulcinea:~<span class=\"token comment\"># nft list ruleset</span>\ntable <span class=\"token function\">ip</span> nat <span class=\"token punctuation\">{</span>\n\tchain PREROUTING <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token builtin class-name\">type</span> nat hook prerouting priority -100<span class=\"token punctuation\">;</span> policy accept<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tchain INPUT <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token builtin class-name\">type</span> nat hook input priority <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> policy accept<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tchain POSTROUTING <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token builtin class-name\">type</span> nat hook postrouting priority <span class=\"token number\">100</span><span class=\"token punctuation\">;</span> policy accept<span class=\"token punctuation\">;</span>\n\t\toifname <span class=\"token string\">\"eth0\"</span> <span class=\"token function\">ip</span> saddr <span class=\"token number\">10.0</span>.1.0/24 counter packets <span class=\"token number\">10167</span> bytes <span class=\"token number\">767897</span> masquerade\n\t\toifname <span class=\"token string\">\"eth0\"</span> <span class=\"token function\">ip</span> saddr <span class=\"token number\">10.0</span>.2.0/24 counter packets <span class=\"token number\">9015</span> bytes <span class=\"token number\">626076</span> masquerade\n\t<span class=\"token punctuation\">}</span>\n\n\tchain OUTPUT <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token builtin class-name\">type</span> nat hook output priority -100<span class=\"token punctuation\">;</span> policy accept<span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\tchain prerouting <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token builtin class-name\">type</span> nat hook prerouting priority <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> policy accept<span class=\"token punctuation\">;</span>\n\t\tiifname <span class=\"token string\">\"eth0\"</span> udp dport domain counter packets <span class=\"token number\">0</span> bytes <span class=\"token number\">0</span> dnat to <span class=\"token number\">10.0</span>.1.3\n\t\tiifname <span class=\"token string\">\"eth0\"</span> tcp dport http counter packets <span class=\"token number\">0</span> bytes <span class=\"token number\">0</span> dnat to <span class=\"token number\">10.0</span>.2.4\n\t\tiifname <span class=\"token string\">\"eth0\"</span> tcp dport https counter packets <span class=\"token number\">0</span> bytes <span class=\"token number\">0</span> dnat to <span class=\"token number\">10.0</span>.2.4\n\t<span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Moveremos la tabla de las reglas al archivo nftables.conf para cuando reiniciemos el servidor solo debamos activar el servicio nftables.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@dulcinea:~<span class=\"token comment\"># nft list ruleset > /etc/nftables.conf</span></code></pre></div>\n<p>Modificación de el archivo resolv.conf de todas las instacias:</p>\n<p><strong>Dulcinea</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@dulcinea:~<span class=\"token comment\"># nano /etc/resolvconf/resolv.conf.d/head</span>\nnameserver <span class=\"token number\">10.0</span>.1.3\nroot@dulcinea:~<span class=\"token comment\"># nano /etc/resolvconf/resolv.conf.d/base</span>\nsearch madu.gonzalonazareno.org\nroot@dulcinea:~<span class=\"token comment\"># cat /etc/resolv.conf</span>\n<span class=\"token comment\"># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)</span>\n<span class=\"token comment\">#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN</span>\nnameserver <span class=\"token number\">10.0</span>.1.3\nnameserver <span class=\"token number\">192.168</span>.202.2\nnameserver <span class=\"token number\">192.168</span>.200.2\nsearch madu.gonzalonazareno.org</code></pre></div>\n<p><strong>Freston</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@freston:~<span class=\"token comment\"># nano /etc/resolvconf/resolv.conf.d/head</span>\nnameserver <span class=\"token number\">10.0</span>.1.3\nroot@freston:~<span class=\"token comment\"># nano /etc/resolvconf/resolv.conf.d/base</span>\nnameserver <span class=\"token number\">192.168</span>.202.2\nsearch madu.gonzalonazareno.org\nroot@dulcinea:~<span class=\"token comment\"># cat /etc/resolv.conf</span>\nnameserver <span class=\"token number\">10.0</span>.1.3\nnameserver <span class=\"token number\">192.168</span>.200.2\nnameserver <span class=\"token number\">192.168</span>.202.2\nsearch madu.gonzalonazareno.org</code></pre></div>\n<p><strong>Sancho</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@sancho:~<span class=\"token comment\"># nano /etc/netplan/50-cloud-init.yaml</span>\nnetwork:\n    version: <span class=\"token number\">2</span>\n    ethernets:\n        ens6:\n            dhcp4: <span class=\"token boolean\">false</span>\n            match:\n                macaddress: fa:16:3e:cb:81:4e\n            mtu: <span class=\"token number\">8950</span>\n            set-name: ens6\n            addresses: <span class=\"token punctuation\">[</span><span class=\"token number\">10.0</span>.1.10/24<span class=\"token punctuation\">]</span>\n            gateway4: <span class=\"token number\">10.0</span>.1.7\n            nameservers:\n                addresses: <span class=\"token punctuation\">[</span><span class=\"token number\">10.0</span>.1.3, <span class=\"token number\">192.168</span>.202.2, <span class=\"token number\">192.168</span>.200.2<span class=\"token punctuation\">]</span>\n                search: <span class=\"token punctuation\">[</span><span class=\"token string\">\"madu.gonzalonazareno.org\"</span><span class=\"token punctuation\">]</span>\nroot@sancho:~<span class=\"token comment\"># cat /etc/resolv.conf</span>\nnameserver <span class=\"token number\">127.0</span>.0.53\noptions edns0 trust-ad\nsearch madu.gonzalonazareno.org</code></pre></div>\n<p><strong>Quijote</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">cat</span> /etc/resolv.conf \n<span class=\"token punctuation\">;</span> generated by /usr/sbin/dhclient-script\nsearch openstacklocal madu.gonzalonazareno.org\nnameserver <span class=\"token number\">10.0</span>.1.3\nnameserver <span class=\"token number\">192.168</span>.202.2\nnameserver <span class=\"token number\">192.168</span>.200.2</code></pre></div>\n<p>Por ultimo deberemos de deshabilitar la seguridad tanto de puertos como de nuestras maquinas:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~$ <span class=\"token builtin class-name\">source</span> ~/.virtualenvs/openstackclient/bin/activate\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~$ <span class=\"token builtin class-name\">cd</span> Documentos/\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ <span class=\"token builtin class-name\">source</span> Proyecto<span class=\"token punctuation\">\\</span> de<span class=\"token punctuation\">\\</span> francisco.madu-openrc.sh\nPlease enter your OpenStack Password <span class=\"token keyword\">for</span> project Proyecto de francisco.madu as user francisco.madu: \n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack port list\n+--------------------------------------+----------------------------------------+-------------------+--------------------------------------------------------------------------+--------+\n<span class=\"token operator\">|</span> ID                                   <span class=\"token operator\">|</span> Name                                   <span class=\"token operator\">|</span> MAC Address       <span class=\"token operator\">|</span> Fixed IP Addresses                                                       <span class=\"token operator\">|</span> Status <span class=\"token operator\">|</span>\n+--------------------------------------+----------------------------------------+-------------------+--------------------------------------------------------------------------+--------+\n<span class=\"token operator\">|</span> 154dc4b3-8e0b-4cf8-8c71-5b136f7a4413 <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:66:ce:31 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.0.8'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'46cd68e1-2e88-4ba6-9970-431f6f53c13f'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 378e5acc-4e63-4163-80c6-87dce8659fe4 <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:7f:79:85 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.2.6'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'41882e15-6703-4dd5-b2d3-18ed7eb88b03'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 53665f0f-e35a-44d9-896a-313861310021 <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:18:49:cd <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.0.1'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'46cd68e1-2e88-4ba6-9970-431f6f53c13f'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 5f4ef06d-17cf-49e3-b30e-54bcd8a04465 <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:36:da:86 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.0.2'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'46cd68e1-2e88-4ba6-9970-431f6f53c13f'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 64a8862e-7aad-4d81-8cad-b1c2135af81b <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:97:50:c0 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.0.11'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'46cd68e1-2e88-4ba6-9970-431f6f53c13f'</span> <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 7d16cb06-d1f5-47eb-828a-3cd9fa09fc51 <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:52:99:38 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.2.4'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'41882e15-6703-4dd5-b2d3-18ed7eb88b03'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 858c1148-d738-413d-8989-9475d0fd3a7d <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:cb:81:4e <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.1.10'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'7877edc3-a5b4-47c2-a0b6-1eb381e7c358'</span> <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> 92ab186a-b317-41e5-8bac-315524c18c8b <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:0c:c0:5e <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.1.7'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'7877edc3-a5b4-47c2-a0b6-1eb381e7c358'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> b4099ac2-bcb7-401f-997c-e826f949e117 <span class=\"token operator\">|</span> escenario1-r1_network_ext-wajhseltwj2t <span class=\"token operator\">|</span> fa:16:3e:71:9a:c3 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.0.12'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'46cd68e1-2e88-4ba6-9970-431f6f53c13f'</span> <span class=\"token operator\">|</span> DOWN   <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> bd2dabad-a368-40c0-9897-765a9311b4fe <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:bf:dd:55 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.1.3'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'7877edc3-a5b4-47c2-a0b6-1eb381e7c358'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> f3fcc1b8-40fa-45b8-86f3-f98793d75800 <span class=\"token operator\">|</span>                                        <span class=\"token operator\">|</span> fa:16:3e:68:b4:c0 <span class=\"token operator\">|</span> <span class=\"token assign-left variable\">ip_address</span><span class=\"token operator\">=</span><span class=\"token string\">'10.0.0.3'</span>, <span class=\"token assign-left variable\">subnet_id</span><span class=\"token operator\">=</span><span class=\"token string\">'46cd68e1-2e88-4ba6-9970-431f6f53c13f'</span>  <span class=\"token operator\">|</span> ACTIVE <span class=\"token operator\">|</span>\n+--------------------------------------+----------------------------------------+-------------------+--------------------------------------------------------------------------+--------+\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack server remove security group Freston default\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack port <span class=\"token builtin class-name\">set</span> --disable-port-security bd2dabad-a368-40c0-9897-765a9311b4fe\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack server remove security group Quijote default\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack port <span class=\"token builtin class-name\">set</span> --disable-port-security 7d16cb06-d1f5-47eb-828a-3cd9fa09fc51\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack server remove security group Sancho default\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack port <span class=\"token builtin class-name\">set</span> --disable-port-security 858c1148-d738-413d-8989-9475d0fd3a7d\n<span class=\"token punctuation\">(</span>openstackclient<span class=\"token punctuation\">)</span> fran@debian:~/Documentos$ openstack port <span class=\"token builtin class-name\">set</span> --disable-port-security 64a8862e-7aad-4d81-8cad-b1c2135af81b</code></pre></div>\n<h3 id=\"comprobaciones\"><a href=\"#comprobaciones\" aria-label=\"comprobaciones permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Comprobaciones</h3>\n<p>Desde Dulcinea:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">debian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 dulcinea.madu.gonzalonazareno.org\n<span class=\"token number\">10.0</span>.1.7\ndebian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 quijote.madu.gonzalonazareno.org\n<span class=\"token number\">10.0</span>.2.4\ndebian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 sancho.madu.gonzalonazareno.org\n<span class=\"token number\">10.0</span>.1.10\ndebian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 freston.madu.gonzalonazareno.org\n<span class=\"token number\">10.0</span>.1.3\ndebian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 www.madu.gonzalonazareno.org\nquijote.madu.gonzalonazareno.org.\n<span class=\"token number\">10.0</span>.2.4\ndebian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 bd.madu.gonzalonazareno.org\nsancho.madu.gonzalonazareno.org.\n<span class=\"token number\">10.0</span>.1.10\ndebian@dulcinea:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 www.josedomingo.org\nendor.josedomingo.org.\n<span class=\"token number\">37.187</span>.119.60</code></pre></div>\n<p>Desde Freston:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">debian@freston:~$ <span class=\"token function\">dig</span> +short @localhost -x <span class=\"token number\">10.0</span>.1.7\ndulcinea.1.0.10.in-addr.arpa.\ndebian@freston:~$ <span class=\"token function\">dig</span> +short @localhost -x <span class=\"token number\">10.0</span>.1.10\nsancho.1.0.10.in-addr.arpa.</code></pre></div>\n<p>Desde Sancho:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ubuntu@sancho:~$ <span class=\"token function\">dig</span> +short @10.0.1.3 dulcinea.madu.gonzalonazareno.org\n<span class=\"token number\">10.0</span>.1.7\nubuntu@sancho:~$ <span class=\"token function\">dig</span> @10.0.1.3 www.google.es\n\n<span class=\"token punctuation\">;</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">>></span> DiG <span class=\"token number\">9.16</span>.1-Ubuntu <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">>></span> @10.0.1.3 www.google.es\n<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">(</span><span class=\"token number\">1</span> server found<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> global options: +cmd\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> Got answer:\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> -<span class=\"token operator\">>></span>HEADER<span class=\"token operator\">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class=\"token number\">28000</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> flags: qr rd ra<span class=\"token punctuation\">;</span> QUERY: <span class=\"token number\">1</span>, ANSWER: <span class=\"token number\">1</span>, AUTHORITY: <span class=\"token number\">4</span>, ADDITIONAL: <span class=\"token number\">9</span>\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> OPT PSEUDOSECTION:\n<span class=\"token punctuation\">;</span> EDNS: version: <span class=\"token number\">0</span>, flags:<span class=\"token punctuation\">;</span> udp: <span class=\"token number\">4096</span>\n<span class=\"token punctuation\">;</span> COOKIE: 31fe5c1b0c4f1d2ac21ae12d6008825f343069348e44b29f <span class=\"token punctuation\">(</span>good<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> QUESTION SECTION:\n<span class=\"token punctuation\">;</span>www.google.es.\t\t\tIN\tA\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> ANSWER SECTION:\nwww.google.es.\t\t<span class=\"token number\">300</span>\tIN\tA\t<span class=\"token number\">172.217</span>.17.3\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> AUTHORITY SECTION:\ngoogle.es.\t\t<span class=\"token number\">86399</span>\tIN\tNS\tns4.google.com.\ngoogle.es.\t\t<span class=\"token number\">86399</span>\tIN\tNS\tns2.google.com.\ngoogle.es.\t\t<span class=\"token number\">86399</span>\tIN\tNS\tns3.google.com.\ngoogle.es.\t\t<span class=\"token number\">86399</span>\tIN\tNS\tns1.google.com.\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> ADDITIONAL SECTION:\nns1.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tA\t<span class=\"token number\">216.239</span>.32.10\nns2.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tA\t<span class=\"token number\">216.239</span>.34.10\nns3.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tA\t<span class=\"token number\">216.239</span>.36.10\nns4.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tA\t<span class=\"token number\">216.239</span>.38.10\nns1.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tAAAA\t<span class=\"token number\">2001</span>:4860:4802:32::a\nns2.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tAAAA\t<span class=\"token number\">2001</span>:4860:4802:34::a\nns3.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tAAAA\t<span class=\"token number\">2001</span>:4860:4802:36::a\nns4.google.com.\t\t<span class=\"token number\">172800</span>\tIN\tAAAA\t<span class=\"token number\">2001</span>:4860:4802:38::a\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> Query time: <span class=\"token number\">2023</span> msec\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> SERVER: <span class=\"token number\">10.0</span>.1.3<span class=\"token comment\">#53(10.0.1.3)</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> WHEN: Wed Jan <span class=\"token number\">20</span> <span class=\"token number\">20</span>:19:59 CET <span class=\"token number\">2021</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> MSG SIZE  rcvd: <span class=\"token number\">344</span></code></pre></div>\n<p>Desde Quijote:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">dig</span> +short @10.0.1.3 -x <span class=\"token number\">10.0</span>.2.4\nquijote.2.0.10.in-addr.arpa.\n<span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">dig</span> +short @10.0.1.3 -x <span class=\"token number\">10.0</span>.2.6\ndulcinea.2.0.10.in-addr.arpa.</code></pre></div>\n<p>Desde Externa:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">debian@ansiblepruebas:~$ <span class=\"token function\">dig</span> +short @192.168.202.2 dulcinea.madu.gonzalonazareno.org\n<span class=\"token number\">172.22</span>.201.38\ndebian@ansiblepruebas:~$ <span class=\"token function\">dig</span> dulcinea.madu.gonzalonazareno.org\n\n<span class=\"token punctuation\">;</span> <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">>></span> DiG <span class=\"token number\">9.11</span>.5-P4-5.1+deb10u2-Debian <span class=\"token operator\">&lt;&lt;</span><span class=\"token operator\">>></span> dulcinea.madu.gonzalonazareno.org\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> global options: +cmd\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> Got answer:\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> -<span class=\"token operator\">>></span>HEADER<span class=\"token operator\">&lt;&lt;-</span> opcode: QUERY, status: NOERROR, id: <span class=\"token number\">19863</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> flags: qr rd ra<span class=\"token punctuation\">;</span> QUERY: <span class=\"token number\">1</span>, ANSWER: <span class=\"token number\">1</span>, AUTHORITY: <span class=\"token number\">1</span>, ADDITIONAL: <span class=\"token number\">1</span>\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> OPT PSEUDOSECTION:\n<span class=\"token punctuation\">;</span> EDNS: version: <span class=\"token number\">0</span>, flags:<span class=\"token punctuation\">;</span> udp: <span class=\"token number\">4096</span>\n<span class=\"token punctuation\">;</span> COOKIE: 6b761c74b57991a3163175f0601c313f6bdc23a9d6c6a050 <span class=\"token punctuation\">(</span>good<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> QUESTION SECTION:\n<span class=\"token punctuation\">;</span>dulcinea.madu.gonzalonazareno.org. IN\tA\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> ANSWER SECTION:\ndulcinea.madu.gonzalonazareno.org. <span class=\"token number\">86050</span> IN A\t<span class=\"token number\">172.22</span>.201.38\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> AUTHORITY SECTION:\nmadu.gonzalonazareno.org. <span class=\"token number\">86038</span>\tIN\tNS\tdulcinea.madu.gonzalonazareno.org.\n\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> Query time: <span class=\"token number\">1</span> msec\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> SERVER: <span class=\"token number\">192.168</span>.202.2<span class=\"token comment\">#53(192.168.202.2)</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> WHEN: Thu Feb 04 <span class=\"token number\">17</span>:39:11 UTC <span class=\"token number\">2021</span>\n<span class=\"token punctuation\">;</span><span class=\"token punctuation\">;</span> MSG SIZE  rcvd: <span class=\"token number\">120</span></code></pre></div>\n<h2 id=\"servidor-web\"><a href=\"#servidor-web\" aria-label=\"servidor web permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Servidor Web</h2>\n<p>En quijote (CentOs)(Servidor que está en la DMZ) vamos a instalar un servidor web apache. Configura el servidor para que sea capaz de ejecutar código php (para ello vamos a usar un servidor de aplicaciones php-fpm). Entrega una captura de pantalla accediendo a www.tunombre.gonzalonazareno.org/info.php donde se vea la salida del fichero info.php. Investiga la reglas DNAT de cortafuegos que tienes que configurar en dulcinea para, cuando accedemos a la IP flotante se acceda al servidor web.</p>\n<p>Instalamos httpd php y php-fpm.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># dnf install httpd php php-fpm</span>\nLast metadata expiration check: <span class=\"token number\">3</span>:55:34 ago on Tue 02 Feb <span class=\"token number\">2021</span> 03:19:48 PM UTC.\nDependencies resolved.\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\n Package              Arch     Version                                  Repository   Size\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nInstalling:\n httpd                x86_64   <span class=\"token number\">2.4</span>.37-30.module_el8.3.0+561+97fdbbcc    appstream   <span class=\"token number\">1.7</span> M\n php                  x86_64   <span class=\"token number\">7.2</span>.24-1.module_el8.2.0+313+b04d0a66     appstream   <span class=\"token number\">1.5</span> M\n php-fpm              x86_64   <span class=\"token number\">7.2</span>.24-1.module_el8.2.0+313+b04d0a66     appstream   <span class=\"token number\">1.6</span> M\nInstalling dependencies:\n apr                  x86_64   <span class=\"token number\">1.6</span>.3-11.el8                             appstream   <span class=\"token number\">125</span> k\n apr-util             x86_64   <span class=\"token number\">1.6</span>.1-6.el8                              appstream   <span class=\"token number\">105</span> k\n centos-logos-httpd   noarch   <span class=\"token number\">80.5</span>-2.el8                               baseos       <span class=\"token number\">24</span> k\n httpd-filesystem     noarch   <span class=\"token number\">2.4</span>.37-30.module_el8.3.0+561+97fdbbcc    appstream    <span class=\"token number\">37</span> k\n httpd-tools          x86_64   <span class=\"token number\">2.4</span>.37-30.module_el8.3.0+561+97fdbbcc    appstream   <span class=\"token number\">104</span> k\n mailcap              noarch   <span class=\"token number\">2.1</span>.48-3.el8                             baseos       <span class=\"token number\">39</span> k\n mod_http2            x86_64   <span class=\"token number\">1.15</span>.7-2.module_el8.3.0+477+498bb568     appstream   <span class=\"token number\">154</span> k\n nginx-filesystem     noarch   <span class=\"token number\">1</span>:1.14.1-9.module_el8.0.0+184+e34fea82   appstream    <span class=\"token number\">24</span> k\n php-cli              x86_64   <span class=\"token number\">7.2</span>.24-1.module_el8.2.0+313+b04d0a66     appstream   <span class=\"token number\">3.1</span> M\n php-common           x86_64   <span class=\"token number\">7.2</span>.24-1.module_el8.2.0+313+b04d0a66     appstream   <span class=\"token number\">661</span> k\nInstalling weak dependencies:\n apr-util-bdb         x86_64   <span class=\"token number\">1.6</span>.1-6.el8                              appstream    <span class=\"token number\">25</span> k\n apr-util-openssl     x86_64   <span class=\"token number\">1.6</span>.1-6.el8                              appstream    <span class=\"token number\">27</span> k\nEnabling module streams:\n httpd                         <span class=\"token number\">2.4</span>                                                       \n nginx                         <span class=\"token number\">1.14</span>                                                      \n php                           <span class=\"token number\">7.2</span>                                                       \n\nTransaction Summary\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span>\nInstall  <span class=\"token number\">15</span> Packages\n\nTotal download size: <span class=\"token number\">9.2</span> M\nInstalled size: <span class=\"token number\">31</span> M\nIs this ok <span class=\"token punctuation\">[</span>y/N<span class=\"token punctuation\">]</span>: y\nDownloading Packages:\n<span class=\"token punctuation\">(</span><span class=\"token number\">1</span>/15<span class=\"token punctuation\">)</span>: apr-util-bdb-1.6.1-6.el8.x86_64.rpm               <span class=\"token number\">8.1</span> kB/s <span class=\"token operator\">|</span>  <span class=\"token number\">25</span> kB     00:03    \n<span class=\"token punctuation\">(</span><span class=\"token number\">2</span>/15<span class=\"token punctuation\">)</span>: apr-util-1.6.1-6.el8.x86_64.rpm                    <span class=\"token number\">34</span> kB/s <span class=\"token operator\">|</span> <span class=\"token number\">105</span> kB     00:03    \n<span class=\"token punctuation\">(</span><span class=\"token number\">3</span>/15<span class=\"token punctuation\">)</span>: apr-1.6.3-11.el8.x86_64.rpm                        <span class=\"token number\">40</span> kB/s <span class=\"token operator\">|</span> <span class=\"token number\">125</span> kB     00:03    \n<span class=\"token punctuation\">(</span><span class=\"token number\">4</span>/15<span class=\"token punctuation\">)</span>: apr-util-openssl-1.6.1-6.el8.x86_64.rpm           <span class=\"token number\">326</span> kB/s <span class=\"token operator\">|</span>  <span class=\"token number\">27</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">5</span>/15<span class=\"token punctuation\">)</span>: httpd-filesystem-2.4.37-30.module_el8.3.0+561+97f <span class=\"token number\">410</span> kB/s <span class=\"token operator\">|</span>  <span class=\"token number\">37</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">6</span>/15<span class=\"token punctuation\">)</span>: httpd-tools-2.4.37-30.module_el8.3.0+561+97fdbbcc <span class=\"token number\">1.1</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">104</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">7</span>/15<span class=\"token punctuation\">)</span>: nginx-filesystem-1.14.1-9.module_el8.0.0+184+e34f <span class=\"token number\">326</span> kB/s <span class=\"token operator\">|</span>  <span class=\"token number\">24</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">8</span>/15<span class=\"token punctuation\">)</span>: mod_http2-1.15.7-2.module_el8.3.0+477+498bb568.x8 <span class=\"token number\">1.4</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">154</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">9</span>/15<span class=\"token punctuation\">)</span>: php-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64.r <span class=\"token number\">3.1</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">1.5</span> MB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">10</span>/15<span class=\"token punctuation\">)</span>: httpd-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_ <span class=\"token number\">2.2</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">1.7</span> MB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">11</span>/15<span class=\"token punctuation\">)</span>: php-cli-7.2.24-1.module_el8.2.0+313+b04d0a66.x86 <span class=\"token number\">4.2</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">3.1</span> MB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">12</span>/15<span class=\"token punctuation\">)</span>: php-common-7.2.24-1.module_el8.2.0+313+b04d0a66. <span class=\"token number\">2.1</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">661</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">13</span>/15<span class=\"token punctuation\">)</span>: php-fpm-7.2.24-1.module_el8.2.0+313+b04d0a66.x86 <span class=\"token number\">4.5</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">1.6</span> MB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">14</span>/15<span class=\"token punctuation\">)</span>: centos-logos-httpd-80.5-2.el8.noarch.rpm          <span class=\"token number\">94</span> kB/s <span class=\"token operator\">|</span>  <span class=\"token number\">24</span> kB     00:00    \n<span class=\"token punctuation\">(</span><span class=\"token number\">15</span>/15<span class=\"token punctuation\">)</span>: mailcap-2.1.48-3.el8.noarch.rpm                  <span class=\"token number\">156</span> kB/s <span class=\"token operator\">|</span>  <span class=\"token number\">39</span> kB     00:00    \n------------------------------------------------------------------------------------------\nTotal                                                     <span class=\"token number\">1.8</span> MB/s <span class=\"token operator\">|</span> <span class=\"token number\">9.2</span> MB     00:05     \nRunning transaction check\nTransaction check succeeded.\nRunning transaction <span class=\"token builtin class-name\">test</span>\nTransaction <span class=\"token builtin class-name\">test</span> succeeded.\nRunning transaction\n  Preparing        <span class=\"token builtin class-name\">:</span>                                                                  <span class=\"token number\">1</span>/1 \n  Installing       <span class=\"token builtin class-name\">:</span> php-common-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64          <span class=\"token number\">1</span>/15 \n  Running scriptlet: httpd-filesystem-2.4.37-30.module_el8.3.0+561+97fdbbcc.noarc    <span class=\"token number\">2</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> httpd-filesystem-2.4.37-30.module_el8.3.0+561+97fdbbcc.noarc    <span class=\"token number\">2</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> apr-1.6.3-11.el8.x86_64                                         <span class=\"token number\">3</span>/15 \n  Running scriptlet: apr-1.6.3-11.el8.x86_64                                         <span class=\"token number\">3</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> apr-util-bdb-1.6.1-6.el8.x86_64                                 <span class=\"token number\">4</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> apr-util-openssl-1.6.1-6.el8.x86_64                             <span class=\"token number\">5</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> apr-util-1.6.1-6.el8.x86_64                                     <span class=\"token number\">6</span>/15 \n  Running scriptlet: apr-util-1.6.1-6.el8.x86_64                                     <span class=\"token number\">6</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> httpd-tools-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64        <span class=\"token number\">7</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> php-cli-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64             <span class=\"token number\">8</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> mailcap-2.1.48-3.el8.noarch                                     <span class=\"token number\">9</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> centos-logos-httpd-80.5-2.el8.noarch                           <span class=\"token number\">10</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> mod_http2-1.15.7-2.module_el8.3.0+477+498bb568.x86_64          <span class=\"token number\">11</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> httpd-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64             <span class=\"token number\">12</span>/15 \n  Running scriptlet: httpd-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64             <span class=\"token number\">12</span>/15 \n  Running scriptlet: nginx-filesystem-1:1.14.1-9.module_el8.0.0+184+e34fea82.noar   <span class=\"token number\">13</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> nginx-filesystem-1:1.14.1-9.module_el8.0.0+184+e34fea82.noar   <span class=\"token number\">13</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> php-fpm-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64            <span class=\"token number\">14</span>/15 \n  Running scriptlet: php-fpm-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64            <span class=\"token number\">14</span>/15 \n  Installing       <span class=\"token builtin class-name\">:</span> php-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                <span class=\"token number\">15</span>/15 \n  Running scriptlet: httpd-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64             <span class=\"token number\">15</span>/15 \n  Running scriptlet: php-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                <span class=\"token number\">15</span>/15 \n  Running scriptlet: php-fpm-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64            <span class=\"token number\">15</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> apr-1.6.3-11.el8.x86_64                                         <span class=\"token number\">1</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> apr-util-1.6.1-6.el8.x86_64                                     <span class=\"token number\">2</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> apr-util-bdb-1.6.1-6.el8.x86_64                                 <span class=\"token number\">3</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> apr-util-openssl-1.6.1-6.el8.x86_64                             <span class=\"token number\">4</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> httpd-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64              <span class=\"token number\">5</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> httpd-filesystem-2.4.37-30.module_el8.3.0+561+97fdbbcc.noarc    <span class=\"token number\">6</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> httpd-tools-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64        <span class=\"token number\">7</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> mod_http2-1.15.7-2.module_el8.3.0+477+498bb568.x86_64           <span class=\"token number\">8</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> nginx-filesystem-1:1.14.1-9.module_el8.0.0+184+e34fea82.noar    <span class=\"token number\">9</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> php-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                <span class=\"token number\">10</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> php-cli-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64            <span class=\"token number\">11</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> php-common-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64         <span class=\"token number\">12</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> php-fpm-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64            <span class=\"token number\">13</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> centos-logos-httpd-80.5-2.el8.noarch                           <span class=\"token number\">14</span>/15 \n  Verifying        <span class=\"token builtin class-name\">:</span> mailcap-2.1.48-3.el8.noarch                                    <span class=\"token number\">15</span>/15 \n\nInstalled:\n  apr-1.6.3-11.el8.x86_64                                                                 \n  apr-util-1.6.1-6.el8.x86_64                                                             \n  apr-util-bdb-1.6.1-6.el8.x86_64                                                         \n  apr-util-openssl-1.6.1-6.el8.x86_64                                                     \n  centos-logos-httpd-80.5-2.el8.noarch                                                    \n  httpd-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64                                      \n  httpd-filesystem-2.4.37-30.module_el8.3.0+561+97fdbbcc.noarch                           \n  httpd-tools-2.4.37-30.module_el8.3.0+561+97fdbbcc.x86_64                                \n  mailcap-2.1.48-3.el8.noarch                                                             \n  mod_http2-1.15.7-2.module_el8.3.0+477+498bb568.x86_64                                   \n  nginx-filesystem-1:1.14.1-9.module_el8.0.0+184+e34fea82.noarch                          \n  php-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                                         \n  php-cli-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                                     \n  php-common-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                                  \n  php-fpm-7.2.24-1.module_el8.2.0+313+b04d0a66.x86_64                                     \n\nComplete<span class=\"token operator\">!</span></code></pre></div>\n<p>Iniciamos el servicio de nttpd y php-fpm y lo habilitamos</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl start httpd php-fpm</span>\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl enable httpd php-fpm</span>\nCreated symlink /etc/systemd/system/multi-user.target.wants/httpd.service → /usr/lib/systemd/system/httpd.service.\nCreated symlink /etc/systemd/system/multi-user.target.wants/php-fpm.service → /usr/lib/systemd/system/php-fpm.service.</code></pre></div>\n<p><strong>Configuración del FireWall</strong>\nYa que el firewall que utiliza Centos8 es muy restrictivo. habilitaremos los puertos 80 y 443 para su uso.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># firewall-cmd --permanent --add-port=80/tcp</span>\nsuccess\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># firewall-cmd --permanent --add-port=443/tcp</span>\nsuccess\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># firewall-cmd --reload</span>\nsuccess\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># firewall-cmd --list-all</span>\npublic <span class=\"token punctuation\">(</span>active<span class=\"token punctuation\">)</span>\n  target: default\n  icmp-block-inversion: no\n  interfaces: eth1\n  sources: \n  services: dhcpv6-client <span class=\"token function\">ssh</span>\n  ports: <span class=\"token number\">80</span>/tcp <span class=\"token number\">443</span>/tcp\n  protocols: \n  masquerade: no\n  forward-ports: \n  source-ports: \n  icmp-blocks: \n  rich rules: </code></pre></div>\n<p><strong>Configuración de Httpd</strong></p>\n<p>Crearemos los nuevos directorios que de manera predeterminada no existen.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /etc/httpd/sites-enabled /etc/httpd/sites-available</span></code></pre></div>\n<p>Nos vamos a la ultima linea de httpd.conf y modificamos la directiva IncludeOptional y le añadimos la nueva ruta que usará:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># vi /etc/httpd/conf/httpd.conf</span>\n<span class=\"token comment\">#IncludeOptional conf.d/*.conf</span>\nIncludeOptional sites-enabled/*.conf</code></pre></div>\n<p><strong>Configuración de Php-fpm</strong>\nPara comprobar qué configuración está usando actualmente, ejecutaremos el comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/php-fpm.d/www.conf | egrep 'listen ='</span>\nlisten <span class=\"token operator\">=</span> /run/php-fpm/www.sock</code></pre></div>\n<p>No es necesario modificación ya que por defecto el Socket Unix esta alojado en /run/php-fpm/www.sock.</p>\n<p><strong>Configuración del virtualhost</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># vi /etc/httpd/sites-available/quijoteweb.conf</span>\n<span class=\"token operator\">&lt;</span>VirtualHost *:8<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>></span>\n    ServerName www.madu.gonzalonazareno.org\n    DocumentRoot /var/www/fran\n\n    <span class=\"token operator\">&lt;</span>Directory /var/www/fran/<span class=\"token operator\">></span>\n        Options FollowSymLinks\n\tAllowOverride All\n\tOrder deny,allow\n\tAllow from all\n\n\t<span class=\"token operator\">&lt;</span>FilesMatch <span class=\"token string\">\"\\.php\"</span><span class=\"token operator\">></span>\n                SetHandler <span class=\"token string\">\"proxy:unix:/run/php-fpm/www.sock|fcgi://localhost\"</span>\n        <span class=\"token operator\">&lt;</span>/FilesMatch<span class=\"token operator\">></span>\n\n    <span class=\"token operator\">&lt;</span>/Directory<span class=\"token operator\">></span>\n\n    ErrorLog /var/www/fran/log/error.log\n    CustomLog /var/www/fran/log/requests.log combined\n<span class=\"token operator\">&lt;</span>/VirtualHost<span class=\"token operator\">></span></code></pre></div>\n<p>Para crear el DocumentRoot y el directorio donde se almacenarán los logs, ejecutaremos el comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir -p /var/www/fran/log</span></code></pre></div>\n<p>Enlace símbolico:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># ln -s /etc/httpd/sites-available/quijoteweb.conf /etc/httpd/sites-enabled/</span></code></pre></div>\n<p>Modificamos la política de SELinux y permitimos el uso de nuevos los directorios creados y reiniciamos el servicio.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># setsebool -P httpd_unified 1</span>\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># systemctl restart httpd</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote fran<span class=\"token punctuation\">]</span><span class=\"token comment\"># echo \"&lt;?php phpinfo(); ?>\" > /var/www/fran/info.php</span>\n<span class=\"token comment\">#darle permiso de lectura</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/54e62e55249a3b2d24f35901eec802db/b9380/virtualhostquijote.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 29.78468899521531%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAAsSAAALEgHS3X78AAAApklEQVQY062KzQqCQACE95E00GjVvBrYDyTYrXoLKVuXdbeD75qggcedZKtLGBQ18DE/DNnvtkiSNTZpitVygXkcYxZFmPo+Ju4YjuuAUoowDBEEATyPYmTbsCxrEFLkGTgvwBjD8ZChOOWQnENKibNSEEKYXFWVcSUYVO9lWfa9NNs9S9NJ217RNI3hUtfoug6/iAyNWmvopz/AS38H+eT0DQR/1g15QZKIz466xgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"virtual host en quijote\"\n        src=\"/gatsbyjs/static/54e62e55249a3b2d24f35901eec802db/36727/virtualhostquijote.png\"\n        srcset=\"/gatsbyjs/static/54e62e55249a3b2d24f35901eec802db/acf4b/virtualhostquijote.png 173w,\n/gatsbyjs/static/54e62e55249a3b2d24f35901eec802db/fc834/virtualhostquijote.png 345w,\n/gatsbyjs/static/54e62e55249a3b2d24f35901eec802db/36727/virtualhostquijote.png 690w,\n/gatsbyjs/static/54e62e55249a3b2d24f35901eec802db/b9380/virtualhostquijote.png 836w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/a987b/info-php-openstack.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.28125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABvklEQVQoz42S307iQBTGeS8RULwAQ+KFN8bncd/BG8V7E01MjIm70UKAYintapBOC9p2QJA/JlB1rwrfng50JZhNOOmXOacz55fvdBrZ29tHJpNBPB5DIpHA1lYSyeSmqGOxdVrXRb5YB+fi0Siia2tIbGwilUphZ3sX6XQaEcdx4JI450JnZzkcHl7i+PgnTk4kZLO3lN8IZUlHR79w8COLsqyj02nDcamvxdFqc+i6jgiWQlV7kKQ3lMt/UCy2SBqqVQZNM+diKBSq8LzP5VaMRyNEJpMJQk2nU+TzNk5PDeRyHmSZ4+GhikbDhGUZczGYpkHAsYCEvUEMBoOZwwBET5BBUfq4unoh4Du54+S0hEpFJVWEFGW2ep6Hr17RjOFwuAwEjcNxfd2nJhDQpXEVGIaBer0uFOS1Wm0V4OylJDVxfm7h7s4XwPt7jUa0wBj7pwA4Xh34TMAn+n4+SqUW3ZwqnD0+1sHInWWawuXKDmXZwcUFI3Cfxm9SXaSxNbpdDWog/bfIR6PxasBerwdn/l86jg3btuG6Ll67XdjtDoxnDmY28PHx+X9gGOHGYgSjdQnm+/63vfD8IvAv1FcEQNmg1tcAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"php.info en quijote\"\n        src=\"/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/36727/info-php-openstack.png\"\n        srcset=\"/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/acf4b/info-php-openstack.png 173w,\n/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/fc834/info-php-openstack.png 345w,\n/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/36727/info-php-openstack.png 690w,\n/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/17fa4/info-php-openstack.png 1035w,\n/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/a5044/info-php-openstack.png 1380w,\n/gatsbyjs/static/705b41dcdbf1b27435b1f783d338aaad/a987b/info-php-openstack.png 1920w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"servidor-de-base-de-datos\"><a href=\"#servidor-de-base-de-datos\" aria-label=\"servidor de base de datos permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Servidor de base de datos</h2>\n<p>En sancho (Ubuntu) vamos a instalar un servidor de base de datos mariadb (bd.tu_nombre.gonzalonazareno.org). Entrega una prueba de funcionamiento donde se vea como se realiza una conexión a la base de datos desde quijote.</p>\n<p><strong>Instalación del servidor.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ubuntu@sancho:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> mariadb-server\nubuntu@sancho:~$ <span class=\"token function\">sudo</span> mysql_secure_installation</code></pre></div>\n<p><strong>Configuración de Mariadb.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ubuntu@sancho:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/mysql/mariadb.conf.d/50-server.cnf \n<span class=\"token comment\">#modificamos la linea bind-address</span>\nbind-address            <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span>.0.0</code></pre></div>\n<p><strong>Creación de usuario remoto.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ubuntu@sancho:~$ <span class=\"token function\">sudo</span> mysql -u root -p\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with <span class=\"token punctuation\">;</span> or <span class=\"token punctuation\">\\</span>g.\nYour MariaDB connection <span class=\"token function\">id</span> is <span class=\"token number\">39</span>\nServer version: <span class=\"token number\">10.3</span>.25-MariaDB-0ubuntu0.20.04.1 Ubuntu <span class=\"token number\">20.04</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">2000</span>, <span class=\"token number\">2018</span>, Oracle, MariaDB Corporation Ab and others.\n\nType <span class=\"token string\">'help;'</span> or <span class=\"token string\">'\\h'</span> <span class=\"token keyword\">for</span> help. Type <span class=\"token string\">'<span class=\"token entity\" title=\"\\c\">\\c</span>'</span> to <span class=\"token function\">clear</span> the current input statement.\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> CREATE <span class=\"token environment constant\">USER</span> <span class=\"token string\">'fran'</span>@<span class=\"token string\">'10.0.2.4'</span> IDENTIFIED BY <span class=\"token string\">'fran'</span><span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.076</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database mundodb<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">1</span> row affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.056</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> GRANT ALL PRIVILEGES ON *.* TO <span class=\"token string\">'fran'</span>@<span class=\"token string\">'10.0.2.4'</span><span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.000</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> FLUSH PRIVILEGES<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> quit\nBye    </code></pre></div>\n<p><strong>Creación de la base de datos.</strong></p>\n<p>Nos descargaremos una base de datos de prueba llama world.sql</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">MariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database world<span class=\"token punctuation\">;</span>\nubuntu@sancho:~$ <span class=\"token function\">sudo</span> mysql -u fran -p mundo <span class=\"token operator\">&lt;</span> world.sql\nMariaDB <span class=\"token punctuation\">[</span>mundodb<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> show tables<span class=\"token punctuation\">;</span>\n+-----------------+\n<span class=\"token operator\">|</span> Tables_in_world <span class=\"token operator\">|</span>\n+-----------------+\n<span class=\"token operator\">|</span> city            <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> country         <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span> countrylanguage <span class=\"token operator\">|</span>\n+-----------------+\n<span class=\"token number\">3</span> rows <span class=\"token keyword\">in</span> <span class=\"token builtin class-name\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span>\nMariaDB <span class=\"token punctuation\">[</span>mundodb<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token keyword\">select</span> * from city<span class=\"token punctuation\">;</span>\n+------+------------------------------------+-------------+------------------------+------------+\n<span class=\"token operator\">|</span> ID   <span class=\"token operator\">|</span> Name                               <span class=\"token operator\">|</span> CountryCode <span class=\"token operator\">|</span> District               <span class=\"token operator\">|</span> Population <span class=\"token operator\">|</span>\n+------+------------------------------------+-------------+------------------------+------------+\n<span class=\"token operator\">|</span>    <span class=\"token number\">1</span> <span class=\"token operator\">|</span> Kabul                              <span class=\"token operator\">|</span> AFG         <span class=\"token operator\">|</span> Kabol                  <span class=\"token operator\">|</span>    <span class=\"token number\">1780000</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">2</span> <span class=\"token operator\">|</span> Qandahar                           <span class=\"token operator\">|</span> AFG         <span class=\"token operator\">|</span> Qandahar               <span class=\"token operator\">|</span>     <span class=\"token number\">237500</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">3</span> <span class=\"token operator\">|</span> Herat                              <span class=\"token operator\">|</span> AFG         <span class=\"token operator\">|</span> Herat                  <span class=\"token operator\">|</span>     <span class=\"token number\">186800</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">4</span> <span class=\"token operator\">|</span> Mazar-e-Sharif                     <span class=\"token operator\">|</span> AFG         <span class=\"token operator\">|</span> Balkh                  <span class=\"token operator\">|</span>     <span class=\"token number\">127800</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">5</span> <span class=\"token operator\">|</span> Amsterdam                          <span class=\"token operator\">|</span> NLD         <span class=\"token operator\">|</span> Noord-Holland          <span class=\"token operator\">|</span>     <span class=\"token number\">731200</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">6</span> <span class=\"token operator\">|</span> Rotterdam                          <span class=\"token operator\">|</span> NLD         <span class=\"token operator\">|</span> Zuid-Holland           <span class=\"token operator\">|</span>     <span class=\"token number\">593321</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">7</span> <span class=\"token operator\">|</span> Haag                               <span class=\"token operator\">|</span> NLD         <span class=\"token operator\">|</span> Zuid-Holland           <span class=\"token operator\">|</span>     <span class=\"token number\">440900</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">8</span> <span class=\"token operator\">|</span> Utrecht                            <span class=\"token operator\">|</span> NLD         <span class=\"token operator\">|</span> Utrecht                <span class=\"token operator\">|</span>     <span class=\"token number\">234323</span> <span class=\"token operator\">|</span>\n<span class=\"token operator\">|</span>    <span class=\"token number\">9</span> <span class=\"token operator\">|</span> Eindhoven                          <span class=\"token operator\">|</span> NLD         <span class=\"token operator\">|</span> Noord-Brabant          <span class=\"token operator\">|</span>     <span class=\"token number\">201843</span> <span class=\"token operator\">|</span>\n<span class=\"token punctuation\">..</span>.</code></pre></div>\n<p><strong>Prueba de funcionamiento.</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">sudo</span> yum <span class=\"token function\">install</span> mariadb-server\n<span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">sudo</span> systemctl status mariadb\n● mariadb.service - MariaDB <span class=\"token number\">10.3</span> database server\n   Loaded: loaded <span class=\"token punctuation\">(</span>/usr/lib/systemd/system/mariadb.service<span class=\"token punctuation\">;</span> disabled<span class=\"token punctuation\">;</span> vendor preset: disabled<span class=\"token punctuation\">)</span>\n   Active: inactive <span class=\"token punctuation\">(</span>dead<span class=\"token punctuation\">)</span>\n     Docs: man:mysqld<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n           https://mariadb.com/kb/en/library/systemd/\n<span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">sudo</span> systemctl start mariadb\n<span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">sudo</span> systemctl status mariadb\n● mariadb.service - MariaDB <span class=\"token number\">10.3</span> database server\n   Loaded: loaded <span class=\"token punctuation\">(</span>/usr/lib/systemd/system/mariadb.service<span class=\"token punctuation\">;</span> disabled<span class=\"token punctuation\">;</span> vendor preset: disabled<span class=\"token punctuation\">)</span>\n   Active: active <span class=\"token punctuation\">(</span>running<span class=\"token punctuation\">)</span> since Thu <span class=\"token number\">2020</span>-12-17 <span class=\"token number\">12</span>:32:10 UTC<span class=\"token punctuation\">;</span> 4s ago\n     Docs: man:mysqld<span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n           https://mariadb.com/kb/en/library/systemd/\n  Process: <span class=\"token number\">16693</span> <span class=\"token assign-left variable\">ExecStartPost</span><span class=\"token operator\">=</span>/usr/libexec/mysql-check-upgrade <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>/SUCCESS<span class=\"token punctuation\">)</span>\n  Process: <span class=\"token number\">16558</span> <span class=\"token assign-left variable\">ExecStartPre</span><span class=\"token operator\">=</span>/usr/libexec/mysql-prepare-db-dir mariadb.service <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>/SUCCESS<span class=\"token punctuation\">)</span>\n  Process: <span class=\"token number\">16534</span> <span class=\"token assign-left variable\">ExecStartPre</span><span class=\"token operator\">=</span>/usr/libexec/mysql-check-socket <span class=\"token punctuation\">(</span>code<span class=\"token operator\">=</span>exited, <span class=\"token assign-left variable\">status</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>/SUCCESS<span class=\"token punctuation\">)</span>\n Main PID: <span class=\"token number\">16661</span> <span class=\"token punctuation\">(</span>mysqld<span class=\"token punctuation\">)</span>\n   Status: <span class=\"token string\">\"Taking your SQL requests now...\"</span>\n    Tasks: <span class=\"token number\">30</span> <span class=\"token punctuation\">(</span>limit: <span class=\"token number\">2812</span><span class=\"token punctuation\">)</span>\n   Memory: <span class=\"token number\">99</span>.8M\n   CGroup: /system.slice/mariadb.service\n           └─16661 /usr/libexec/mysqld --basedir<span class=\"token operator\">=</span>/usr     </code></pre></div>\n<p><strong>Configuración para la conexión desde Quijote.</strong></p>\n<p>Instalamos mariadb-server.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote ~<span class=\"token punctuation\">]</span><span class=\"token comment\"># dnf -y install mariadb-server</span>\nLast metadata expiration check: <span class=\"token number\">5</span>:26:30 ago on Tue 02 Feb <span class=\"token number\">2021</span> 03:19:48 PM UTC.\n\nInstalled:\n  libaio-0.3.112-1.el8.x86_64                                         mariadb-3:10.3.27-3.module_el8.3.0+599+c587b2e7.x86_64                    \n  mariadb-backup-3:10.3.27-3.module_el8.3.0+599+c587b2e7.x86_64       mariadb-connector-c-3.1.11-2.el8_3.x86_64                                 \n  mariadb-errmsg-3:10.3.27-3.module_el8.3.0+599+c587b2e7.x86_64       mariadb-gssapi-server-3:10.3.27-3.module_el8.3.0+599+c587b2e7.x86_64      \n  mariadb-server-3:10.3.27-3.module_el8.3.0+599+c587b2e7.x86_64       mariadb-server-utils-3:10.3.27-3.module_el8.3.0+599+c587b2e7.x86_64       \n  perl-Carp-1.42-396.el8.noarch                                       perl-DBD-MySQL-4.046-3.module_el8.1.0+203+e45423dc.x86_64                 \n  perl-DBI-1.641-3.module_el8.1.0+199+8f0a6bbd.x86_64                 perl-Data-Dumper-2.167-399.el8.x86_64                                     \n  perl-Digest-1.17-395.el8.noarch                                     perl-Digest-MD5-2.55-396.el8.x86_64                                       \n  perl-Encode-4:2.97-3.el8.x86_64                                     perl-Errno-1.28-416.el8.x86_64                                            \n  perl-Exporter-5.72-396.el8.noarch                                   perl-File-Path-2.15-2.el8.noarch                                          \n  perl-File-Temp-0.230.600-1.el8.noarch                               perl-Getopt-Long-1:2.50-4.el8.noarch                                      \n  perl-HTTP-Tiny-0.074-1.el8.noarch                                   perl-IO-1.38-416.el8.x86_64                                               \n  perl-IO-Socket-IP-0.39-5.el8.noarch                                 perl-IO-Socket-SSL-2.066-4.module_el8.3.0+410+ff426aa3.noarch             \n  perl-MIME-Base64-3.15-396.el8.x86_64                                perl-Math-BigInt-1:1.9998.11-7.el8.noarch                                 \n  perl-Math-Complex-1.59-416.el8.noarch                               perl-Mozilla-CA-20160104-7.module_el8.3.0+416+dee7bcef.noarch             \n  perl-Net-SSLeay-1.88-1.module_el8.3.0+410+ff426aa3.x86_64           perl-PathTools-3.74-1.el8.x86_64                                          \n  perl-Pod-Escapes-1:1.07-395.el8.noarch                              perl-Pod-Perldoc-3.28-396.el8.noarch                                      \n  perl-Pod-Simple-1:3.35-395.el8.noarch                               perl-Pod-Usage-4:1.69-395.el8.noarch                                      \n  perl-Scalar-List-Utils-3:1.49-2.el8.x86_64                          perl-Socket-4:2.027-3.el8.x86_64                                          \n  perl-Storable-1:3.11-3.el8.x86_64                                   perl-Term-ANSIColor-4.06-396.el8.noarch                                   \n  perl-Term-Cap-1.17-395.el8.noarch                                   perl-Text-ParseWords-3.30-395.el8.noarch                                  \n  perl-Text-Tabs+Wrap-2013.0523-395.el8.noarch                        perl-Time-Local-1:1.280-1.el8.noarch                                      \n  perl-URI-1.73-3.el8.noarch                                          perl-Unicode-Normalize-1.25-396.el8.x86_64                                \n  perl-constant-1.33-396.el8.noarch                                   perl-interpreter-4:5.26.3-416.el8.x86_64                                  \n  perl-libnet-3.11-3.el8.noarch                                       perl-libs-4:5.26.3-416.el8.x86_64                                         \n  perl-macros-4:5.26.3-416.el8.x86_64                                 perl-parent-1:0.237-1.el8.noarch                                          \n  perl-podlators-4.11-1.el8.noarch                                    perl-threads-1:2.21-2.el8.x86_64                                          \n  perl-threads-shared-1.58-2.el8.x86_64                              \n\nComplete<span class=\"token operator\">!</span></code></pre></div>\n<p><strong>Prueba de conexión</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>centos@quijote ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">sudo</span> mysql -u fran -p mundodb -h bd.madu.gonzalonazareno.org\nEnter password: \nWelcome to the MariaDB monitor.  Commands end with <span class=\"token punctuation\">;</span> or <span class=\"token punctuation\">\\</span>g.\nYour MariaDB connection <span class=\"token function\">id</span> is <span class=\"token number\">48</span>\nServer version: <span class=\"token number\">10.3</span>.25-MariaDB-0ubuntu0.20.04.1 Ubuntu <span class=\"token number\">20.04</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">2000</span>, <span class=\"token number\">2018</span>, Oracle, MariaDB Corporation Ab and others.\n\nType <span class=\"token string\">'help;'</span> or <span class=\"token string\">'\\h'</span> <span class=\"token keyword\">for</span> help. Type <span class=\"token string\">'<span class=\"token entity\" title=\"\\c\">\\c</span>'</span> to <span class=\"token function\">clear</span> the current input statement.\n\nMariaDB <span class=\"token punctuation\">[</span>mundodb<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> </code></pre></div>","timeToRead":27,"excerpt":"https://dit.gonzalonazareno.org/redmine/projects/asir2/wiki/Servidores_Web_y_DNS Servidor DNS El primer paso será instalar bind9 en nuestro…","frontmatter":{"title":"OpenStack: Servidores Web, Base de Datos y DNS","cover":"https://img.icons8.com/ios/452/work.png","date":"2020-12-15T00:00:00.000Z","categories":["SRI"],"tags":["OpenStack","Servidor Web","Base de datos","DNS"]},"fields":{"slug":"/open-stack-servidores-web-base-de-datos-y-dns","date":"December 14, 2020"}}},"pageContext":{"slug":"/open-stack-servidores-web-base-de-datos-y-dns","nexttitle":"Modificación del escenario de OpenStack","nextslug":"/modificacion-del-escenario-de-open-stack","prevtitle":"Tarea OVH. HTTPS","prevslug":"/tarea-ovh-https"}}}