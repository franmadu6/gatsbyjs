{"componentChunkName":"component---src-templates-post-js","path":"/sa-open-stack-configuracion-https","result":{"data":{"markdownRemark":{"html":"<h2 id=\"el-siguiente-paso-de-nuestro-proyecto-es-configurar-de-forma-adecuada-el-protocolo-https-en-nuestro-servidor-web-para-nuestra-aplicaciones-web-para-ello-vamos-a-emitir-un-certificado-wildcard-en-la-ac-gonzalo-nazareno-utilizando-para-la-petición-la-utilidad-gestiona\"><a href=\"#el-siguiente-paso-de-nuestro-proyecto-es-configurar-de-forma-adecuada-el-protocolo-https-en-nuestro-servidor-web-para-nuestra-aplicaciones-web-para-ello-vamos-a-emitir-un-certificado-wildcard-en-la-ac-gonzalo-nazareno-utilizando-para-la-petici%C3%B3n-la-utilidad-gestiona\" aria-label=\"el siguiente paso de nuestro proyecto es configurar de forma adecuada el protocolo https en nuestro servidor web para nuestra aplicaciones web para ello vamos a emitir un certificado wildcard en la ac gonzalo nazareno utilizando para la petición la utilidad gestiona permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>El siguiente paso de nuestro proyecto es configurar de forma adecuada el protocolo HTTPS en nuestro servidor web para nuestra aplicaciones web. Para ello vamos a emitir un certificado wildcard en la AC Gonzalo Nazareno utilizando para la petición la utilidad \"gestiona\".</h2>\n<p>Comenzaremos creando el directorio que usaremos para guardar las claves ssl, dando los respectivos permisos y generando la clave RSA.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># mkdir /etc/ssl/private</span>\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 700 /etc/ssl/private/</span>\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># openssl genrsa 4096 > /etc/ssl/private/openstack.key</span>\nGenerating RSA private key, <span class=\"token number\">4096</span> bit long modulus <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> primes<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>.++++\n<span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span><span class=\"token punctuation\">..</span>++++\ne is <span class=\"token number\">65537</span> <span class=\"token punctuation\">(</span>0x010001<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># chmod 400 /etc/ssl/private/openstack.key</span></code></pre></div>\n<p>Crearemos un fichero con la clave generada anteriormente para que sea firmado por la autoridad certificadora de IES Gonzalo Nazareno.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># openssl req -new -key /etc/ssl/private/openstack.key -out /root/openstack.csr</span>\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter <span class=\"token string\">'.'</span>, the field will be left blank.\n-----\nCountry Name <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> letter code<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>XX<span class=\"token punctuation\">]</span>:ES\nState or Province Name <span class=\"token punctuation\">(</span>full name<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>:Sevilla\nLocality Name <span class=\"token punctuation\">(</span>eg, city<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Default City<span class=\"token punctuation\">]</span>:Dos Hermanas\nOrganization Name <span class=\"token punctuation\">(</span>eg, company<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Default Company Ltd<span class=\"token punctuation\">]</span>:IES Gonzalo Nazareno\nOrganizational Unit Name <span class=\"token punctuation\">(</span>eg, section<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>:Informatica\nCommon Name <span class=\"token punctuation\">(</span>eg, your name or your server<span class=\"token string\">'s hostname) []:*.madu.gonzalonazareno.org\nEmail Address []:frandh1997@gmail.com\n-\nPlease enter the following '</span>extra' attributes\nto be sent with your certificate request\nA challenge password <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>:\nAn optional company name <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>:</code></pre></div>\n<p>Subimos el archivo a <a href=\"https://dit.gonzalonazareno.org/gestiona/cert/\">gestiona</a> y esperaremos a que sea firmado.\nUna vez firmado, aprovecharemos para descargarnos el certificado de IES Gonzalo Nazareno y ambos archivos los ubicaremos en /etc/ssl/cert/.</p>\n<p>Modificaremos nuestro virtualhost añadiendo añadiendo la redirección al puerto 443 y le añadiremos los certificados.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># cat /etc/httpd/sites-available/quijoteweb.conf </span>\n<span class=\"token operator\">&lt;</span>VirtualHost *:8<span class=\"token operator\"><span class=\"token file-descriptor important\">0</span>></span>\n    ServerName www.madu.gonzalonazareno.org\n\n    Redirect <span class=\"token number\">301</span> / https://www.madu.gonzalonazareno.org/\n\n    ErrorLog /var/www/fran/log/error.log\n    CustomLog /var/www/fran/log/requests.log combined\n<span class=\"token operator\">&lt;</span>/VirtualHost<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>IfModule mod_ssl.c<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>VirtualHost _default_:44<span class=\"token operator\"><span class=\"token file-descriptor important\">3</span>></span>\n        ServerName www.madu.gonzalonazareno.org\n        DocumentRoot /var/www/fran\n\n\t<span class=\"token comment\">#Certificados</span>\n\tSSLEngine on\n\n        SSLCertificateFile\t/etc/ssl/certs/openstack.crt\n        SSLCertificateKeyFile   /etc/ssl/private/openstack.key\n        SSLCACertificateFile    /etc/ssl/certs/gonzalonazareno.crt\n\n\n        <span class=\"token operator\">&lt;</span>Directory /var/www/fran/<span class=\"token operator\">></span>\n         Options FollowSymLinks\n         AllowOverride All\n         Order deny,allow\n         Allow from all\n         <span class=\"token comment\">#PHP</span>\n\t <span class=\"token operator\">&lt;</span>FilesMatch <span class=\"token string\">\"\\.php\"</span><span class=\"token operator\">></span>\n                SetHandler <span class=\"token string\">\"proxy:unix:/run/php-fpm/www.sock|fcgi://localhost\"</span>\n         <span class=\"token operator\">&lt;</span>/FilesMatch<span class=\"token operator\">></span>\n\n\t<span class=\"token operator\">&lt;</span>/Directory<span class=\"token operator\">></span>\n\n        ErrorLog /var/www/fran/log/error.log\n        CustomLog /var/www/fran/log/requests.log combined\n    <span class=\"token operator\">&lt;</span>/VirtualHost<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/IfModule<span class=\"token operator\">></span></code></pre></div>\n<p>Instalamos el modulo de ssl para httpd.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># dnf install mod_ssl</span></code></pre></div>\n<p>Deberemos de añadir una nueva directiva para habilitar https.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>root@quijote centos<span class=\"token punctuation\">]</span><span class=\"token comment\"># nano /etc/httpd/conf/httpd.conf</span>\nListen <span class=\"token number\">443</span></code></pre></div>\n<p>No olvidemos añadir una regla de encaminamiento creada en el ejercicio anterior:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@dulcinea:~<span class=\"token comment\"># nft add rule ip nat prerouting iifname \"eth0\" tcp dport 443 counter dnat to 10.0.2.4</span></code></pre></div>\n<p>!Listo¡ ya tendremos nuestro virtualhost funcionando en el puerto 443, será un poco mas seguro...\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/7449d/ssl-openstack.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 70.4933586337761%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACRUlEQVQ4y42TSW/aUBSF+RlZtRWIRsyBMA9mCDGF0oihYChQhkYhYcOyC0IgTXcsWPAPU+iWQSFIKOHU96ZGkSLSWjo6fvbzed+9z09VLH1FoVSB9KWCTE6CEAzhwGKGxWKB2fzkBwdWdpPJBKPRuHVFNE+R6uy0jkajgWqlzGo1m7i4OMPp6TfWxfk5Wudnsjd5Xq1WQ7VaZadxvV5HoSBBkvKyF6D6PRljMplgPB7j1+0tft7coN1u4+rqCr3+D9blZUced9Hr9dDv99m73S7PGwwGmM1mWC6XuLu7gwrPrsVijk+pDKx2J6JHRzCcfIcu1sK7t2+g1mig+Su1Ws2+t7eHcDiM1Wq1zVA9Pj7i4eGBB9PpFKVyGbFYDIl4AqGPBbgjJ3A6nazDw0OW3W7nMfUsk8kwHV2UxYSbzYYfzOdzFItFXjUSiSDxQWTF43EcycSCICAYDMLn88HlcsFqtSKbzeL+/h5KzotASZIQCAQQCoUgyqTHogi3281UDoeDycg9Hg87BSqELwJnsydCIkomk0xJwYIQ4I/9fj8H2mw2XsBgMCCdTr9OSFsfjUblsPC29GBQgNfrlcchJqNF6B09y+U+7yakQGoylRwI+LlUEoVQz4iKNoWCaM5/lDzjkhOJBES5d0Si0DyXz+eVwx18Sv5ZcqlU4v7RRFIqlWJqckWieMwL0W7n8/ndhIvFggm0Wi03XK/XQ6fTbV25J9H7/f33vIE7A+mPHw6HfKzoiL2m6+trdDodjEYjrNfrbeAf+dC2oCc5mawAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"Prueba de acceso 443\"\n        src=\"/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/36727/ssl-openstack.png\"\n        srcset=\"/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/acf4b/ssl-openstack.png 173w,\n/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/fc834/ssl-openstack.png 345w,\n/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/36727/ssl-openstack.png 690w,\n/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/17fa4/ssl-openstack.png 1035w,\n/gatsbyjs/static/ddbc61054f00d3803c500ceefe18e48e/7449d/ssl-openstack.png 1054w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>","timeToRead":3,"excerpt":"El siguiente paso de nuestro proyecto es configurar de forma adecuada el protocolo HTTPS en nuestro servidor web para nuestra aplicaciones…","frontmatter":{"title":"[SA] - OpenStack: Configuración HTTPS","cover":"https://img.icons8.com/ios/452/work.png","date":"2021-02-07T00:00:00.000Z","categories":["SAD"],"tags":["OpenStack","HTTPS"]},"fields":{"slug":"/sa-open-stack-configuracion-https","date":"February 06, 2021"}}},"pageContext":{"slug":"/sa-open-stack-configuracion-https","nexttitle":"Métricas, logs o monitorización","nextslug":"/metricas-logs-o-monitorizacion","prevtitle":"Instalación y configuración básica de VMWare ESXi","prevslug":"/instalacion-y-configuracion-basica-de-vm-ware-es-xi"}}}