{"componentChunkName":"component---src-templates-post-js","path":"/iaw-p-1-instalacion-local-de-un-cms-php","result":{"data":{"markdownRemark":{"html":"<h1 id=\"tarea-1-instalación-de-un-servidor-lamp\"><a href=\"#tarea-1-instalaci%C3%B3n-de-un-servidor-lamp\" aria-label=\"tarea 1 instalación de un servidor lamp permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 1: Instalación de un servidor LAMP</h1>\n<ol>\n<li><strong>Crea una instancia de vagrant basado en un box debian o ubuntu.</strong></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># -*- mode: ruby -*-</span>\n<span class=\"token comment\"># vi: set ft=ruby :</span>\nVagrant.configure<span class=\"token punctuation\">(</span><span class=\"token string\">\"2\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>config<span class=\"token operator\">|</span>\n\n  config.vm.box <span class=\"token operator\">=</span> <span class=\"token string\">\"debian/buster64\"</span>\n  config.vm.hostname <span class=\"token operator\">=</span> <span class=\"token string\">\"drupal\"</span>\n  config.vm.network <span class=\"token string\">\"private_network\"</span>, ip: <span class=\"token string\">\"192.168.100.5\"</span>\n\nend</code></pre></div>\n<ol start=\"2\">\n<li><strong>Instala en esa máquina virtual toda la pila LAMP</strong></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#Instalamos apache2 y apache2-utils</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y apache2 apache2-utils\n<span class=\"token comment\">#Instalamos el servidor y el cliente de mariadb</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> -y mariadb-server mariadb-client\n<span class=\"token comment\">#los dos pasos anteriores puede que ya vengan instalados por defecto</span>\n<span class=\"token comment\">#Instalamos php y los módulos necesarios y recomendables de php</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> php libapache2-mod-php php-cli php-fpm php-json php-pdo php-mysql php-zip php-gd  php-mbstring php-curl php-xml php-pear php-bcmath</code></pre></div>\n<h1 id=\"tarea-2-instalación-de-drupal-en-mi-servidor-local\"><a href=\"#tarea-2-instalaci%C3%B3n-de-drupal-en-mi-servidor-local\" aria-label=\"tarea 2 instalación de drupal en mi servidor local permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 2: Instalación de drupal en mi servidor local</h1>\n<ol>\n<li><strong>Configura el servidor web con virtual hosting para que el CMS sea accesible desde la dirección: www.nombrealumno-drupal.org.</strong></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">ServerName www.madu-drupal.org</code></pre></div>\n<ol start=\"2\">\n<li><strong>Crea un usuario en la base de datos para trabajar con la base de datos donde se van a guardar los datos del CMS.</strong></li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:~$ <span class=\"token function\">sudo</span> mysql -u root -p\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create user <span class=\"token string\">'fmadu'</span> identified by <span class=\"token string\">'dios'</span><span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.005</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> GRANT ALL PRIVILEGES ON *.* TO <span class=\"token string\">'fmadu'</span>@<span class=\"token string\">'localhost'</span>\n    -<span class=\"token operator\">></span> IDENTIFIED BY <span class=\"token string\">'dios'</span> WITH GRANT OPTION<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token builtin class-name\">exit</span>\nBye\nvagrant@drupal:~$ mysql -u fmadu -p\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database fmadudb<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">1</span> row affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.002</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<ol start=\"3\">\n<li><strong>Descarga la versión que te parezca más oportuna de Drupal y realiza la instalación.</strong></li>\n</ol>\n<p>Descargamos drupal de la web oficial,(la ultima version).</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> <span class=\"token function\">wget</span> https://www.drupal.org/download-latest/zip</code></pre></div>\n<p>Creamos el directorio drupal en /var/www/, descomprimimos el fichero descargado y copiamos su contenido en dicho directorio.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /var/www/drupal\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> <span class=\"token function\">unzip</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">unzip</span> <span class=\"token function\">zip</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">mv</span> drupal-9.0.7/* /var/www/drupal</code></pre></div>\n<p>En /var/www/ y le damos los respectivos permisos necesarios.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">chown</span> www-data drupal/\n<span class=\"token function\">chgrp</span> www-data drupal/</code></pre></div>\n<p>Añadimos la nueva ruta a nuestro archivo de configuracion.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">DocumentRoot /var/www/drupal</code></pre></div>\n<p>Enlace simbolico:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> a2ensite drupal</code></pre></div>\n<p>Cambiamos el usuario del directorio.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> -R www-data:www-data /var/www/drupal/</code></pre></div>\n<p>Recargamos apache2:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">systemctl reload apache2</code></pre></div>\n<p>Modificamos el fichero  hosts en nuestra maquina fisica.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token number\">192.168</span>.100.5       www.madu-drupal.org</code></pre></div>\n<p>El contenido de este archivo es un bloque Directory para el directorio de Drupal en el que una directiva AllowOverride permitirá el uso de los archivos <strong>.htaccess</strong>:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">        <span class=\"token operator\">&lt;</span>Directory /var/www/drupal<span class=\"token operator\">></span>\n                AllowOverride all\n        <span class=\"token operator\">&lt;</span>/Directory<span class=\"token operator\">></span></code></pre></div>\n<p>Con estos pasos hechos correctamente podremos ver como podemos usar drupal desde nuestro navegador\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/a987b/drupalfound.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.25000000000001%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAB8UlEQVQoz3WSy07bUBCGLRKWdY5NoF0DrwXhkthJbEKQWBb6BEhUXKoCJdQOTkILu16eAKkECizYUgFCVEIQIFQBYvJ35pigqrSWRhqf+f9Pc86MovZNITIwC5GYg5ZchJbKQbcctGc8dAwX0JEtUpQegnM6o5puudDSS9DMd4jE30Ltn8Wz2BQUMfgmgFFBS5GAhMJeRthwEDLyCJnLaDE9GTLns0SgYa30sJcYzFI0Y546y1HRgT7kQWSKeDG6hkG3jKS3Bau4Dau0A3tlF2nOC1tIuBt4ThqRKUkPeyWDWIpm0jXTAawtuwJ1+CO6xz/j5PwC1eoVgDrg36Bxc025D/78+wY6xz5JLXsklBjMUoLuXOiZAtpGPkDNrqLr1Vccn57j8qKCun+PHyen2Ns/ws+zCmp3Ps6ubwn4hbRr0sNeeX1i/bPDLuqw+qsGNIKODis1lA8quKrdyf/buo/Ol//pUDx5wxK9zyp6F9cRd75hwNlAytuEXfwOI19GnN4vlluXmr/fkFlPpizXwfbQauYRpqmGkwWEKFooOOczrrFG/2PKojnlSOw1RP80mmBhLMh9jFrvEbUdChfRoXwQnPMZ1VjD2iaIGcxS1J4JRHonIeSCzwRFWtQmXJgLQffcBeWPENaQVnrYG5sEs34DXLXaepxKnqAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"drupal1\"\n        src=\"/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/36727/drupalfound.png\"\n        srcset=\"/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/acf4b/drupalfound.png 173w,\n/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/fc834/drupalfound.png 345w,\n/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/36727/drupalfound.png 690w,\n/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/17fa4/drupalfound.png 1035w,\n/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/a5044/drupalfound.png 1380w,\n/gatsbyjs/static/b8d0567457763b1c3b228cb6539895c1/a987b/drupalfound.png 1920w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Una vez realizado todos los procedimientos de configuración del asistente de instalación, tendremos instalado drupal en nuestro servidor.\nEl proceso es muy simple típico siguiente,siguiente,siguiente...</p>\n<p>Me salia un error de no tener URL limpia configurada lo he solucionado, activando el mod_rewrite y modificando el fichero apache.conf en la siguiente linea</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#Para tener una URL limpia, añadimos el siguiente módulo y cambiamos el AllowOverride de \"None\" a \"All\":</span>\nvagrant@drupal:/var/www/html$ <span class=\"token function\">sudo</span> a2enmod rewrite\nvagrant@drupal:/etc/apache2$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> apache2.conf\n<span class=\"token operator\">&lt;</span>Directory /var/www/<span class=\"token operator\">></span>\n        Options Indexes FollowSymLinks\n        AllowOverride All\n        Require all granted\n<span class=\"token operator\">&lt;</span>/Directory<span class=\"token operator\">></span></code></pre></div>\n<ol start=\"4\">\n<li><strong>Realiza una configuración mínima de la aplicación (Cambia la plantilla, crea algún contenido, …)</strong></li>\n</ol>\n<p>Dentro de nuestra web de drupal accederemos a apariencias -> nueva plantilla -> ponemos la URL de la plantilla que hayamos buscado ->\n<a href=\"https://ftp.drupal.org/files/projects/adminimal_theme-8.x-1.6.tar.gz\">https://ftp.drupal.org/files/projects/adminimal_theme-8.x-1.6.tar.gz</a>\ny creamos un poco de contenido:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.33558558558559%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAABPklEQVQoz5WRyW7CQBBE/U3BG+SCQriRY5KfJHgwOXHkayzAMrbxhpeKa6IhIwsJ0lKpe9RTz+0e4/PjHW+LBV6mU0zGY0yeJ3BdB6Y56mViNPrNtm3DsixZ//WeZN91HMx6/+x1DmO322G73eJ7s4FYr7FcfmG1Wkl5ngchPFkLIeD7/k2xJ/q7vG/gTlRVhf+E0bYtmqYBc1WVSJIT0vSE8znu6xhBEOBwOCDPc1wuF/kBXXVdS5FBGV3XgWI0TY0oPqEos95coiiKHnxGlmUyE0ozwRRr5VWc6y+rhh40EEqVZSnPw9AHkr+sw1RTnTlRHMdSSZLISQlW0w3Bd4HcESEEUzqQPWbuTffffGV1IU1T7Pd7HI/Haw7D8DqtepSHgTRFUSQB6nE4oZpSn/QhII2EUXyY4VqGK2L+AYXpI5DCSR45AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"drupal2\"\n        src=\"/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/36727/drupalnode1.png\"\n        srcset=\"/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/acf4b/drupalnode1.png 173w,\n/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/fc834/drupalnode1.png 345w,\n/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/36727/drupalnode1.png 690w,\n/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/17fa4/drupalnode1.png 1035w,\n/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/a5044/drupalnode1.png 1380w,\n/gatsbyjs/static/cc987159a0fd521a38dff3d617a155df/2d178/drupalnode1.png 1776w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<ol start=\"5\">\n<li><strong>Instala un módulo para añadir alguna funcionalidad a drupal.</strong></li>\n</ol>\n<p>He instalado un nuevo modulo -> <a href=\"https://ftp.drupal.org/files/projects/inline_entity_form-8.x-1.0-rc8.tar.gz\">https://ftp.drupal.org/files/projects/inline_entity_form-8.x-1.0-rc8.tar.gz</a>\nLo activamos, este modulo se encarga de proporciona un widget para la gestión en línea (creación, modificación, eliminación) de entidades referenciadas.</p>\n<p>En este momento, muestra al profesor la aplicación funcionando en local. (4 puntos)</p>\n<h1 id=\"tarea-3-configuración-multinodo\"><a href=\"#tarea-3-configuraci%C3%B3n-multinodo\" aria-label=\"tarea 3 configuración multinodo permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 3: Configuración multinodo</h1>\n<ul>\n<li>Realiza un copia de seguridad de la base de datos.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:~$ mysqldump -v --opt --events --routines --triggers --default-character-set<span class=\"token operator\">=</span>utf8 -u fmadu -p fmadudb <span class=\"token operator\">></span> fmadu.sql\nEnter password: \n-- Connecting to localhost<span class=\"token punctuation\">..</span>.\n-- Disconnecting from localhost<span class=\"token punctuation\">..</span>.\nvagrant@drupal:~$ <span class=\"token function\">ls</span>\nfmadu.sql</code></pre></div>\n<ul>\n<li>Crea otra máquina con vagrant, conectada con una red interna a la anterior y configura un servidor de base de datos.</li>\n</ul>\n<p>Creamos una máquina nueva con vagrant</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"> bdd.vm.box <span class=\"token operator\">=</span> <span class=\"token string\">\"debian/buster64\"</span>\n bdd.vm.hostname <span class=\"token operator\">=</span> <span class=\"token string\">\"bdd\"</span>\n bdd.vm.network :public_network,:bridge<span class=\"token operator\">=</span><span class=\"token operator\">></span><span class=\"token string\">\"wlo1\"</span>\n bdd.vm.network :private_network, ip: <span class=\"token string\">\"192.168.100.6\"</span>, virtualbox__intnet: <span class=\"token string\">\"drupal\"</span></code></pre></div>\n<ul>\n<li>Crea un usuario en la base de datos para trabajar con la nueva base de datos.</li>\n</ul>\n<p>Creamos un usuario en el nuevo servidor:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@bdd:~$ <span class=\"token function\">sudo</span> mysql -u root -p\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create user <span class=\"token string\">'drupal2'</span> identified by <span class=\"token string\">'dios'</span><span class=\"token punctuation\">;</span>\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> grant all privileges on *.* to <span class=\"token string\">'drupal2'</span>@<span class=\"token string\">'localhost'</span> identified by <span class=\"token string\">'dios'</span> with grant option<span class=\"token punctuation\">;</span>\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database <span class=\"token string\">'drupal2_db'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Ahora le damos permisos también a la máquina con drupal:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">MariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> grant all on drupal2_db.* to drupal2@192.168.2.171 identified by <span class=\"token string\">'dios'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<p>Restaura la copia de seguridad en el nuevo servidor de base datos.\nHe usado git para pasar el archivo de una maquina a otra.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mysql -u drupal2 --password<span class=\"token operator\">=</span>dios drupal2_db <span class=\"token operator\">&lt;</span> /home/vagrant/prueba/fmadu.sql </code></pre></div>\n</li>\n<li>\n<p>Desinstala el servidor de base de datos en el servidor principal.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> purge mariadb-*</code></pre></div>\n</li>\n<li>Realiza los cambios de configuración necesario en drupal para que la página funcione.</li>\n</ul>\n<p>Modificamos el fichero 50-server.cnf</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal2:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/mysql/mariadb.conf.d/50-server.cnf \n\nbind-address            <span class=\"token operator\">=</span> <span class=\"token number\">0.0</span>.0.0</code></pre></div>\n<p>Nos vamos a nuestra maquina drupal, en drupal.conf:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">        ServerName www.madu-drupal.org\n\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/drupal\n\n        <span class=\"token operator\">&lt;</span>Directory /var/www/drupal<span class=\"token operator\">></span>\n                Options FollowSymLinks\n                AllowOverride All\n                Order allow,deny\n                allow from all\n        <span class=\"token operator\">&lt;</span>/Directory<span class=\"token operator\">></span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/var/www/drupal/sites/default$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> settings.php \n\n<span class=\"token variable\">$databases</span><span class=\"token punctuation\">[</span><span class=\"token string\">'default'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span><span class=\"token string\">'default'</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> array <span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'database'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'drupal2_db'</span>,\n  <span class=\"token string\">'username'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'drupal2'</span>,\n  <span class=\"token string\">'password'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'dios'</span>,\n  <span class=\"token string\">'prefix'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">''</span>,\n  <span class=\"token string\">'host'</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token string\">'192.168.2.63,\n  '</span>port<span class=\"token string\">' => '</span><span class=\"token number\">3306</span><span class=\"token string\">',\n  '</span>namespace<span class=\"token string\">' => '</span>Drupal<span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>Core<span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>Database<span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>Driver<span class=\"token punctuation\">\\</span><span class=\"token punctuation\">\\</span>mysql<span class=\"token string\">',\n  '</span>driver<span class=\"token string\">' => '</span>mysql',\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h1 id=\"tarea-4-instalación-de-otro-cms-php\"><a href=\"#tarea-4-instalaci%C3%B3n-de-otro-cms-php\" aria-label=\"tarea 4 instalación de otro cms php permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 4: Instalación de otro CMS PHP.</h1>\n<ul>\n<li>Elige otro CMS realizado en PHP y realiza la instalación en tu infraestructura.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/var/www$ <span class=\"token function\">sudo</span> <span class=\"token function\">wget</span> https://downloads.joomla.org/es/cms/joomla3/3-9-22/Joomla_3-9-22-Stable-Full_Package.zip?format<span class=\"token operator\">=</span>zip\nvagrant@drupal:/var/www/joomla$ <span class=\"token function\">ls</span>\n administrator   cli            images      installation                                        layouts       media     README.txt        tmp\n bin             components     includes   <span class=\"token string\">'Joomla_3-9-22-Stable-Full_Package.zip?format=zip'</span>   libraries     modules   robots.txt.dist   web.config.txt\n cache           htaccess.txt   index.php   language  \nvagrant@drupal:/var/www$ <span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> -R www-data:www-data joomla/</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> drupal.conf joomla.conf\n        ServerName www.madu-joomla.org\n\n        ServerAdmin webmaster@localhost\n        DocumentRoot /var/www/joomla\n        <span class=\"token operator\">&lt;</span>Directory /var/www/joomla<span class=\"token operator\">></span>\n                AllowOverride all\n        <span class=\"token operator\">&lt;</span>/Directory<span class=\"token operator\">></span>\nvagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> a2ensite joomla.conf \nvagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> systemctl reload apache2</code></pre></div>\n<p>Creamos base de datos para joomla</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/etc/apache2/sites-available$ <span class=\"token function\">sudo</span> mysql -u fmadu -p\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database fmadudbjoomla<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">1</span> row affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.017</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create user <span class=\"token string\">'joomla1'</span> identified by <span class=\"token string\">'dios'</span><span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> grant all on fmadudbjoomla.* to joomla1 identified by <span class=\"token string\">'joomla1'</span>\n    -<span class=\"token operator\">></span> <span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.014</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<ul>\n<li>Configura otro virtualhost y elige otro nombre en el mismo dominio.\nEn mi maquina -></li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token number\">192.168</span>.100.5   www.madu-drupal.org\n<span class=\"token number\">192.168</span>.100.5   www.madu-joomla.org</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/b5457/joomla.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.15822784810127%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABhElEQVQoz41Sy07DMBDMnwLlob5foBYkKnFD/EH5JG5cgFtLaYNaqiTUiesmdjzsJqRUVQ9YGo3X652ddeJcDe7QuRmg1u3jonWJcqdH3MV5s4tSrY1StYaTSh1H5QZxA2eNTnZ+XGnitN5G9bKP1vUAbdKo927hjFcJ3oUmGEyiFJOQ2eJDWkwV8Oa6eB1N8Dzz8TIXeY7uzSSzxTvdH1P9iHQYTmwsYpPm0MwWSoUIpYQnYyx8Ac8PIFSCQGnImGHgy+SvjpBQHcMBLLawzIBaRxCrFUQYIolj2DTF7lpGGk9j8RsVdTkcS8EuMkG1gR8E8DwPQoQw7CBJaC8yhNQoNSaX26v/EyySv3211thsNlA0Ou8ZSiksl0ssFl/UQB8WLMbYTzDYDbuMoghpmrtkdxxzg926YjnYW7vJJKaHpzc0NB6fs+O1jCDJtdkb+aBgkWBmR8aabc4Y+rprhdF0DvdzjuB79X/BTEwbuJ6LIAy2Tn36fe7vH1BvNDEcPh4U/AEO3OoAxIimTAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"joomla1\"\n        src=\"/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/36727/joomla.png\"\n        srcset=\"/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/acf4b/joomla.png 173w,\n/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/fc834/joomla.png 345w,\n/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/36727/joomla.png 690w,\n/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/17fa4/joomla.png 1035w,\n/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/a5044/joomla.png 1380w,\n/gatsbyjs/static/4833bb74eda5579fbd777fc29a0e3616/b5457/joomla.png 1896w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/c01b9/joomla2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 41.77881802223523%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABGklEQVQoz4WS206EMBCGeVVXWQ4rHrLGjfqAPoA3XpKomD1IaCm0UOB3poRVN3G3yZfpab4OE7z7xycsVw+4ul0iiBOEyTWCRYJ5FMOPL+FHixGaz4IIs3no4nkQ48wPiBAXYYyE8m/uVvCKsoJQtaOsDZQ2yIVE+p4h2+zw9rnBx3rr5rbr0QOO1nYO3uMcWY0Or6o11J4avC5Lha88h6aLWusxGoO+7zEww4CiEBBCuPPJwdEryfwbfsk0DWzbwlpLkg5dN8JrB82llA4WsmzK99SfCseDhmSnxnq7owolDFU+5XE8KuRPOxzT3vNLitc0I6E+LTTNj/A/+K5Q1fEKp82SLubU9IJ6VB08OFGTqKL+8V+y7yHFb7GZTTnEar7zAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"joomla2\"\n        src=\"/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/36727/joomla2.png\"\n        srcset=\"/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/acf4b/joomla2.png 173w,\n/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/fc834/joomla2.png 345w,\n/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/36727/joomla2.png 690w,\n/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/17fa4/joomla2.png 1035w,\n/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/a5044/joomla2.png 1380w,\n/gatsbyjs/static/280c1f62ce53f560d256d6f7426c2213/c01b9/joomla2.png 1709w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h1 id=\"tarea-5-necesidad-de-otros-servicios\"><a href=\"#tarea-5-necesidad-de-otros-servicios\" aria-label=\"tarea 5 necesidad de otros servicios permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 5: Necesidad de otros servicios.</h1>\n<p>La mayoría de los CMS tienen la posibilidad de mandar correos electrónicos (por ejemplo para notificar una nueva versión, notificar un comentario,…)</p>\n<ul>\n<li>Instala un servidor de correo electrónico en tu servidor. debes configurar un servidor relay de correo, para ello en el fichero /etc/postfix/main.cf, debes poner la siguiente línea:\nrelayhost = babuino-smtp.gonzalonazareno.org</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/var/www/joomla$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> postfix</code></pre></div>\n<p>Selecciono Internet site y luego pongo un correo -> madu.gonzalonazareno.org</p>\n<p>En /etc/postfix/main.cf:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">smtpd_relay_restrictions <span class=\"token operator\">=</span> permit_mynetworks permit_sasl_authenticated defer_unauth_destination\nmyhostname <span class=\"token operator\">=</span> drupal\nalias_maps <span class=\"token operator\">=</span> hash:/etc/aliases\nalias_database <span class=\"token operator\">=</span> hash:/etc/aliases\nmyorigin <span class=\"token operator\">=</span> /etc/mailname\nmydestination <span class=\"token operator\">=</span> <span class=\"token variable\">$myhostname</span>, madu.gonzalonazareno.org, drupal, localhost.localdomain, localhost\nrelayhost <span class=\"token operator\">=</span> babuino-smtp.gonzalonazareno.org\nmynetworks <span class=\"token operator\">=</span> <span class=\"token number\">127.0</span>.0.0/8 <span class=\"token punctuation\">[</span>::ffff:127.0.0.0<span class=\"token punctuation\">]</span>/104 <span class=\"token punctuation\">[</span>::1<span class=\"token punctuation\">]</span>/128\nmailbox_size_limit <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\nrecipient_delimiter <span class=\"token operator\">=</span> +\ninet_interfaces <span class=\"token operator\">=</span> all\ninet_protocols <span class=\"token operator\">=</span> all</code></pre></div>\n<p>Se inicia el servicio.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/var/www/joomla$ <span class=\"token function\">sudo</span> systemctl start postfix\nvagrant@drupal:/var/www/joomla$ mailq\nMail queue is empty</code></pre></div>\n<ul>\n<li>\n<p>Configura alguno de los CMS para utilizar tu servidor de correo y realiza una prueba de funcionamiento.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@drupal:/var/www/joomla$ mailq\n-Queue ID-  --Size-- ----Arrival Time---- -Sender/Recipient-------\n041EF62200      <span class=\"token number\">706</span> Mon Nov  <span class=\"token number\">2</span> <span class=\"token number\">16</span>:13:19  frandh1997@gmail.com\n<span class=\"token punctuation\">(</span>connect to babuino-smtp.gonzalonazareno.org<span class=\"token punctuation\">[</span><span class=\"token number\">80.59</span>.1.152<span class=\"token punctuation\">]</span>:25: Connection timed out<span class=\"token punctuation\">)</span>\n                                     frandh1997@gmail.com\n<span class=\"token comment\">#</span>\n01D1B623E7      <span class=\"token number\">993</span> Mon Nov  <span class=\"token number\">2</span> <span class=\"token number\">16</span>:13:18  frandh1997@gmail.com\n<span class=\"token punctuation\">(</span>connect to babuino-smtp.gonzalonazareno.org<span class=\"token punctuation\">[</span><span class=\"token number\">80.59</span>.1.152<span class=\"token punctuation\">]</span>:25: Connection timed out<span class=\"token punctuation\">)</span>\n                                     frangodh97@gmail.com\n<span class=\"token comment\">#</span>\n-- <span class=\"token number\">1</span> Kbytes <span class=\"token keyword\">in</span> <span class=\"token number\">2</span> Requests.</code></pre></div>\n</li>\n</ul>\n<p>Se deberian enviar esos mensajes de nuevo usuarios, al no estar conectados a la red con babuino no se pueden enviar.</p>","timeToRead":8,"excerpt":"Tarea 1: Instalación de un servidor LAMP Crea una instancia de vagrant basado en un box debian o ubuntu. Instala en esa máquina virtual toda…","frontmatter":{"title":"[IAW] - P1. Instalación local de un CMS PHP","cover":"https://img.icons8.com/ios/452/work.png","date":"2020-10-15T00:00:00.000Z","categories":["IAW"],"tags":["CMS","PHP","LAMP","Drupal"]},"fields":{"slug":"/iaw-p-1-instalacion-local-de-un-cms-php","date":"October 14, 2020"}}},"pageContext":{"slug":"/iaw-p-1-instalacion-local-de-un-cms-php","nexttitle":"Práctica 2: rclone - Gestionando nuestro almacenamiento en la nube (unidad 1)","nextslug":"/practica-2-rclone-gestionando-nuestro-almacenamiento-en-la-nube-unidad-1","prevtitle":"Práctica 1: Implantación y despliegue de una aplicación web estática","prevslug":"/practica-1-implantacion-y-despliegue-de-una-aplicacion-web-estatica"}}}