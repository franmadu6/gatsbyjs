{"componentChunkName":"component---src-templates-post-js","path":"/practica-2-cifrado-asimetrico-con-gpg-y-openssl","result":{"data":{"markdownRemark":{"html":"<h2 id=\"tarea-1-generación-de-claves\"><a href=\"#tarea-1-generaci%C3%B3n-de-claves\" aria-label=\"tarea 1 generación de claves permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 1: Generación de claves</h2>\n<ul>\n<li>Genera un par de claves (pública y privada). ¿En que directorio se guarda las claves de un usuario?</li>\n</ul>\n<p><strong>Generar par de claves</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~$ gpg --gen-key\ngpg <span class=\"token punctuation\">(</span>GnuPG<span class=\"token punctuation\">)</span> <span class=\"token number\">2.2</span>.12<span class=\"token punctuation\">;</span> Copyright <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2018</span> Free Software Foundation, Inc.\nThis is <span class=\"token function\">free</span> software: you are <span class=\"token function\">free</span> to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\n\nNota: Usa <span class=\"token string\">\"gpg --full-generate-key\"</span> para el diálogo completo de generación de clave.\n\nGnuPG debe construir un ID de usuario para identificar <span class=\"token function\">su</span> clave.\n\nNombre y apellidos: Francisco Javier Madueño Jurado\nDirección de correo electrónico: frandh1997@gmail.com\nEstá usando el juego de caracteres <span class=\"token string\">'utf-8'</span><span class=\"token builtin class-name\">.</span>\nHa seleccionado este ID de usuario:\n    <span class=\"token string\">\"Francisco Javier Madueño Jurado &lt;frandh1997@gmail.com>\"</span>\n\n¿Cambia <span class=\"token punctuation\">(</span>N<span class=\"token punctuation\">)</span>ombre, <span class=\"token punctuation\">(</span>D<span class=\"token punctuation\">)</span>irección o <span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span>ale/<span class=\"token punctuation\">(</span>S<span class=\"token punctuation\">)</span>alir? <span class=\"token function\">v</span>\nEs necesario generar muchos bytes aleatorios. Es una buena idea realizar\nalguna otra tarea <span class=\"token punctuation\">(</span>trabajar en otra ventana/consola, mover el ratón, usar\nla red y los discos<span class=\"token punctuation\">)</span> durante la generación de números primos. Esto da al\ngenerador de números aleatorios mayor oportunidad de recoger suficiente\nentropía.\nEs necesario generar muchos bytes aleatorios. Es una buena idea realizar\nalguna otra tarea <span class=\"token punctuation\">(</span>trabajar en otra ventana/consola, mover el ratón, usar\nla red y los discos<span class=\"token punctuation\">)</span> durante la generación de números primos. Esto da al\ngenerador de números aleatorios mayor oportunidad de recoger suficiente\nentropía.\ngpg: clave 57112B319F2A6170 marcada como de confianza absoluta\ngpg: creado el directorio <span class=\"token string\">'/home/fran/.gnupg/openpgp-revocs.d'</span>\ngpg: certificado de revocación guardado como <span class=\"token string\">'/home/fran/.gnupg/openpgp-revocs.d/28ED3C3112ED8846BEDFFAF657112B319F2A6170.rev'</span>\nclaves pública y secreta creadas y firmadas.\n\npub   rsa3072 <span class=\"token number\">2020</span>-10-06 <span class=\"token punctuation\">[</span>SC<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>caduca: <span class=\"token number\">2022</span>-10-06<span class=\"token punctuation\">]</span>\n      28ED3C3112ED8846BEDFFAF657112B319F2A6170\nuid                      Francisco Javier Madueño Jurado <span class=\"token operator\">&lt;</span>frandh1997@gmail.com<span class=\"token operator\">></span>\nsub   rsa3072 <span class=\"token number\">2020</span>-10-06 <span class=\"token punctuation\">[</span>E<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>caduca: <span class=\"token number\">2022</span>-10-06<span class=\"token punctuation\">]</span></code></pre></div>\n<p>Como podemos ver en la salida nuestra clave se guarda en /home/fran/.gnupg/openpgp-revocs.d</p>\n<ul>\n<li>\n<p>Lista las claves públicas que tienes en tu almacén de claves. Explica los distintos datos que nos muestra. ¿Cómo deberías haber generado las claves para indicar, por ejemplo, que tenga un 1 mes de validez?</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~/Cifrado$ gpg --list-key\n/home/fran/.gnupg/pubring.kbx\n-----------------------------\npub   rsa3072 <span class=\"token number\">2020</span>-10-06 <span class=\"token punctuation\">[</span>SC<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>caduca: <span class=\"token number\">2022</span>-10-06<span class=\"token punctuation\">]</span>\n  28ED3C3112ED8846BEDFFAF657112B319F2A6170\nuid        <span class=\"token punctuation\">[</span>  absoluta <span class=\"token punctuation\">]</span> Francisco Javier Madueño Jurado <span class=\"token operator\">&lt;</span>frandh1997@gmail.com<span class=\"token operator\">></span>\nsub   rsa3072 <span class=\"token number\">2020</span>-10-06 <span class=\"token punctuation\">[</span>E<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>caduca: <span class=\"token number\">2022</span>-10-06<span class=\"token punctuation\">]</span></code></pre></div>\n</li>\n</ul>\n<p>pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]\n9233303D1F5495739A6D2CB4636AE9EBCB7E3294\nuid        [desconocida] Manuel Lora Román <a href=\"mailto:manuelloraroman@gmail.com\">manuelloraroman@gmail.com</a>\nsub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]</p>\n<p>pub   rsa3072 2020-10-08 [SC] [caduca: 2020-11-07]\n443D661D9AAF3ABAEDCA93E1C3B291882C4EE5DF\nuid        [desconocida] Alejandro Gutierrez Valencia <a href=\"mailto:tojandro@gmail.com\">tojandro@gmail.com</a>\nsub   rsa3072 2020-10-08 [E] [caduca: 2020-11-07]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Nos muestra el nombre de la persona, su correo, cuando se genero la clave, cuando caduca y el código de la clave.  \n\n* Lista las claves privadas de tu almacén de claves\n```shell\nfran@debian:~/Cifrado$ gpg --list-secret-keys\n/home/fran/.gnupg/pubring.kbx\n-----------------------------\nsec   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]\n      28ED3C3112ED8846BEDFFAF657112B319F2A6170\nuid        [  absoluta ] Francisco Javier Madueño Jurado &lt;frandh1997@gmail.com&gt;\nssb   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]</code></pre></div>\n<h2 id=\"tarea-2-importar--exportar-clave-pública-1-punto\"><a href=\"#tarea-2-importar--exportar-clave-p%C3%BAblica-1-punto\" aria-label=\"tarea 2 importar  exportar clave pública 1 punto permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 2: Importar / exportar clave pública (1 punto)</h2>\n<ul>\n<li>\n<p>Exporta tu clave pública en formato ASCII y guardalo en un archivo nombre_apellido.asc y envíalo al compañero con el que vas a hacer esta práctica.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~/Cifrado$ gpg --export -a fran <span class=\"token operator\">></span> fran_madueño.asc</code></pre></div>\n</li>\n<li>\n<p>Importa las claves públicas recibidas de vuestro compañero.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~/Cifrado$ gpg --import alejandro_gutierrez.asc </code></pre></div>\n</li>\n<li>\n<p>Comprueba que las claves se han incluido correctamente en vuestro keyring.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~/Cifrado$ gpg --list-key\n/home/fran/.gnupg/pubring.kbx\n-----------------------------\npub   rsa3072 <span class=\"token number\">2020</span>-10-06 <span class=\"token punctuation\">[</span>SC<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>caduca: <span class=\"token number\">2022</span>-10-06<span class=\"token punctuation\">]</span>\n  28ED3C3112ED8846BEDFFAF657112B319F2A6170\nuid        <span class=\"token punctuation\">[</span>  absoluta <span class=\"token punctuation\">]</span> Francisco Javier Madueño Jurado <span class=\"token operator\">&lt;</span>frandh1997@gmail.com<span class=\"token operator\">></span>\nsub   rsa3072 <span class=\"token number\">2020</span>-10-06 <span class=\"token punctuation\">[</span>E<span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>caduca: <span class=\"token number\">2022</span>-10-06<span class=\"token punctuation\">]</span></code></pre></div>\n</li>\n</ul>\n<p>pub   rsa3072 2020-10-06 [SC] [caduca: 2022-10-06]\n9233303D1F5495739A6D2CB4636AE9EBCB7E3294\nuid        [desconocida] Manuel Lora Román <a href=\"mailto:manuelloraroman@gmail.com\">manuelloraroman@gmail.com</a>\nsub   rsa3072 2020-10-06 [E] [caduca: 2022-10-06]</p>\n<p>pub   rsa3072 2020-10-08 [SC] [caduca: 2020-11-07]\n443D661D9AAF3ABAEDCA93E1C3B291882C4EE5DF\nuid        [desconocida] Alejandro Gutierrez Valencia <a href=\"mailto:tojandro@gmail.com\">tojandro@gmail.com</a>\nsub   rsa3072 2020-10-08 [E] [caduca: 2020-11-07]</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## Tarea 3: Cifrado asimétrico con claves públicas (3 puntos)\n\n* Cifraremos un archivo cualquiera y lo remitiremos por email a uno de nuestros compañeros que nos proporcionó su clave pública.\n```shell\nfran@debian:~/Cifrado$ gpg -er 9233303D1F5495739A6D2CB4636AE9EBCB7E3294 kpasa </code></pre></div>\n<ul>\n<li>\n<p>Nuestro compañero, a su vez, nos remitirá un archivo cifrado para que nosotros lo descifremos.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@debian:/home/fran/Cifrado<span class=\"token comment\"># gpg -o pruebagpg -d pruebagpg.gpg</span>\nroot@debian:/home/fran/Cifrado<span class=\"token comment\"># cat pruebagpg</span>\nroot@debian:/home/fran/Cifrado<span class=\"token comment\"># se ve</span></code></pre></div>\n</li>\n<li>Tanto nosotros como nuestro compañero comprobaremos que hemos podido descifrar los mensajes recibidos respectivamente.</li>\n<li>Por último, enviaremos el documento cifrado a alguien que no estaba en la lista de destinatarios y comprobaremos que este usuario no podrá descifrar este archivo.<br>\nNo vera el archivo, puesto que no tiene añadida nuestra clave publica a su anillo de confianza.</li>\n<li>\n<p>Para terminar, indica los comandos necesarios para borrar las claves públicas y privadas que posees.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#borrar clave publica</span>\ngpg --delete-key <span class=\"token string\">\"Nombre de Usuario\"</span></code></pre></div>\n</li>\n</ul>\n<h1 id=\"borrar-clave-privada\"><a href=\"#borrar-clave-privada\" aria-label=\"borrar clave privada permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>borrar clave privada</h1>\n<p>gpg --delete-secret-key \"Nombre de Usuario\"</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## Tarea 4: Exportar clave a un servidor público de claves PGP (2 puntos)\n\n* Genera la clave de revocación de tu clave pública para utilizarla en caso de que haya problemas.\n```shell\n#el codigo para generar una clave de revocacion es:\ngpg -a --output cert-revocacion.txt --gen-revoke XXXXXXXX\n# la opción -a es opcional, para generar el certificado en ascii, para poder guardarlo en un gestor de contraseñas, por ejemplo\n#XXXXXXXX puede ser el identificador de clave pública o el de la clave privada, ambos identifican el par de claves que se revocaría el certificado.\n\n#en mi caso se generaron desde un principio si miramos al principio de la configuracion\ngpg: clave 57112B319F2A6170 marcada como de confianza absoluta\ngpg: creado el directorio &#39;/home/fran/.gnupg/openpgp-revocs.d&#39;\ngpg: certificado de revocación guardado como &#39;/home/fran/.gnupg/openpgp-revocs.d/28ED3C3112ED8846BEDFFAF657112B319F2A6170.rev&#39;</code></pre></div>\n<ul>\n<li>\n<p>Exporta tu clave pública al servidor pgp.rediris.es</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#Exportar claves a usuarios en formato binario</span>\ngpg --output clave-publica.gpg --export CB7E3294\n<span class=\"token comment\">#Exportarla al servidor de claves</span>\ngpg --send-keys --keyserver pgp.rediris.es CB7E3294\n<span class=\"token comment\">#Recivir una clave del servidor de claves</span>\ngpg  --keyserver pgp.rediris.es --recv CB7E3294</code></pre></div>\n</li>\n<li>\n<p>Borra la clave pública de alguno de tus compañeros de clase e impórtala ahora del servidor público de rediris.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~$ gpg --delete-key <span class=\"token string\">\"tojandro@gmail.com\"</span>\ngpg <span class=\"token punctuation\">(</span>GnuPG<span class=\"token punctuation\">)</span> <span class=\"token number\">2.2</span>.12<span class=\"token punctuation\">;</span> Copyright <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2018</span> Free Software Foundation, Inc.\nThis is <span class=\"token function\">free</span> software: you are <span class=\"token function\">free</span> to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.</code></pre></div>\n</li>\n</ul>\n<p>pub  rsa3072/C3B291882C4EE5DF 2020-10-08 Alejandro Gutierrez Valencia <a href=\"mailto:tojandro@gmail.com\">tojandro@gmail.com</a></p>\n<p>¿Eliminar esta clave del anillo? (s/N) s</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## Tarea 5: Cifrado asimétrico con openssl (3 puntos)\n\n* Genera un par de claves (pública y privada).\n```shell\nfran@debian:~/Cifrado$ sudo openssl genrsa -out claveOpenSSL.pem 2048</code></pre></div>\n<ul>\n<li>\n<p>Envía tu clave pública a un compañero.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">fran@debian:~/Cifrado$ openssl rsa -in claveOpenSSL.pem -pubout -out ClaveOpenSSL.public.pem</code></pre></div>\n</li>\n<li>\n<p>Utilizando la clave pública cifra un fichero de texto y envíalo a tu compañero.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#cifrado con la clave publica que mi compañero me ha pasado.</span>\nopenssl rsautl -pubin -encrypt -in test1.txt -out test1.txt.enc -inkey key.publicLoraOpenSSL.pem </code></pre></div>\n</li>\n<li>\n<p>Tu compañero te ha mandado un fichero cifrado, muestra el proceso para el descifrado.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@debian:/home/fran/Cifrado<span class=\"token comment\"># openssl rsautl -decrypt -inkey claveOpenSSL.pem -in test2.txt.enc -out test2.txt</span>\nroot@debian:/home/fran/Cifrado<span class=\"token comment\"># cat test2.txt</span>\nsi ves esto esta bien.</code></pre></div>\n</li>\n</ul>","timeToRead":7,"excerpt":"Tarea 1: Generación de claves Genera un par de claves (pública y privada). ¿En que directorio se guarda las claves de un usuario? Generar…","frontmatter":{"title":"Práctica 2: Cifrado asimétrico con gpg y openssl","cover":"https://img.icons8.com/ios/452/work.png","date":"2020-10-20T00:00:00.000Z","categories":["Seguridad"],"tags":["GPG","OpenSSL"]},"fields":{"slug":"/practica-2-cifrado-asimetrico-con-gpg-y-openssl","date":"October 19, 2020"}}},"pageContext":{"slug":"/practica-2-cifrado-asimetrico-con-gpg-y-openssl","nexttitle":"Práctica 1: Implantación y despliegue de una aplicación web estática","nextslug":"/practica-1-implantacion-y-despliegue-de-una-aplicacion-web-estatica","prevtitle":"Ejercicio 3: VirtualHosting con Apache","prevslug":"/ejercicio-3-virtual-hosting-con-apache"}}}