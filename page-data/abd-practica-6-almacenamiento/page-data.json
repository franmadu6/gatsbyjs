{"componentChunkName":"component---src-templates-post-js","path":"/abd-practica-6-almacenamiento","result":{"data":{"markdownRemark":{"html":"<center><img alt=\"Almacenamiento base de datos\" src=\"https://www.ionos.es/digitalguide/fileadmin/DigitalGuide/Teaser/database-t.jpg\"></center>\n<h2 id=\"oracle\"><a href=\"#oracle\" aria-label=\"oracle permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ORACLE:</h2>\n<ol>\n<li>Muestra los objetos a los que pertenecen las extensiones del tablespace TS2 (creado por tí) y el tamaño de cada una de ellas. Tendrás que crear objetos en él previamente, claro.</li>\n</ol>\n<p>Creamos un tablespace llamado TS2.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> CREATE TABLESPACE TS2\n  <span class=\"token number\">2</span>  DATAFILE <span class=\"token string\">'/home/oracle/ts2.dbf'</span> \n  <span class=\"token number\">3</span>  SIZE 200K\n  <span class=\"token number\">4</span>  AUTOEXTEND ON\n  <span class=\"token number\">5</span>  DEFAULT STORAGE <span class=\"token punctuation\">(</span>\n  <span class=\"token number\">6</span>  INITIAL 200K\n  <span class=\"token number\">7</span>  NEXT 200K\n  <span class=\"token number\">8</span>  MAXEXTENTS <span class=\"token number\">3</span>\n  <span class=\"token number\">9</span>  PCTINCREASE <span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nTablespace created.</code></pre></div>\n<p>Como podemos comprobar ya tenemos nuestro tablespace creado y podemos comprobar su ubicación.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> file_name,tablespace_name from dba_data_files where <span class=\"token assign-left variable\">tablespace_name</span><span class=\"token operator\">=</span><span class=\"token string\">'TS2'</span><span class=\"token punctuation\">;</span>\n\nFILE_NAME\n--------------------------------------------------------------------------------\nTABLESPACE_NAME\n------------------------------\n/home/oracle/ts2.dbf\nTS2</code></pre></div>\n<p>Crearemos una paqueña prueba para ver el funcionamiento de su espacio.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> CREATE TABLE pruebats2 <span class=\"token punctuation\">(</span>           \n  <span class=\"token number\">2</span>  MT_CLAVE           NUMBER<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>    NOT NULL,\n  <span class=\"token number\">3</span>  MT_DESCRIPCION     VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span> NULL\n  <span class=\"token number\">4</span>  <span class=\"token punctuation\">)</span>  TABLESPACE TS2<span class=\"token punctuation\">;</span>             \n\nTable created.</code></pre></div>\n<p>Le añadiremos un poco de contenido.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">insert into pruebats2 <span class=\"token punctuation\">(</span>MT_CLAVE,MT_DESCRIPCION<span class=\"token punctuation\">)</span> values <span class=\"token punctuation\">(</span><span class=\"token string\">'132'</span>,<span class=\"token string\">'clave prueba1'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into pruebats2 <span class=\"token punctuation\">(</span>MT_CLAVE,MT_DESCRIPCION<span class=\"token punctuation\">)</span> values <span class=\"token punctuation\">(</span><span class=\"token string\">'653'</span>,<span class=\"token string\">'clave prueba2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into pruebats2 <span class=\"token punctuation\">(</span>MT_CLAVE,MT_DESCRIPCION<span class=\"token punctuation\">)</span> values <span class=\"token punctuation\">(</span><span class=\"token string\">'178'</span>,<span class=\"token string\">'clave prueba3'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Comprobaremos el espacio libre ocupa nuestro tablespace en este momento.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SELECT TABLESPACE_NAME,TO_CHAR<span class=\"token punctuation\">(</span>SUM<span class=\"token punctuation\">(</span>NVL<span class=\"token punctuation\">(</span>BYTES,0<span class=\"token punctuation\">))</span>/1024/1024, <span class=\"token string\">'99,999,990.99'</span><span class=\"token punctuation\">)</span> AS <span class=\"token string\">\"FREE SPACE(IN MB)\"</span>\n  <span class=\"token number\">2</span>  FROM USER_FREE_SPACE \n  <span class=\"token number\">3</span>  GROUP BY TABLESPACE_NAME<span class=\"token punctuation\">;</span>\n\nTABLESPACE_NAME \t       FREE SPACE<span class=\"token punctuation\">(</span>IN\n------------------------------ --------------\nSYSAUX\t\t\t\t\t<span class=\"token number\">28.25</span>\nUNDOTBS1\t\t\t\t<span class=\"token number\">29.31</span>\nTS2\t\t\t\t\t <span class=\"token number\">1.06</span>\nUSERS\t\t\t\t\t <span class=\"token number\">3.94</span>\nSYSTEM\t\t\t\t\t <span class=\"token number\">8.81</span></code></pre></div>\n<ol start=\"2\">\n<li>Borra la tabla que está llenando TS2 consiguiendo que vuelvan a existir extensiones libres. Añade después otro fichero de datos a TS2.</li>\n</ol>\n<p>Borramos la tabla anteriormente creada y verificamos el espacio de almacenamiento de nuestro tablespace.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> drop table pruebats2<span class=\"token punctuation\">;</span>\n\nTable dropped.\n\nSQL<span class=\"token operator\">></span> SELECT TABLESPACE_NAME,TO_CHAR<span class=\"token punctuation\">(</span>SUM<span class=\"token punctuation\">(</span>NVL<span class=\"token punctuation\">(</span>BYTES,0<span class=\"token punctuation\">))</span>/1024/1024, <span class=\"token string\">'99,999,990.99'</span><span class=\"token punctuation\">)</span> AS <span class=\"token string\">\"FREE SPACE(IN MB)\"</span>\n  <span class=\"token number\">2</span>  FROM USER_FREE_SPACE\n  <span class=\"token number\">3</span>  GROUP BY TABLESPACE_NAME<span class=\"token punctuation\">;</span>\n\nTABLESPACE_NAME \t       FREE SPACE<span class=\"token punctuation\">(</span>IN\n------------------------------ --------------\nSYSAUX\t\t\t\t\t<span class=\"token number\">28.25</span>\nUNDOTBS1\t\t\t\t<span class=\"token number\">29.31</span>\nTS2\t\t\t\t\t <span class=\"token number\">1.13</span>\nUSERS\t\t\t\t\t <span class=\"token number\">3.94</span>\nSYSTEM\t\t\t\t\t <span class=\"token number\">8.81</span></code></pre></div>\n<p>Para empezar visualizaremos los ficheros que estamos usando:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> substr<span class=\"token punctuation\">(</span>name, <span class=\"token number\">1</span>, <span class=\"token number\">255</span><span class=\"token punctuation\">)</span>\nfrom <span class=\"token function\">v</span><span class=\"token variable\">$datafile</span><span class=\"token punctuation\">;</span>\n\nSUBSTR<span class=\"token punctuation\">(</span>NAME,1,255<span class=\"token punctuation\">)</span>\n--------------------------------------------------------------------------------\n/opt/oracle/oradata/ORCL/system01.dbf\n/opt/oracle/oradata/ORCL/sysaux01.dbf\n/opt/oracle/oradata/ORCL/undotbs01.dbf\n/home/oracle/ts2.dbf\n/opt/oracle/oradata/ORCL/users01.dbf</code></pre></div>\n<p>Añadiremos un nuevo fichero y comprobamos que se ha añadido a nuestro tablespace.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> alter tablespace TS2 <span class=\"token function\">add</span> datafile <span class=\"token string\">'/home/oracle/prueba.dbf'</span> size 10M<span class=\"token punctuation\">;</span>\n\nTablespace altered.\n\nSQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> file_name,tablespace_name\n  <span class=\"token number\">2</span>  from dba_data_files\n  <span class=\"token number\">3</span>  where <span class=\"token assign-left variable\">tablespace_name</span><span class=\"token operator\">=</span><span class=\"token string\">'TS2'</span><span class=\"token punctuation\">;</span>\n\nFILE_NAME\n--------------------------------------------------------------------------------\nTABLESPACE_NAME\n------------------------------\n/home/oracle/ts2.dbf\nTS2\n\n/home/oracle/prueba.dbf\nTS2</code></pre></div>\n<ol start=\"3\">\n<li>Crea el tablespace TS3 gestionado localmente con un tamaño de extension uniforme de 128K y un fichero de datos asociado. Cambia la ubicación del fichero de datos y modifica la base de datos para que pueda acceder al mismo. Crea en TS3 dos tablas e inserta registros en las mismas. Comprueba que segmentos tiene TS3, qué extensiones tiene cada uno de ellos y en qué ficheros se encuentran.</li>\n</ol>\n<p>Crearemos el nuevo tablespace TS3, que tendra un fichero añadido y una extension uniforme de 128K.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> CREATE TABLESPACE TS3 DATAFILE <span class=\"token string\">'/home/oracle/ts3.dbf'</span> SIZE 50M EXTENT MANAGEMENT LOCAL UNIFORM SIZE 128K<span class=\"token punctuation\">;</span>\n\nTablespace created.\n\nSQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> file_name,tablespace_name\n  <span class=\"token number\">2</span>  from dba_data_files\n  <span class=\"token number\">3</span>  where <span class=\"token assign-left variable\">tablespace_name</span><span class=\"token operator\">=</span><span class=\"token string\">'TS3'</span><span class=\"token punctuation\">;</span>\n\nFILE_NAME\n--------------------------------------------------------------------------------\nTABLESPACE_NAME\n------------------------------\n/home/oracle/ts3.dbf\nTS3</code></pre></div>\n<p>Para modificar los archivos dentro de un tablespace indicado, primero deberemos apagarlo.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> ALTER TABLESPACE TS3 OFFLINE <span class=\"token punctuation\">;</span>\n\nTablespace altered.</code></pre></div>\n<p>Ahora procederemos a las modificacion de la ubicación del fichero.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>oracle@oracle1 ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">ls</span>\nactividad3  drop.sql  prueba.dbf  setPassword.sh  ts2.dbf  ts3.dbf\n<span class=\"token punctuation\">[</span>oracle@oracle1 ~<span class=\"token punctuation\">]</span>$ <span class=\"token function\">mv</span> ts3.dbf actividad3/\n\nSQL<span class=\"token operator\">></span> alter tablespace TS3 <span class=\"token function\">rename</span> datafile <span class=\"token string\">'/home/oracle/ts3.dbf'</span> to <span class=\"token string\">'/home/oracle/actividad3/ts3.dbf'</span><span class=\"token punctuation\">;</span>\n\nTablespace altered.</code></pre></div>\n<p>Activamos el tablespace y comprobamos la nueva configuración.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> ALTER TABLESPACE TS3 ONLINE<span class=\"token punctuation\">;</span>\n\nTablespace altered.\n\nSQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> file_name,tablespace_name\n  <span class=\"token number\">2</span>  from dba_data_files\n  <span class=\"token number\">3</span>  where <span class=\"token assign-left variable\">tablespace_name</span><span class=\"token operator\">=</span><span class=\"token string\">'TS3'</span><span class=\"token punctuation\">;</span>\n\nFILE_NAME\n--------------------------------------------------------------------------------\nTABLESPACE_NAME\n------------------------------\n/home/oracle/actividad3/ts3.dbf\nTS3</code></pre></div>\n<p>Creamos nuevas tablas y registros en TS3:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">create table coches<span class=\"token punctuation\">(</span>\n  codigo varchar<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>,\n  marca varchar<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>,\n  modelo varchar<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> tablespace TS3<span class=\"token punctuation\">;</span>\n\ninsert into coches values <span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span>,<span class=\"token string\">'Ferrari'</span>,<span class=\"token string\">'Testarrosa'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into coches values <span class=\"token punctuation\">(</span><span class=\"token string\">'02'</span>,<span class=\"token string\">'Seat'</span>,<span class=\"token string\">'Panda'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into coches values <span class=\"token punctuation\">(</span><span class=\"token string\">'03'</span>,<span class=\"token string\">'Opel'</span>,<span class=\"token string\">'Corsa'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into coches values <span class=\"token punctuation\">(</span><span class=\"token string\">'04'</span>,<span class=\"token string\">'Seat'</span>,<span class=\"token string\">'Ateca'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into coches values <span class=\"token punctuation\">(</span><span class=\"token string\">'05'</span>,<span class=\"token string\">'Renault'</span>,<span class=\"token string\">'Clio'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\ncreate table cicuitos<span class=\"token punctuation\">(</span>\n  codigo varchar<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>,\n  nombre varchar<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>,\n  pais varchar<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span> tablespace TS3<span class=\"token punctuation\">;</span>\n\ninsert into cicuitos values <span class=\"token punctuation\">(</span><span class=\"token string\">'01'</span>,<span class=\"token string\">'Silverstone'</span>,<span class=\"token string\">'Reino Unido'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into cicuitos values <span class=\"token punctuation\">(</span><span class=\"token string\">'02'</span>,<span class=\"token string\">'Mónaco'</span>,<span class=\"token string\">'Mónaco'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into cicuitos values <span class=\"token punctuation\">(</span><span class=\"token string\">'03'</span>,<span class=\"token string\">'Interlagos'</span>,<span class=\"token string\">'Brasil'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into cicuitos values <span class=\"token punctuation\">(</span><span class=\"token string\">'04'</span>,<span class=\"token string\">'Nürburgring'</span>,<span class=\"token string\">'Alemania'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninsert into cicuitos values <span class=\"token punctuation\">(</span><span class=\"token string\">'05'</span>,<span class=\"token string\">'Monza'</span>,<span class=\"token string\">'Italia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Comprobamos:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> de.segment_name,de.extent_id,df.file_name,de.file_id\n  <span class=\"token number\">2</span>  from dba_data_files  df, dba_extents de\n  <span class=\"token number\">3</span>  where de.file_id <span class=\"token operator\">=</span> df.file_id\n  <span class=\"token number\">4</span>  and de.tablespace_name <span class=\"token operator\">=</span> <span class=\"token string\">'TS3'</span><span class=\"token punctuation\">;</span>      \n\nSEGMENT_NAME\n--------------------------------------------------------------------------------\n EXTENT_ID\n----------\nFILE_NAME\n--------------------------------------------------------------------------------\n   FILE_ID\n----------\nCOCHES\n\t <span class=\"token number\">0</span>\n/home/oracle/actividad3/ts3.dbf\n\t <span class=\"token number\">8</span>\n\n\nSEGMENT_NAME\n--------------------------------------------------------------------------------\n EXTENT_ID\n----------\nFILE_NAME\n--------------------------------------------------------------------------------\n   FILE_ID\n----------\nCICUITOS\n\t <span class=\"token number\">0</span>\n/home/oracle/actividad3/ts3.dbf\n\t <span class=\"token number\">8</span></code></pre></div>\n<ol start=\"4\">\n<li>Redimensiona los ficheros asociados a los tres tablespaces que has creado de forma que ocupen el mínimo espacio posible para alojar sus objetos.</li>\n</ol>\n<p>Comprobamos el espacio de almacenamiento de nuestros tablespaces:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> sum<span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span>/1024<span class=\"token operator\">||</span><span class=\"token string\">'KB'</span>, tablespace_name\n  <span class=\"token number\">2</span>  from dba_segments\n  <span class=\"token number\">3</span>  where tablespace_name like <span class=\"token string\">'TS%'</span>\n  <span class=\"token number\">4</span>  group by tablespace_name<span class=\"token punctuation\">;</span>\n\nSUM<span class=\"token punctuation\">(</span>BYTES<span class=\"token punctuation\">)</span>/1024<span class=\"token operator\">||</span><span class=\"token string\">'KB'</span>\t\t\t   TABLESPACE_NAME\n------------------------------------------ ------------------------------\n384KB\t\t\t\t\t   TS2\n256KB\t\t\t\t\t   TS3</code></pre></div>\n<p>Redimensionaremos los ficheros y comprobaremos el espacio que ocupan.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> alter database datafile <span class=\"token string\">'/home/oracle/ts2.dbf'</span> resize 1M<span class=\"token punctuation\">;</span>\n\nDatabase altered.\n\nSQL<span class=\"token operator\">></span> alter database datafile <span class=\"token string\">'/home/oracle/actividad3/ts3.dbf'</span> resize 20M<span class=\"token punctuation\">;</span>     \n\nDatabase altered.\n\nSQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> sum<span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span>/1024<span class=\"token operator\">||</span><span class=\"token string\">'KB'</span>, tablespace_name\n  <span class=\"token number\">2</span>  from dba_segments\n  <span class=\"token number\">3</span>  where tablespace_name like <span class=\"token string\">'TS%'</span>\n  <span class=\"token number\">4</span>  group by tablespace_name<span class=\"token punctuation\">;</span>\n\nSUM<span class=\"token punctuation\">(</span>BYTES<span class=\"token punctuation\">)</span>/1024<span class=\"token operator\">||</span><span class=\"token string\">'KB'</span>\t\t\t   TABLESPACE_NAME\n------------------------------------------ ------------------------------\n384KB\t\t\t\t\t   TS2\n256KB\t\t\t\t\t   TS3\n\nSQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> file_name,tablespace_name,<span class=\"token punctuation\">(</span>bytes/1024<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'KB'</span>\n  <span class=\"token number\">2</span>  from dba_data_files\n  <span class=\"token number\">3</span>  where tablespace_name like <span class=\"token string\">'TS%'</span><span class=\"token punctuation\">;</span>\n\nFILE_NAME\n--------------------------------------------------------------------------------\nTABLESPACE_NAME \t       <span class=\"token punctuation\">(</span>BYTES/1024<span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'KB'</span>\n------------------------------ ------------------------------------------\n/home/oracle/ts2.dbf\nTS2\t\t\t       1024KB\n\n/home/oracle/prueba.dbf\nTS2\t\t\t       10240KB\n\n/home/oracle/actividad3/ts3.dbf\nTS3\t\t\t       20480KB</code></pre></div>\n<ol start=\"5\">\n<li>Crea una secuencia para rellenar el campo deptno de la tabla dept de forma coherente con los datos ya existentes.  Inserta al menos dos registros haciendo uso de la secuencia.</li>\n</ol>\n<p>Creare una secuencia que incremente el codigo en 100 empezando desdel numero 5 y llegue hasta 500 y no se repita.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">create sequence secuenciaDeptno\n  start with <span class=\"token number\">50</span>\n  increment by <span class=\"token number\">100</span>\n  maxvalue <span class=\"token number\">500</span>\n  nocycle<span class=\"token punctuation\">;</span>\n\ninsert into scott.dept<span class=\"token operator\">&lt;</span>DEPTNO<span class=\"token operator\">></span> values <span class=\"token operator\">&lt;</span>secuenciaDeptno.nextval<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\ninsert into scott.dept<span class=\"token operator\">&lt;</span>DEPTNO<span class=\"token operator\">></span> values <span class=\"token operator\">&lt;</span>secuenciaDeptno.nextval<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\nSQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> from scott.dept<span class=\"token punctuation\">;</span>\n\nDEPTNO\n--------------------------------------------------\nDNAME\n--------------------------------------------------\nLOC\n--------------------------------------------------\n<span class=\"token number\">150</span>\n\n\n<span class=\"token number\">50</span>\n\n\n<span class=\"token number\">10</span>\nACCOUNTING\nNEW YORK\n\n<span class=\"token number\">20</span>\nRESEARCH\nDALLAS\n\n<span class=\"token number\">30</span>\nSALES\nCHICAGO</code></pre></div>\n<ol start=\"6\">\n<li>Resuelve el siguiente caso práctico en <strong>ORACLE</strong>:\n</li>\n</ol>\n<p>En nuestra empresa existen tres departamentos: Informática, Ventas y Producción. En Informática trabajan tres personas: Pepe, Juan y Clara. En Ventas trabajan Ana y Eva y en Producción Jaime y Lidia.</p>\n<p>a)\nPepe es el administrador de la base de datos.\nJuan y Clara son los programadores de la base de datos, que trabajan tanto en la aplicación que usa el departamento de Ventas como en la usada por el departamento de Producción.\nAna y Eva tienen permisos para insertar, modificar y borrar registros en las tablas de la aplicación de Ventas que tienes que crear, y se llaman Productos y Ventas, siendo propiedad de Ana.\nJaime y Lidia pueden leer la información de esas tablas pero no pueden modificar la información.\nCrea los usuarios y dale los roles y permisos que creas conveniente.  </p>\n<p>b)\nLos espacios de tablas son System, Producción (ficheros prod1.dbf y prod2.dbf) y Ventas (fichero vent.dbf).\nLos programadores del departamento de Informática pueden crear objetos en cualquier tablespace de la base de datos, excepto en System.\nLos demás usuarios solo podrán crear objetos en su tablespace correspondiente teniendo un límite de espacio de 30 M los del departamento de Ventas y 100K los del de Producción.\nPepe tiene cuota ilimitada en todos los espacios, aunque el suyo por defecto es System.</p>\n<p>c)\nPepe quiere crear una tabla Prueba que ocupe inicialmente 256K en el tablespace Ventas.</p>\n<p>d)\nPepe decide que los programadores tengan acceso a la tabla Prueba antes creada y puedan ceder ese derecho y el de conectarse a la base de datos a los usuarios que ellos quieran.</p>\n<p>e)\nLidia y Jaime dejan la empresa, borra los usuarios y el espacio de tablas correspondiente, detalla los pasos necesarios para que no quede rastro del espacio de tablas.</p>\n<h2 id=\"postgres\"><a href=\"#postgres\" aria-label=\"postgres permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Postgres:</h2>\n<ol start=\"7\">\n<li>Averigua si es posible establecer cuotas de uso sobre los tablespaces en Postgres.</li>\n</ol>\n<p>Postgres no posee la opción de administrar coutas, pero se puede asignar una cuota maxima de tamaño a un usuario en la partición dende se aloje el tablespace.</p>\n<p>Pasos a seguir:  </p>\n<p>Instalaremos el paquete <strong>quota</strong>, para crear e inspeccionar cuotas de disco, luego estableceremos una cuota para un usuario de ejemplo.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> <span class=\"token function\">quota</span></code></pre></div>\n<p>Nos dirigimos al fichero de fstab y lo modificamos:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">nano</span> /etc/fstab \n<span class=\"token assign-left variable\">UUID</span><span class=\"token operator\">=</span>188b6cad-67aa-44fb-8156-1623a3d00e61 /               ext4    <span class=\"token assign-left variable\">errors</span><span class=\"token operator\">=</span>remount-ro,usrquota,grpquota <span class=\"token number\">0</span>       <span class=\"token number\">1</span></code></pre></div>\n<p>Montamos una partición.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">mount</span> -o remount /</code></pre></div>\n<p>Podemos verificar que las nuevas opciones se usaron para montar el sistema de archivos mirando el /proc/mountsarchivo. Aquí, usamos grep para mostrar solo la entrada del sistema de archivos raíz en ese archivo:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">cat</span> /proc/mounts <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> <span class=\"token string\">' / '</span>\n/dev/sda3 / ext4 rw,relatime,quota,usrquota,grpquota,errors<span class=\"token operator\">=</span>remount-ro <span class=\"token number\">0</span> <span class=\"token number\">0</span></code></pre></div>\n<p>Habilitamos las cuotas.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">sudo</span> <span class=\"token function\">quotacheck</span> -ugm /</code></pre></div>\n<p>Activamos el sistema de cuotas:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">sudo</span> quotaon -v /\n/dev/sda3 <span class=\"token punctuation\">[</span>/<span class=\"token punctuation\">]</span>: group quotas turned on\n/dev/sda3 <span class=\"token punctuation\">[</span>/<span class=\"token punctuation\">]</span>: user quotas turned on</code></pre></div>\n<p>Ahora podremos modificar las cuotas de los usuarios.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">vagrant@postgres1:~$ <span class=\"token function\">sudo</span> edquota -u vagrant\n\n  GNU <span class=\"token function\">nano</span> <span class=\"token number\">3.2</span>                                      /tmp//EdP.alRTXmK                                                 \n\nDisk quotas <span class=\"token keyword\">for</span> user vagrant <span class=\"token punctuation\">(</span>uid <span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>:\n  Filesystem                   blocks       soft       hard     inodes     soft     hard\n  /dev/sda3                        <span class=\"token number\">52</span>          <span class=\"token number\">0</span>          <span class=\"token number\">0</span>         <span class=\"token number\">13</span>        <span class=\"token number\">0</span>        <span class=\"token number\">0</span></code></pre></div>\n<h2 id=\"mysql\"><a href=\"#mysql\" aria-label=\"mysql permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MySQL:</h2>\n<ol start=\"8\">\n<li>Averigua si existe el concepto de extensión en MySQL y si coincide con el existente en ORACLE.</li>\n</ol>\n<h3 id=\"segmentos-extensiones-y-bloques-e-mysql\"><a href=\"#segmentos-extensiones-y-bloques-e-mysql\" aria-label=\"segmentos extensiones y bloques e mysql permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Segmentos, Extensiones y Bloques e MySQL.</h3>\n<p>MySQL incorpora una característica única llamada «motores de almacenamiento», que nos permite seleccionar el tipo de almacenamiento interno de cada tabla</p>\n<p>Los motores MyISAM e InnoDB son los más empleados, en ellos podemos encontrar extensiones, segmentos y páginas.</p>\n<p>Ejemplo:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">File system              <span class=\"token operator\">&lt;</span>-<span class=\"token operator\">></span> InnoDB\n----------------------------------------------\ndisk partition           <span class=\"token operator\">&lt;</span>-<span class=\"token operator\">></span> tablespace\n<span class=\"token function\">file</span>                     <span class=\"token operator\">&lt;</span>-<span class=\"token operator\">></span> segment <span class=\"token comment\"># UN FICHERO ES UN SEGMENTO.</span>\ninode                    <span class=\"token operator\">&lt;</span>-<span class=\"token operator\">></span> fsp0fsp.c <span class=\"token string\">'inode'</span>\nfs space allocation unit <span class=\"token operator\">&lt;</span>-<span class=\"token operator\">></span> extent <span class=\"token comment\"># UN ESPACIO ES UNA EXTENSIÓN.</span>\ndisk block               <span class=\"token operator\">&lt;</span>-<span class=\"token operator\">></span> page <span class=\"token punctuation\">(</span><span class=\"token number\">16</span> kB<span class=\"token punctuation\">)</span><span class=\"token comment\"># UN BLOQUE ES UNA PÁGINA.</span></code></pre></div>\n<h3 id=\"segmentos-extensiones-y-bloques-en-oracle\"><a href=\"#segmentos-extensiones-y-bloques-en-oracle\" aria-label=\"segmentos extensiones y bloques en oracle permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Segmentos, Extensiones y Bloques en Oracle.</h3>\n<p>Los segmentos son los equivalentes físicos de los objetos que almacenan datos. El uso efectivo de los segmentos requiere que el DBA conozca los objetos que utiliza una aplicación, cómo los datos son introducidos en esos objetos y el modo en que serán recuperados.</p>\n<p>Como los segmentos son entidades físicas, deben estar asignados a espacios de tablas en la BD y estarán localizados en uno de los ficheros de datos del espacio de tablas. Un segmento está constituido por secciones llamadas extensiones, que son conjuntos contiguos de bloques Oracle. Una vez que una extensión existente en un segmento no puede almacenar más datos, el segmento obtendrá del espacio de tabla otra extensión. Este proceso de extensión continuará hasta que no quede más espacio disponible en los ficheros del espacio de tablas, o hasta que se alcance un número máximo de extensiónes por segmento.</p>\n<h2 id=\"mongodb\"><a href=\"#mongodb\" aria-label=\"mongodb permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>MongoDB:</h2>\n<ol start=\"9\">\n<li>Averigua si en MongoDB puede saberse el espacio disponible para almacenar nuevos documentos.</li>\n</ol>\n<p>Mongo posee una serie de funciones para mostrar diferentes datos de almacenamiento.</p>\n<p>Ejemplos:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\">#El tamaño de los datos en la colección.</span>\ndb.collection.dataSize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>: \n<span class=\"token comment\">#Ver tamaño de un índice.</span>\ndb.collection.index.stats<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>.indexSizes: \n<span class=\"token comment\">#El tamaño de los datos más el de los índices.</span>\ndb.collection.totalSize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:\n<span class=\"token comment\">#El tamaño de los índices.</span>\ndb.collection.totalIndexSize<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>:</code></pre></div>","timeToRead":9,"excerpt":"ORACLE: Muestra los objetos a los que pertenecen las extensiones del tablespace TS2 (creado por tí) y el tamaño de cada una de ellas.…","frontmatter":{"title":"[ABD] - Práctica 6 Almacenamiento","cover":"https://img.icons8.com/ios/452/work.png","date":"2021-03-05T00:00:00.000Z","categories":["ABD"],"tags":["Almacenamiento"]},"fields":{"slug":"/abd-practica-6-almacenamiento","date":"March 04, 2021"}}},"pageContext":{"slug":"/abd-practica-6-almacenamiento","nexttitle":"[SERVICIOS] - Práctica: Proxy, proxy inverso y balanceadores de carga","nextslug":"/servicios-practica-proxy-proxy-inverso-y-balanceadores-de-carga","prevtitle":"Práctica 3: Integridad de ficheros (Unidad 1)","prevslug":"/practica-3-integridad-de-ficheros-unidad-1"}}}