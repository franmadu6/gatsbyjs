{"componentChunkName":"component---src-templates-post-js","path":"/practica-3-integridad-de-ficheros","result":{"data":{"markdownRemark":{"html":"<h1 id=\"práctica-3-integridad-de-ficheros\"><a href=\"#pr%C3%A1ctica-3-integridad-de-ficheros\" aria-label=\"práctica 3 integridad de ficheros permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Práctica 3: Integridad de ficheros</h1>\n<p>En caso de que algún tipo de malware reemplace o falsifique archivos del sistema operativo, ocultándose para realizar tareas no autorizadas, la búsqueda y detección del mismo se complica ya que los análisis antimalware y de los procesos sospechosos por parte de administradores de sistemas, no dudarán de la veracidad de dichos archivos y procesos. A este tipo de malware se le denomina rootkit, programa que sustituye los ejecutables binarios del sistema para ocultarse mejor, pudiendo servir de puertas trasera o backdoor para la ejecución malware remota.</p>\n<h2 id=\"tarea-1-crea-un-manual-lo-más-completo-posible-de-las-herramientas-sfc-y-dsim-para-comprobar-la-integridad-de-ficheros-en-windows-indica-para-qué-sirven-las-opciones-más-usadas-del-programa-y-entrega-capturas-de-pantallas-para-comprobar-que-has-realizado-la-práctica\"><a href=\"#tarea-1-crea-un-manual-lo-m%C3%A1s-completo-posible-de-las-herramientas-sfc-y-dsim-para-comprobar-la-integridad-de-ficheros-en-windows-indica-para-qu%C3%A9-sirven-las-opciones-m%C3%A1s-usadas-del-programa-y-entrega-capturas-de-pantallas-para-comprobar-que-has-realizado-la-pr%C3%A1ctica\" aria-label=\"tarea 1 crea un manual lo más completo posible de las herramientas sfc y dsim para comprobar la integridad de ficheros en windows indica para qué sirven las opciones más usadas del programa y entrega capturas de pantallas para comprobar que has realizado la práctica permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 1: Crea un manual lo más completo posible de las herramientas sfc y dsim para comprobar la integridad de ficheros en Windows. Indica para qué sirven las opciones más usadas del programa y entrega capturas de pantallas para comprobar que has realizado la práctica.</h2>\n<p><strong>SFC</strong>:(System File Checker) Comprobador de archivos de sistema para reparar los archivos de sistema que faltan o están dañados.</p>\n<p>En el símbolo del sistema, escriba el comando siguiente y presione ENTRAR:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">sfc /scannow</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/06a52acc303283e310f79cf1879bd09b/6b5c3/sfc.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.348993288590606%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAAr0lEQVQoz9WSuw7CMAxF3YdUmoedVl34jC5FavsnDAx8AojfvyRpM1RISEAXhqObLMd2YtLGoFYKh7pGVVWRLMtARB/T9z1InAMzw1gD5cUsAqU19IqxNt5DwVAoz/MXiqKIwnmeQU3bIknDOZAEoduQZVm+7SxNNI5jSMKvbITfvtd/Cqdp2ld4GoZ9PiVxvlxB7PfM+h1McMQu8JLCW5z4FVtpnaBrBMeuwe3+wBNG8dYCgrvpugAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"Imagen de la practica\"\n        src=\"/gatsbyjs/static/06a52acc303283e310f79cf1879bd09b/36727/sfc.png\"\n        srcset=\"/gatsbyjs/static/06a52acc303283e310f79cf1879bd09b/acf4b/sfc.png 173w,\n/gatsbyjs/static/06a52acc303283e310f79cf1879bd09b/fc834/sfc.png 345w,\n/gatsbyjs/static/06a52acc303283e310f79cf1879bd09b/36727/sfc.png 690w,\n/gatsbyjs/static/06a52acc303283e310f79cf1879bd09b/6b5c3/sfc.png 745w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>El comando sfc /scannow examinará todos los archivos de sistema protegidos y remplaza los archivos dañados con una copia en caché ubicada en una carpeta comprimida en %WinDir%\\System32\\dllcache.\nEl marcador de posición %WinDir% representa la carpeta del sistema operativo Windows. Por ejemplo, C:\\Windows.</p>\n<p><strong>Nota:</strong> No cierre la ventana del símbolo del sistema hasta que la verificación haya terminado por completo. Una vez finalizado el proceso, aparecerán los resultados del examen.</p>\n<p>Cuando el proceso termine, puede recibir alguno de los siguientes mensajes:</p>\n<ul>\n<li>Protección de recursos de Windows no encontró ninguna infracción de integridad.<br>\nEsto quiere decir que no hay ningún archivo de sistema que esté dañado o que falte.</li>\n<li>Protección de recursos de Windows no pudo realizar la operación solicitada.<br>\nPara resolver este problema, vuelva a ejecutar el examen de Comprobador de archivos de sistema en modo seguro y compruebe que las carpetas PendingDeletes y PendingRenames existen dentro de %WinDir%\\WinSxS\\Temp.</li>\n<li>Protección de recursos de Windows encontró archivos dañados y los reparó correctamente. Los detalles están incluidos en CBS.Log %WinDir%\\Logs\\CBS\\CBS.log.  </li>\n<li>Para obtener información detallada sobre el análisis de archivos de sistema y su restauración, diríjase a Cómo ver los detalles del proceso de Comprobador de archivos de sistema.  </li>\n<li>Protección de recursos de Windows encontró archivos dañados pero no pudo corregir algunos de ellos. Los detalles están incluidos en CBS.Log %WinDir%\\Logs\\CBS\\CBS.log.  </li>\n</ul>\n<p><strong>Cómo ver los detalles del proceso del Comprobador de archivos de sistema</strong><br>\nPara ver los detalles incluidos en el archivo CBS.Log, puede copiar la información al archivo Sfcdetails.txt usando el comando Findstr y luego ver los detalles en el archivo Sfcdetails.txt.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">findstr /c:<span class=\"token string\">\"[SR]\"</span> %windir%<span class=\"token punctuation\">\\</span>Logs<span class=\"token punctuation\">\\</span>CBS<span class=\"token punctuation\">\\</span>CBS.log <span class=\"token operator\">></span><span class=\"token string\">\"%userprofile%\\Desktop\\sfcdetails.txt\"</span></code></pre></div>\n<p><em>DSIM:</em>(Deployment Image Servicing and Management) Mantenimiento y preparación de las imágenes de Windows.</p>\n<p>DISM permite realizar el mantenimiento y preparación de las imágenes de Windows. Es decir, DISM lo podemos usar para realizar el mantenimiento de una imagen de Windows o un disco duro virtual.</p>\n<p>Los comandos de DISM permiten capturar y aplicar imágenes de Windows, añadir o elimnar imágenes de un archivo .wim o incluso dividir archvios .win en otros archivos más pequeños. Para realizar un análisis a una imagen de Windows 10 con el objetivo de detectar errores o archivos corruptos podemos ejecutar el comando Dism /Online /Cleanup-Image /ScanHealth, aunque podemos ver el resto de opciones y parámetros si ejecutamos DISM /? desde la línea de comandos:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">DISM /Online /Cleanup-Image /CheckHealth\n<span class=\"token comment\">#comprueba el estado del sistema y mira si se han detectado fallos</span>\nDISM /Online /Cleanup-Image /ScanHealth\n<span class=\"token comment\">#escanea el sistema buscando errores. Realiza él la búsqueda asi que tarda algo más que CheckHealth</span>\nDISM /Online /Cleanup-Image /RestoreHealth\n<span class=\"token comment\">#comprobará nuestro sistema e intentará repararlo, tardará un poco.</span></code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/gatsbyjs/static/83cd0b395a5df15fb56b427308e81141/6b5c3/dism.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.241610738255034%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3klEQVQoz+2SyYrCQBCGK92dzmQh20zQs14DIc80hzn4GB4EJ2ZzFxF90t90gx4GhIx49PDRVU3xVXVTNJ39oqwaFGWNRVVjvd1jdzhitdmhalrU7Qpl3WqqZvmQebHA6XwByQ8H0jQhpewwwTmDEELfCc67nIOIejEejUBfgyHiOEaSJIjCEK7rwnEc2LZ9jz3Pg2VZYIzpBn9RAyhhnueg6LMTRWFHhCAItFxJlECIftMZhqHPLMtAfhjD932NeX+61EW3wn8JifX/o55C8RY+L0zT9DVChdqQ758JrhfeCBGwIn+lAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"PracticaImg\"\n        title=\"Imagen de la practica\"\n        src=\"/gatsbyjs/static/83cd0b395a5df15fb56b427308e81141/36727/dism.png\"\n        srcset=\"/gatsbyjs/static/83cd0b395a5df15fb56b427308e81141/acf4b/dism.png 173w,\n/gatsbyjs/static/83cd0b395a5df15fb56b427308e81141/fc834/dism.png 345w,\n/gatsbyjs/static/83cd0b395a5df15fb56b427308e81141/36727/dism.png 690w,\n/gatsbyjs/static/83cd0b395a5df15fb56b427308e81141/6b5c3/dism.png 745w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p><strong>Combinación de ambos:</strong></p>\n<p>Con estos dos comandos (SFC y DISM), si tienes suerte, deberías poder reparar tu sistema. El proceso normal es:\ncorrer el sfc/scannow.\nSi hay errores correr DISM /Online /Cleanup-Image /RestoreHealth\nReiniciar, ejecutar de nuevo el sfc /scannow y repetir hasta que no existan errores o buscar otro método si no se arreglan (mirando el registro de ambos para ver por qué).</p>\n<h2 id=\"tarea-2-del-mismo-modo-crea-un-manual-de-la-herramienta-rootkit-hunter-rkhunter-en-linux-indica-las-opciones-mas-usadas-del-programa-y-entrega-capturas-de-pantallas-para-comprobar-que-has-realizado-la-práctica\"><a href=\"#tarea-2-del-mismo-modo-crea-un-manual-de-la-herramienta-rootkit-hunter-rkhunter-en-linux-indica-las-opciones-mas-usadas-del-programa-y-entrega-capturas-de-pantallas-para-comprobar-que-has-realizado-la-pr%C3%A1ctica\" aria-label=\"tarea 2 del mismo modo crea un manual de la herramienta rootkit hunter rkhunter en linux indica las opciones mas usadas del programa y entrega capturas de pantallas para comprobar que has realizado la práctica permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tarea 2: Del mismo modo, crea un manual de la herramienta Rootkit Hunter (rkhunter) en Linux. Indica las opciones mas usadas del programa y entrega capturas de pantallas para comprobar que has realizado la práctica.</h2>\n<p>Rkhunter es una aplicación para línea de comandos que se encarga automáticamente de analizar nuestro sistema en busca de rootkits, malware, scripts maliciosos, backdoors y otro tipo de software potencialmente peligroso en nuestro sistema Linux fácilmente para saber en todo momento si nuestro sistema se encuentra realmente seguro.</p>\n<p>Terminos asociados:</p>\n<ul>\n<li>Rootkits: Un rootkit permite acceso de privilegio continuo a un sistema y su presencia activamente oculta al control de los administradores al corromper su funcionamiento normal y el de otras aplicaciones. Comúnmente son asociados a malware.</li>\n<li>BackDoor (o puerta trasera): Es una secuencia especial dentro del código de programación, mediante la cual se pueden evitar los sistemas de autentificación para acceder al sistema.</li>\n<li>Exploit: Es un fragmento de software, fragmento de datos o secuencia de comandos y/o acciones, utilizada con el fin de aprovechar una vulnerabilidad de seguridad de un sistema de información para conseguir un comportamiento no deseado del mismo. Acceso de forma no autorizada, toma de control de un sistema, consecución privilegios no concedidos lícitamente, consecución de ataques de denegación de servicio.</li>\n<li>MD5: En criptografía, MD5 es un algoritmo de reducción criptográfico de 128 bits usado en este caso para comprobar que algún archivo no haya sido modificado.</li>\n</ul>\n<p>Comandos:</p>\n<p><strong>Escaneo</strong>\nEl escaneo de nuestro sistema invocando a rkhuter, se lleva a cabo bajo la siguiente linea de comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">root@debian:/home/fran<span class=\"token comment\"># rkhunter --check</span>\n<span class=\"token punctuation\">[</span> Rootkit Hunter version <span class=\"token number\">1.4</span>.6 <span class=\"token punctuation\">]</span>\n\nChecking system commands<span class=\"token punctuation\">..</span>.\n\n  Performing <span class=\"token string\">'strings'</span> <span class=\"token builtin class-name\">command</span> checks\n    Checking <span class=\"token string\">'strings'</span> <span class=\"token builtin class-name\">command</span>                               <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n\n  Performing <span class=\"token string\">'shared libraries'</span> checks\n    Checking <span class=\"token keyword\">for</span> preloading variables                        <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> preloaded libraries                         <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking LD_LIBRARY_PATH variable                        <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n\n  Performing <span class=\"token function\">file</span> properties checks\n    Checking <span class=\"token keyword\">for</span> prerequisites                               <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/awk                                             <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/basename                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/bash                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/cat                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/chattr                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/chmod                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/chown                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/cp                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/curl                                            <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/cut                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/date                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/df                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/diff                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/dirname                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/dmesg                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/dpkg                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/dpkg-query                                      <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/du                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/echo                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/egrep                                           <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/env                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/fgrep                                           <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/file                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/find                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/fuser                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/GET                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/grep                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/groups                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/head                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/id                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ip                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ipcs                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/kill                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/killall                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/last                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/lastlog                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ldd                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/less                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/logger                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/login                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ls                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/lsattr                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/lsmod                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/lsof                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/mail                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/md5sum                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/mktemp                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/more                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/mount                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/mv                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/netstat                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/newgrp                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/passwd                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/perl                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/pgrep                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ping                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/pkill                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ps                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/pstree                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/pwd                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/readlink                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/rkhunter                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/runcon                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sed                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sh                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sha1sum                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sha224sum                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sha256sum                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sha384sum                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sha512sum                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/size                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sort                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/ssh                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/stat                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/strings                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/su                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/sudo                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/tail                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/telnet                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/test                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/top                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/touch                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/tr                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/uname                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/uniq                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/users                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/vmstat                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/w                                               <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/watch                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/wc                                              <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/wget                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/whatis                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/whereis                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/which                                           <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/who                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/whoami                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/numfmt                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/gawk                                            <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/lwp-request                                     <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    /usr/bin/kmod                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/bsd-mailx                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/dash                                            <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/x86_64-linux-gnu-size                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/x86_64-linux-gnu-strings                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/telnet.netkit                                   <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/w.procps                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/systemd                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/bin/systemctl                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/adduser                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/chroot                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/cron                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/depmod                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/fsck                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/groupadd                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/groupdel                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/groupmod                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/grpck                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/ifconfig                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/ifdown                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/ifup                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/init                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/insmod                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/ip                                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/lsmod                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/modinfo                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/modprobe                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/nologin                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/pwck                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/rmmod                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/route                                          <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/rsyslogd                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/runlevel                                       <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/sulogin                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/sysctl                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/useradd                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/userdel                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/usermod                                        <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/vipw                                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/unhide                                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/unhide-linux                                   <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/unhide-posix                                   <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/sbin/unhide-tcp                                     <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    /usr/lib/systemd/systemd                                 <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span>Press <span class=\"token operator\">&lt;</span>ENTER<span class=\"token operator\">></span> to continue<span class=\"token punctuation\">]</span>\n\n\nChecking <span class=\"token keyword\">for</span> rootkits<span class=\"token punctuation\">..</span>.\n\n  Performing check of known rootkit files and directories\n    <span class=\"token number\">55808</span> Trojan - Variant A                                 <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    ADM Worm                                                 <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    AjaKit Rootkit                                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Adore Rootkit                                            <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    aPa Kit                                                  <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Apache Worm                                              <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Ambient <span class=\"token punctuation\">(</span>ark<span class=\"token punctuation\">)</span> Rootkit                                    <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Balaur Rootkit                                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    BeastKit Rootkit                                         <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    beX2 Rootkit                                             <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    BOBKit Rootkit                                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    cb Rootkit                                               <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    CiNIK Worm <span class=\"token punctuation\">(</span>Slapper.B variant<span class=\"token punctuation\">)</span>                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Danny-Boy<span class=\"token string\">'s Abuse Kit                                    [ Not found ]\n    Devil RootKit                                            [ Not found ]\n    Diamorphine LKM                                          [ Not found ]\n    Dica-Kit Rootkit                                         [ Not found ]\n    Dreams Rootkit                                           [ Not found ]\n    Duarawkz Rootkit                                         [ Not found ]\n    Ebury backdoor                                           [ Not found ]\n    Enye LKM                                                 [ Not found ]\n    Flea Linux Rootkit                                       [ Not found ]\n    Fu Rootkit                                               [ Not found ]\n    Fuck`it Rootkit                                          [ Not found ]\n    GasKit Rootkit                                           [ Not found ]\n    Heroin LKM                                               [ Not found ]\n    HjC Kit                                                  [ Not found ]\n    ignoKit Rootkit                                          [ Not found ]\n    IntoXonia-NG Rootkit                                     [ Not found ]\n    Irix Rootkit                                             [ Not found ]\n    Jynx Rootkit                                             [ Not found ]\n    Jynx2 Rootkit                                            [ Not found ]\n    KBeast Rootkit                                           [ Not found ]\n    Kitko Rootkit                                            [ Not found ]\n    Knark Rootkit                                            [ Not found ]\n    ld-linuxv.so Rootkit                                     [ Not found ]\n    Li0n Worm                                                [ Not found ]\n    Lockit / LJK2 Rootkit                                    [ Not found ]\n    Mokes backdoor                                           [ Not found ]\n    Mood-NT Rootkit                                          [ Not found ]\n    MRK Rootkit                                              [ Not found ]\n    Ni0 Rootkit                                              [ Not found ]\n    Ohhara Rootkit                                           [ Not found ]\n    Optic Kit (Tux) Worm                                     [ Not found ]\n    Oz Rootkit                                               [ Not found ]\n    Phalanx Rootkit                                          [ Not found ]\n    Phalanx2 Rootkit                                         [ Not found ]\n    Phalanx2 Rootkit (extended tests)                        [ Not found ]\n    Portacelo Rootkit                                        [ Not found ]\n    R3dstorm Toolkit                                         [ Not found ]\n    RH-Sharpe'</span>s Rootkit                                      <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    RSHA<span class=\"token string\">'s Rootkit                                           [ Not found ]\n    Scalper Worm                                             [ Not found ]\n    Sebek LKM                                                [ Not found ]\n    Shutdown Rootkit                                         [ Not found ]\n    SHV4 Rootkit                                             [ Not found ]\n    SHV5 Rootkit                                             [ Not found ]\n    Sin Rootkit                                              [ Not found ]\n    Slapper Worm                                             [ Not found ]\n    Sneakin Rootkit                                          [ Not found ]\n    '</span>Spanish' Rootkit                                        <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Suckit Rootkit                                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Superkit Rootkit                                         <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    TBD <span class=\"token punctuation\">(</span>Telnet BackDoor<span class=\"token punctuation\">)</span>                                    <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    TeLeKiT Rootkit                                          <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    T0rn Rootkit                                             <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    trNkit Rootkit                                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Trojanit Kit                                             <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Tuxtendo Rootkit                                         <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    URK Rootkit                                              <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Vampire Rootkit                                          <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    VcKit Rootkit                                            <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Volc Rootkit                                             <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Xzibit Rootkit                                           <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    zaRwT.KiT Rootkit                                        <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    ZK Rootkit                                               <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span>Press <span class=\"token operator\">&lt;</span>ENTER<span class=\"token operator\">></span> to continue<span class=\"token punctuation\">]</span>\n\n\n  Performing additional rootkit checks\n    Suckit Rootkit additional checks                         <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> possible rootkit files and directories      <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> possible rootkit strings                    <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n\n  Performing malware checks\n    Checking running processes <span class=\"token keyword\">for</span> suspicious files          <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> login backdoors                             <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> sniffer log files                           <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> suspicious directories                      <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> suspicious <span class=\"token punctuation\">(</span>large<span class=\"token punctuation\">)</span> shared memory segments   <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> Apache backdoor                             <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n\n  Performing Linux specific checks\n    Checking loaded kernel modules                           <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n    Checking kernel module names                             <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span>Press <span class=\"token operator\">&lt;</span>ENTER<span class=\"token operator\">></span> to continue<span class=\"token punctuation\">]</span>\n\n\nChecking the network<span class=\"token punctuation\">..</span>.\n\n  Performing checks on the network ports\n    Checking <span class=\"token keyword\">for</span> backdoor ports                              <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n\n  Performing checks on the network interfaces\n    Checking <span class=\"token keyword\">for</span> promiscuous interfaces                      <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n\nChecking the <span class=\"token builtin class-name\">local</span> host<span class=\"token punctuation\">..</span>.\n\n  Performing system boot checks\n    Checking <span class=\"token keyword\">for</span> <span class=\"token builtin class-name\">local</span> <span class=\"token function\">host</span> name                             <span class=\"token punctuation\">[</span> Found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> system startup files                        <span class=\"token punctuation\">[</span> Found <span class=\"token punctuation\">]</span>\n    Checking system startup files <span class=\"token keyword\">for</span> malware                <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n\n  Performing group and account checks\n    Checking <span class=\"token keyword\">for</span> <span class=\"token function\">passwd</span> <span class=\"token function\">file</span>                                 <span class=\"token punctuation\">[</span> Found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> root equivalent <span class=\"token punctuation\">(</span><span class=\"token environment constant\">UID</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> accounts            <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> passwordless accounts                       <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> <span class=\"token function\">passwd</span> <span class=\"token function\">file</span> changes                         <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> group <span class=\"token function\">file</span> changes                          <span class=\"token punctuation\">[</span> Warning <span class=\"token punctuation\">]</span>\n    Checking root account shell <span class=\"token function\">history</span> files                <span class=\"token punctuation\">[</span> OK <span class=\"token punctuation\">]</span>\n\n  Performing system configuration <span class=\"token function\">file</span> checks\n    Checking <span class=\"token keyword\">for</span> an SSH configuration <span class=\"token function\">file</span>                   <span class=\"token punctuation\">[</span> Not found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> a running system logging daemon             <span class=\"token punctuation\">[</span> Found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> a system logging configuration <span class=\"token function\">file</span>         <span class=\"token punctuation\">[</span> Found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">if</span> syslog remote logging is allowed             <span class=\"token punctuation\">[</span> Not allowed <span class=\"token punctuation\">]</span>\n\n  Performing filesystem checks\n    Checking /dev <span class=\"token keyword\">for</span> suspicious <span class=\"token function\">file</span> types                  <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n    Checking <span class=\"token keyword\">for</span> hidden files and directories                <span class=\"token punctuation\">[</span> None found <span class=\"token punctuation\">]</span>\n\n<span class=\"token punctuation\">[</span>Press <span class=\"token operator\">&lt;</span>ENTER<span class=\"token operator\">></span> to continue<span class=\"token punctuation\">]</span>\n\n\n\nSystem checks summary\n<span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">==</span><span class=\"token operator\">=</span>\n\nFile properties checks<span class=\"token punctuation\">..</span>.\n    Files checked: <span class=\"token number\">143</span>\n    Suspect files: <span class=\"token number\">7</span>\n\nRootkit checks<span class=\"token punctuation\">..</span>.\n    Rootkits checked <span class=\"token builtin class-name\">:</span> <span class=\"token number\">481</span>\n    Possible rootkits: <span class=\"token number\">0</span>\n\nApplications checks<span class=\"token punctuation\">..</span>.\n    All checks skipped\n\nThe system checks took: <span class=\"token number\">6</span> minutes and <span class=\"token number\">52</span> seconds\n\nAll results have been written to the log file: /var/log/rkhunter.log\n\nOne or <span class=\"token function\">more</span> warnings have been found <span class=\"token keyword\">while</span> checking the system.\nPlease check the log <span class=\"token function\">file</span> <span class=\"token punctuation\">(</span>/var/log/rkhunter.log<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Los resultado son muy intuitivos de visualizar, los agrupa en 3 categorías: Archivos sospechosos, posibles rootkits, y aplicaciones sospechosas.<br>\nTambién, nos crea un archivo con los resultados del análisis al que podemos acceder por cualquier consulta.</p>\n<p>Modificando el fichero de rkhunter podemos cambiar las rutas y otros parametros:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">  --examples       <span class=\"token builtin class-name\">:</span> Show layout examples.\n  --layout  <span class=\"token builtin class-name\">:</span> Choose installation template.\n                     The templates are:\n                      - default: <span class=\"token punctuation\">(</span>FHS compliant<span class=\"token punctuation\">;</span> the default<span class=\"token punctuation\">)</span>\n                      - /usr\n                      - /usr/local\n                      - oldschool: old version <span class=\"token function\">file</span> locations\n                      - custom: supply your own installation directory\n                      - RPM: <span class=\"token keyword\">for</span> building RPM<span class=\"token string\">'s. Requires <span class=\"token variable\">$RPM_BUILD_ROOT</span>.\n                      - DEB: for building DEB'</span>s. Requires <span class=\"token variable\">$DEB_BUILD_ROOT</span><span class=\"token builtin class-name\">.</span>\n                      - TGZ: <span class=\"token keyword\">for</span> building Slackware TGZ<span class=\"token string\">'s. Requires <span class=\"token variable\">$TGZ_BUILD_ROOT</span>.\n                      - TXZ: for building Slackware TXZ'</span>s. Requires <span class=\"token variable\">$TXZ_BUILD_ROOT</span><span class=\"token builtin class-name\">.</span>\n  --striproot      <span class=\"token builtin class-name\">:</span> Strip path from custom layout <span class=\"token punctuation\">(</span>for package maintainers<span class=\"token punctuation\">)</span>.\n  --install        <span class=\"token builtin class-name\">:</span> Install according to chosen layout.\n  --overwrite      <span class=\"token builtin class-name\">:</span> Overwrite the existing configuration file.\n                     <span class=\"token punctuation\">(</span>Default is to create a separate configuration file.<span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>Instalación en modo standalone</strong><br>\nEste modo de instalación permite instalar rkhunter en un único directorio, es decir, sin separar binarios, archivos de configuración, logs, etc.</p>\n<p>Si quisiéramos instalar todo en la ruta /opt/rkhunter:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># ./installer.sh --layout custom /opt/rkhunter/ --install</span></code></pre></div>\n<p>Este es el proceso normal de instalación, todo correcto a excepción de un aviso que nos indica que la ruta no se encuentra en el path así que si no lo modificamos manualmente no podremos invocar el comando sin utilizar el path completo:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Note: Directory /opt/rkhunter//bin is not <span class=\"token keyword\">in</span> your <span class=\"token environment constant\">PATH</span>\n\nChecking system for:\n Rootkit Hunter installer files: found\n A web <span class=\"token function\">file</span> download command: <span class=\"token function\">wget</span> found\nStarting installation:\n Checking installation directory <span class=\"token string\">\"/opt/rkhunter/\"</span><span class=\"token builtin class-name\">:</span> it exists and is writable.\n Checking installation directories:\n  Directory /opt/rkhunter//share/doc/rkhunter-1.4.2: creating: OK\n  Directory /opt/rkhunter//share/man/man8: creating: OK\n  Directory /opt/rkhunter//etc: creating: OK\n  Directory /opt/rkhunter//bin: creating: OK\n  Directory /opt/rkhunter//lib64: creating: OK\n  Directory /opt/rkhunter//var/lib: creating: OK\n  Directory /opt/rkhunter//lib64/rkhunter/scripts: creating: OK\n  Directory /opt/rkhunter//var/lib/rkhunter/db: creating: OK\n  Directory /opt/rkhunter//var/lib/rkhunter/tmp: creating: OK\n  Directory /opt/rkhunter//var/lib/rkhunter/db/i18n: creating: OK\n  Directory /opt/rkhunter//var/lib/rkhunter/db/signatures: creating: OK\n Installing check_modules.pl: OK\n Installing filehashsha.pl: OK\n Installing stat.pl: OK\n Installing readlink.sh: OK\n Installing backdoorports.dat: OK\n Installing mirrors.dat: OK\n Installing programs_bad.dat: OK\n Installing suspscan.dat: OK\n Installing rkhunter.8: OK\n Installing ACKNOWLEDGMENTS: OK\n Installing CHANGELOG: OK\n Installing FAQ: OK\n Installing LICENSE: OK\n Installing README: OK\n Installing language support files: OK\n Installing ClamAV signatures: OK\n Installing rkhunter: OK\n Installing rkhunter.conf: OK\nInstallation complete</code></pre></div>\n<p>Este método de instalación es interesante si vamos a probar la herramienta y no queremos integrarla en el sistema, así la podremos borrar fácilmente (eliminar directorio y listo). En el resto de casos, para eliminar rkhunter usaremos el parámetro –remove del instalador:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># ./installer.sh --remove</span></code></pre></div>\n<p><strong>Utilización/Modo de uso</strong></p>\n<p>En el caso de que vayamos a utilizar rkhunter de forma proactiva, es necesario generar una base de datos en la que indiquemos a la herramienta el estado inicial (y correcto) del sistema sobre el cual comparar futuros análisis. El comando para generar la base de datos es el siguiente:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># rkhunter --propupd</span>\n\n<span class=\"token punctuation\">[</span> Rootkit Hunter version <span class=\"token number\">1.4</span>.6 <span class=\"token punctuation\">]</span>\nFile created: searched <span class=\"token keyword\">for</span> <span class=\"token number\">171</span> files, found <span class=\"token number\">118</span></code></pre></div>\n<p>Para hacer un análisis básico del sistema, utilizamos el parámetro -c (check). Podemos personalizar el modo de análisis añadiendo o quitando diferentes tests. Actualmente, los test disponibles son los siguientes:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">Current <span class=\"token builtin class-name\">test</span> names:\n    additional_rkts all apps attributes avail_modules deleted_files\n    filesystem group_accounts group_changes hashes hidden_ports hidden_procs\n    immutable known_rkts loaded_modules local_host malware network\n    none os_specific other_malware packet_cap_apps passwd_changes ports\n    possible_rkt_files possible_rkt_strings promisc properties rootkits running_procs\n    scripts shared_libs shared_libs_path startup_files startup_malware strings\n    suspscan system_commands system_configs trojans\n\nGrouped <span class=\"token builtin class-name\">test</span> names:\n    additional_rkts <span class=\"token operator\">=</span><span class=\"token operator\">></span> possible_rkt_files possible_rkt_strings \n    group_accounts  <span class=\"token operator\">=</span><span class=\"token operator\">></span> group_changes passwd_changes \n    local_host      <span class=\"token operator\">=</span><span class=\"token operator\">></span> filesystem group_changes passwd_changes startup_malware system_configs \n    malware         <span class=\"token operator\">=</span><span class=\"token operator\">></span> deleted_files hidden_procs other_malware running_procs suspscan \n    network         <span class=\"token operator\">=</span><span class=\"token operator\">></span> hidden_ports packet_cap_apps ports promisc \n    os_specific     <span class=\"token operator\">=</span><span class=\"token operator\">></span> avail_modules loaded_modules \n    properties      <span class=\"token operator\">=</span><span class=\"token operator\">></span> attributes hashes immutable scripts \n    rootkits        <span class=\"token operator\">=</span><span class=\"token operator\">></span> avail_modules deleted_files hidden_procs known_rkts loaded_modules other_malware possible_rkt_files possible_rkt_strings running_procs suspscan trojans \n    shared_libs     <span class=\"token operator\">=</span><span class=\"token operator\">></span> shared_libs_path \n    startup_files   <span class=\"token operator\">=</span><span class=\"token operator\">></span> startup_malware \n    system_commands <span class=\"token operator\">=</span><span class=\"token operator\">></span> attributes hashes immutable scripts shared_libs_path strings \n\nCurrent languages:\n    cn de en <span class=\"token function\">tr</span> tr.utf8 zh zh.utf8\n\nRootkits checked for:\n    <span class=\"token number\">55808</span> Trojan - Variant A, AjaKit, aPa Kit, Adore, Apache Worm, Ambient <span class=\"token punctuation\">(</span>ark<span class=\"token punctuation\">)</span>,\n    Balaur, BeastKit, beX2, BOBKit, Boonana <span class=\"token punctuation\">(</span>Koobface.A<span class=\"token punctuation\">)</span>, cb,\n    CiNIK Worm <span class=\"token punctuation\">(</span>Slapper.B variant<span class=\"token punctuation\">)</span>, CX, Danny-Boy<span class=\"token string\">'s Abuse Kit, Devil, Dica, Dreams,\n    Duarawkz, Enye LKM, Flea Linux, FreeBSD, Fu, Fuck`it,\n    GasKit, Heroin LKM, HjC Kit, ignoKit, iLLogiC, Inqtana-A,\n    Inqtana-B, Inqtana-C, IntoXonia-NG, Irix, Jynx, KBeast,\n    Kitko, Knark, ld-linuxv.so, Li0n Worm, Lockit/LJK2, Mood-NT,\n    MRK, Ni0, Ohhara, Optic Kit (Tux), OSXRK, Oz,\n    Phalanx, Phalanx2, Portacelo, R3dstorm Toolkit, RH-Sharpe'</span>s, RSHA's,\n    Scalper Worm, Shutdown, SHV4, SHV5, Sin, SInAR,\n    Slapper, Sneakin, Solaris Wanuk, Spanish, Suckit, SunOS / NSDAP,\n    SunOS Rootkit, Superkit, TBD <span class=\"token punctuation\">(</span>Telnet BackDoor<span class=\"token punctuation\">)</span>, TeLeKiT, Togroot, T0rn,\n    trNkit, Trojanit Kit, Turtle2, Tuxtendo, URK, Vampire,\n    VcKit, Volc, w00tkit, weaponX, Xzibit, X-Org SunOS,\n    zaRwT.KiT, ZK</code></pre></div>\n<p>De primeras, y ante la duda sobre tanta lista de pruebas, podemos lanzar un escaneo completo con todos los tests, así que lo ejecutamos:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># rkhunter -c --enable all</span></code></pre></div>\n<p>Se realiza el escaneo, en este punto, lo importante es revisar cualquier problema que haya podido saltar en el análisis. Información extendida aparecerá en el log var/log/rkhunter.log  </p>\n<p><strong>Actualización de las bases de datos</strong><br>\nCon el parámetro -update revisamos si hay actualizaciones (y actualizamos en caso afirmativo) referente a la información de rootkits, backdoors, malware, etc:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># rkhunter --update</span>\n<span class=\"token punctuation\">[</span> Rootkit Hunter version <span class=\"token number\">1.4</span>.6 <span class=\"token punctuation\">]</span>\n\nChecking rkhunter data files<span class=\"token punctuation\">..</span>.\n  Checking <span class=\"token function\">file</span> mirrors.dat                                  <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> programs_bad.dat                             <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> backdoorports.dat                            <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> suspscan.dat                                 <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/cn                                      <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/de                                      <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/en                                      <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/tr                                      <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/tr.utf8                                 <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/zh                                      <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span>\n  Checking <span class=\"token function\">file</span> i18n/zh.utf8                                 <span class=\"token punctuation\">[</span> No update <span class=\"token punctuation\">]</span></code></pre></div>\n<p><strong>Falsos positivos y personalización</strong></p>\n<p>Como es lógico, pueden aparecer falsos positivos. Para ello tenemos el archivo de configuración «/etc/rkhunter.conf» donde se pueden personalizar todos los parámetros, por ejemplo añadiendo scripts o binarios en lista blanca (SCRIPTWHITELIST), configurar alertas por correo electrónico (MAIL-ON-WARNING), configuraciones de SSH (ALLOW<em>SSH</em>ROOT_USER), etc.</p>\n<p>Después de cada cambio en la configuración hay que volver a actualizar la base de datos de rkhunter, sino aparecerán alertas y errores:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token comment\"># rkhunter --propupd</span></code></pre></div>\n<p><strong>Automatización de análisis</strong>\nPara automatizar los análisis, simplemente añadimos una entrada en el cron de root que ejecute periódicamente el análisis según nuestros requerimientos. Podemos añadir el parámetro «–quiet» y «–cronjob» para evitar ruido al ser una ejecución desatendida. En este caso lo ejecutamos a las 8 de la mañana todos los días junto con un update por si hay actualizaciones:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">crontab</span> -u root -e\n\n<span class=\"token number\">0</span> 08 * * * /usr/bin/rkhunter --cronjob --update --quiet<span class=\"token punctuation\">;</span> /usr/bin/rkhunter --cronjob -c --enable all --quiet</code></pre></div>\n<p>Por supuesto, en lugar de añadirlo así al cron se puede crear un script más optimizado que realice el update y el chequeo según nuestros requerimientos. Después, basta con invocar ese script en el cron.io.</p>","timeToRead":15,"excerpt":"Práctica 3: Integridad de ficheros En caso de que algún tipo de malware reemplace o falsifique archivos del sistema operativo, ocultándose…","frontmatter":{"title":"Práctica 3: Integridad de ficheros","cover":"https://img.icons8.com/ios/452/work.png","date":"2020-10-08T00:00:00.000Z","categories":["Seguridad"],"tags":["Integridad"]},"fields":{"slug":"/practica-3-integridad-de-ficheros","date":"October 07, 2020"}}},"pageContext":{"slug":"/practica-3-integridad-de-ficheros","nexttitle":"Configuración de cliente OpenVPN con certificados X.509","nextslug":"/configuracion-de-cliente-open-vpn-con-certificados-x-509","prevtitle":"Práctica 2: rclone - Gestionando nuestro almacenamiento en la nube","prevslug":"/practica-2-rclone-gestionando-nuestro-almacenamiento-en-la-nube"}}}