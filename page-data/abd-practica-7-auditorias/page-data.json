{"componentChunkName":"component---src-templates-post-js","path":"/abd-practica-7-auditorias","result":{"data":{"markdownRemark":{"html":"<center><img alt=\"Auditor&#xED;as base de datos\" src=\"https://miro.medium.com/max/413/1*z2Q0z24IbwF1RLPa4X6glw.png\"></center>\n<p>Realiza y documenta adecuadamente las siguientes operaciones:</p>\n<h2 id=\"1-activa-desde-sqlplus-la-auditoría-de-los-intentos-de-acceso-fallidos-al-sistema-comprueba-su-funcionamiento\"><a href=\"#1-activa-desde-sqlplus-la-auditor%C3%ADa-de-los-intentos-de-acceso-fallidos-al-sistema-comprueba-su-funcionamiento\" aria-label=\"1 activa desde sqlplus la auditoría de los intentos de acceso fallidos al sistema comprueba su funcionamiento permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Activa desde SQL*Plus la auditoría de los intentos de acceso fallidos al sistema. Comprueba su funcionamiento.</h2>\n<p>Visualizaremos los parametros de auditorias.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SHOW PARAMETER AUDIT\n\nNAME\t\t\t\t     TYPE\t VALUE\n------------------------------------ ----------- ------------------------------\naudit_file_dest \t\t     string\t /opt/oracle/admin/ORCL/adump\naudit_sys_operations\t\t     boolean\t FALSE\naudit_syslog_level\t\t     string\naudit_trail\t\t\t     string\t NONE\nunified_audit_sga_queue_size\t     integer\t <span class=\"token number\">1048576</span></code></pre></div>\n<p>Activamos audit_trail:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> ALTER SYSTEM SET <span class=\"token assign-left variable\">audit_trail</span><span class=\"token operator\">=</span>db <span class=\"token assign-left variable\">scope</span><span class=\"token operator\">=</span>spfile<span class=\"token punctuation\">;</span>\n\nSystem altered.</code></pre></div>\n<p>Reiniciaremos Oracle.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SHUTDOWN\nDatabase closed.\nDatabase dismounted.\nORACLE instance shut down.\nSQL<span class=\"token operator\">></span> STARTUP\nORACLE instance started.\n\nTotal System Global Area  <span class=\"token number\">629145600</span> bytes\nFixed Size\t\t    <span class=\"token number\">8623832</span> bytes\nVariable Size\t\t  <span class=\"token number\">524290344</span> bytes\nDatabase Buffers\t   <span class=\"token number\">88080384</span> bytes\nRedo Buffers\t\t    <span class=\"token number\">8151040</span> bytes\nDatabase mounted.\nDatabase opened.\nSQL<span class=\"token operator\">></span> ALTER <span class=\"token environment constant\">SESSION</span> SET <span class=\"token string\">\"_ORACLE_SCRIPT\"</span><span class=\"token operator\">=</span>true<span class=\"token punctuation\">;</span>\n\nSession altered.\n\nSQL<span class=\"token operator\">></span> SHOW PARAMETER AUDIT\n\nNAME\t\t\t\t     TYPE\t VALUE\n------------------------------------ ----------- ------------------------------\naudit_file_dest \t\t     string\t /opt/oracle/admin/ORCL/adump\naudit_sys_operations\t\t     boolean\t FALSE\naudit_syslog_level\t\t     string\naudit_trail\t\t\t     string\t DB\nunified_audit_sga_queue_size\t     integer\t <span class=\"token number\">1048576</span></code></pre></div>\n<p>Activamos la auditoria.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> AUDIT CREATE <span class=\"token environment constant\">SESSION</span> WHENEVER NOT SUCCESSFUL<span class=\"token punctuation\">;</span>\n\nAudit succeeded.</code></pre></div>\n<p>Comprobamos su activación.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> AUDIT CREATE <span class=\"token environment constant\">SESSION</span> BY fran<span class=\"token punctuation\">;</span>      \n\nAudit succeeded.\n\nSQL<span class=\"token operator\">></span> SELECT * FROM DBA_PRIV_AUDIT_OPTS<span class=\"token punctuation\">;</span>\n\nUSER_NAME\n--------------------------------------------------------------------------------\nPROXY_NAME\n--------------------------------------------------------------------------------\nPRIVILEGE\t\t\t\t SUCCESS    FAILURE\n---------------------------------------- ---------- ----------\n\n\nCREATE <span class=\"token environment constant\">SESSION</span>\t\t\t\t NOT SET    BY ACCESS\n\nFRAN\n\nCREATE <span class=\"token environment constant\">SESSION</span>\t\t\t\t BY ACCESS  BY ACCESS\n\nUSER_NAME\n--------------------------------------------------------------------------------\nPROXY_NAME\n--------------------------------------------------------------------------------\nPRIVILEGE\t\t\t\t SUCCESS    FAILURE\n---------------------------------------- ---------- ----------</code></pre></div>\n<p>Probaremos la auditoria, intentando acceceder a nuestra base de datos.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">[</span>oracle@oracle1 ~<span class=\"token punctuation\">]</span>$ sqlplus\n\nSQL*Plus: Release <span class=\"token number\">12.2</span>.0.1.0 Production on Tue Mar <span class=\"token number\">9</span> <span class=\"token number\">17</span>:13:05 <span class=\"token number\">2021</span>\n\nCopyright <span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span> <span class=\"token number\">1982</span>, <span class=\"token number\">2016</span>, Oracle.  All rights reserved.\n\nEnter user-name: fran\nEnter password: \nERROR:\nORA-01017: invalid username/password<span class=\"token punctuation\">;</span> logon denied\n\n\nEnter user-name: fran\nEnter password: \nERROR:\nORA-01017: invalid username/password<span class=\"token punctuation\">;</span> logon denied\n\n\nEnter user-name: sys\nEnter password: \nERROR:\nORA-28009: connection as SYS should be as SYSDBA or SYSOPER\n\n\nSP2-0157: unable to CONNECT to ORACLE after <span class=\"token number\">3</span> attempts, exiting SQL*Plus</code></pre></div>\n<p>Visualizaremos los accesos fallidos.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SELECT OS_USERNAME, USERNAME, EXTENDED_TIMESTAMP, ACTION_NAME, RETURNCODE\n  <span class=\"token number\">2</span>  FROM DBA_AUDIT_SESSION<span class=\"token punctuation\">;</span>\n\nOS_USERNAME\n--------------------------------------------------------------------------------\nUSERNAME\n--------------------------------------------------------------------------------\nEXTENDED_TIMESTAMP\n---------------------------------------------------------------------------\nACTION_NAME\t\t     RETURNCODE\n---------------------------- ----------\noracle\nFRAN\n09-MAR-21 05.12.49.102118 PM -03:00\nLOGON\t\t\t\t      <span class=\"token number\">0</span>\n\n\nOS_USERNAME\n--------------------------------------------------------------------------------\nUSERNAME\n--------------------------------------------------------------------------------\nEXTENDED_TIMESTAMP\n---------------------------------------------------------------------------\nACTION_NAME\t\t     RETURNCODE\n---------------------------- ----------\noracle\nFRAN\n09-MAR-21 05.13.09.178910 PM -03:00\nLOGON\t\t\t\t   <span class=\"token number\">1017</span>\n\n\nOS_USERNAME\n--------------------------------------------------------------------------------\nUSERNAME\n--------------------------------------------------------------------------------\nEXTENDED_TIMESTAMP\n---------------------------------------------------------------------------\nACTION_NAME\t\t     RETURNCODE\n---------------------------- ----------\noracle\nFRAN\n09-MAR-21 05.13.13.252421 PM -03:00\nLOGON\t\t\t\t   <span class=\"token number\">1017</span>\n\n\nOS_USERNAME\n--------------------------------------------------------------------------------\nUSERNAME\n--------------------------------------------------------------------------------\nEXTENDED_TIMESTAMP\n---------------------------------------------------------------------------\nACTION_NAME\t\t     RETURNCODE\n---------------------------- ----------\noracle\nFRAN\n09-MAR-21 05.13.03.893419 PM -03:00\nLOGOFF\t\t\t\t      <span class=\"token number\">0</span></code></pre></div>\n<p>Para finalizar, desactivaremos la auditoría.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> NOAUDIT CREATE <span class=\"token environment constant\">SESSION</span> WHENEVER NOT SUCCESSFUL<span class=\"token punctuation\">;</span>\n\nNoaudit succeeded.</code></pre></div>\n<h2 id=\"2-realiza-un-procedimiento-en-plsql-que-te-muestre-los-accesos-fallidos-junto-con-el-motivo-de-los-mismos-transformando-el-código-de-error-almacenado-en-un-mensaje-de-texto-comprensible\"><a href=\"#2-realiza-un-procedimiento-en-plsql-que-te-muestre-los-accesos-fallidos-junto-con-el-motivo-de-los-mismos-transformando-el-c%C3%B3digo-de-error-almacenado-en-un-mensaje-de-texto-comprensible\" aria-label=\"2 realiza un procedimiento en plsql que te muestre los accesos fallidos junto con el motivo de los mismos transformando el código de error almacenado en un mensaje de texto comprensible permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Realiza un procedimiento en PL/SQL que te muestre los accesos fallidos junto con el motivo de los mismos, transformando el código de error almacenado en un mensaje de texto comprensible.</h2>\n<p>Función para devolver el motivo del error:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">CREATE OR REPLACE FUNCTION DevolverMotivo\n<span class=\"token punctuation\">(</span>\n    p_error NUMBER\n<span class=\"token punctuation\">)</span>\nRETURN VARCHAR2\nIS\n    mensaje VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nBEGIN\n    CASE p_error\n        WHEN <span class=\"token number\">1017</span> THEN \n            mensaje:<span class=\"token operator\">=</span><span class=\"token string\">'Contraseña Incorrecta'</span><span class=\"token punctuation\">;</span>\n        WHEN <span class=\"token number\">28000</span> THEN\n            mensaje:<span class=\"token operator\">=</span><span class=\"token string\">'Cuenta Bloqueada'</span><span class=\"token punctuation\">;</span>\n        ELSE\n            mensaje:<span class=\"token operator\">=</span><span class=\"token string\">'Error Desconocido'</span><span class=\"token punctuation\">;</span>\n    END CASE<span class=\"token punctuation\">;</span>\nRETURN mensaje<span class=\"token punctuation\">;</span>\nEND DevolverMotivo<span class=\"token punctuation\">;</span>\n/\n\nFunction created.</code></pre></div>\n<p>Procedimiento:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">CREATE OR REPLACE PROCEDURE MostrarAccesosFallidos\nIS\n    CURSOR c_accesos\n    IS \n    SELECT username, returncode, timestamp\n    FROM dba_audit_session \n    WHERE <span class=\"token assign-left variable\">action_name</span><span class=\"token operator\">=</span><span class=\"token string\">'LOGON'</span> \n    AND returncode <span class=\"token operator\">!=</span> <span class=\"token number\">0</span> \n    ORDER BY timestamp<span class=\"token punctuation\">;</span>\n\n    v_motivo VARCHAR2<span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nBEGIN\n    DBMS_OUTPUT.PUT_LINE<span class=\"token punctuation\">(</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'-- AUDITORÍA DE ACCESOS FALLIDOS --'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    DBMS_OUTPUT.PUT_LINE<span class=\"token punctuation\">(</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'USUARIO'</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'FECHA'</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\n        <span class=\"token string\">'MOTIVO'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    DBMS_OUTPUT.PUT_LINE<span class=\"token punctuation\">(</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span><span class=\"token string\">'----------------------------------------------------------------'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    FOR acceso IN c_accesos LOOP\n        v_motivo:<span class=\"token operator\">=</span>DevolverMotivo<span class=\"token punctuation\">(</span>acceso.returncode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        DBMS_OUTPUT.PUT_LINE<span class=\"token punctuation\">(</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>acceso.username<span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>\n            TO_CHAR<span class=\"token punctuation\">(</span>acceso.timestamp,<span class=\"token string\">'YY/MM/DD DY HH24:MI'</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>CHR<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span><span class=\"token operator\">||</span>v_motivo<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    END LOOP<span class=\"token punctuation\">;</span> \nEND MostrarAccesosFallidos<span class=\"token punctuation\">;</span>\n/</code></pre></div>\n<h2 id=\"3-activa-la-auditoría-de-las-operaciones-dml-realizadas-por-scott-comprueba-su-funcionamiento\"><a href=\"#3-activa-la-auditor%C3%ADa-de-las-operaciones-dml-realizadas-por-scott-comprueba-su-funcionamiento\" aria-label=\"3 activa la auditoría de las operaciones dml realizadas por scott comprueba su funcionamiento permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Activa la auditoría de las operaciones DML realizadas por SCOTT. Comprueba su funcionamiento.</h2>\n<p>Activamos la auditoría.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">AUDIT INSERT TABLE, UPDATE TABLE, DELETE TABLE BY SCOTT BY ACCESS<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Donde:</p>\n<ul>\n<li>BY ACCESS : Realiza un registro por cada acción.</li>\n<li>BY SESSION : Realiza un registro de todas las acciones por cada sesión iniciada.</li>\n</ul>\n<p>Realizamos una prueba:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> CONN SCOTT/TIGER\nConnected.\nSQL<span class=\"token operator\">></span> INSERT INTO dept VALUES<span class=\"token punctuation\">(</span><span class=\"token number\">50</span>,<span class=\"token string\">'RRHH'</span>,<span class=\"token string\">'Dos Hermanas'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token number\">1</span> row created.\n\nSQL<span class=\"token operator\">></span> UPDATE dept SET <span class=\"token assign-left variable\">loc</span><span class=\"token operator\">=</span><span class=\"token string\">'Sevilla'</span> WHERE <span class=\"token assign-left variable\">deptno</span><span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token number\">1</span> row updated.\n\nSQL<span class=\"token operator\">></span> DELETE FROM dept WHERE <span class=\"token assign-left variable\">deptno</span><span class=\"token operator\">=</span><span class=\"token number\">50</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token number\">1</span> row deleted.\n\nSQL<span class=\"token operator\">></span> COMMIT<span class=\"token punctuation\">;</span>\n\nCommit complete.</code></pre></div>\n<p>Para ver las acciones realizadas por SCOTT:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SELECT obj_name, action_name, timestamp\nFROM dba_audit_object\nWHERE <span class=\"token assign-left variable\">username</span><span class=\"token operator\">=</span><span class=\"token string\">'SCOTT'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SELECT obj_name, action_name, timestamp\n  <span class=\"token number\">2</span>  FROM dba_audit_object\n  <span class=\"token number\">3</span>  WHERE <span class=\"token assign-left variable\">username</span><span class=\"token operator\">=</span><span class=\"token string\">'SCOTT'</span><span class=\"token punctuation\">;</span>\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDUMMY\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nUPDATE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nDEPT\nDELETE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\n<span class=\"token number\">34</span> rows selected.</code></pre></div>\n<p>En mi caso ha bastantes salidas puesto que he añadido al usuario SCOTT y su esquema a la base de datos ahora mismo.\n<a href=\"http://www.tecnoent.com/838-creando-esquema-scott-tiger-oracl\">Pasos a seguir para añadir el usuario SCOTT a tu base de datos Oracle</a>.</p>\n<h2 id=\"4-realiza-una-auditoría-de-grano-fino-para-almacenar-información-sobre-la-inserción-de-empleados-del-departamento-10-en-la-tabla-emp-de-scott\"><a href=\"#4-realiza-una-auditor%C3%ADa-de-grano-fino-para-almacenar-informaci%C3%B3n-sobre-la-inserci%C3%B3n-de-empleados-del-departamento-10-en-la-tabla-emp-de-scott\" aria-label=\"4 realiza una auditoría de grano fino para almacenar información sobre la inserción de empleados del departamento 10 en la tabla emp de scott permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Realiza una auditoría de grano fino para almacenar información sobre la inserción de empleados del departamento 10 en la tabla emp de scott.</h2>\n<p>Creación de la auditoría de grano fino:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> BEGIN\n    DBMS_FGA.ADD_POLICY <span class=\"token punctuation\">(</span>\n        object_schema      <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'SCOTT'</span>,\n        object_name        <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'EMP'</span>,\n        policy_name        <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'mypolicy1'</span>,\n        audit_condition    <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'DEPTNO = 10'</span>,\n        statement_types    <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'INSERT'</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nEND<span class=\"token punctuation\">;</span>\n/ \n\nPL/SQL procedure successfully completed.</code></pre></div>\n<p>Ver la política creada:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SELECT object_schema,object_name,policy_name,policy_text\n  <span class=\"token number\">2</span>  FROM dba_audit_policies<span class=\"token punctuation\">;</span>\n\nOBJECT_SCHEMA\n--------------------------------------------------------------------------------\nOBJECT_NAME\n--------------------------------------------------------------------------------\nPOLICY_NAME\n--------------------------------------------------------------------------------\nPOLICY_TEXT\n--------------------------------------------------------------------------------\nSCOTT\nEMP\nMYPOLICY1\nDEPTNO <span class=\"token operator\">=</span> <span class=\"token number\">10</span></code></pre></div>\n<p>Realizamos una prueba:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">CONN SCOTT/TIGER\n\nINSERT INTO emp VALUES<span class=\"token punctuation\">(</span><span class=\"token number\">7950</span>,<span class=\"token string\">'Lora'</span>,<span class=\"token string\">'trasport'</span>,null,sysdate,9999,9999,10<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nINSERT INTO emp VALUES<span class=\"token punctuation\">(</span><span class=\"token number\">7951</span>,<span class=\"token string\">'Calde'</span>,<span class=\"token string\">'utillero'</span>,null,sysdate,9999,9999,10<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nCOMMIT<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Para visualizar las acciones realizadas.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SELECT sql_text\n  <span class=\"token number\">2</span>  FROM dba_fga_audit_trail\n  <span class=\"token number\">3</span>  WHERE <span class=\"token assign-left variable\">policy_name</span><span class=\"token operator\">=</span><span class=\"token string\">'MYPOLICY1'</span><span class=\"token punctuation\">;</span>\n\nSQL_TEXT\n--------------------------------------------------------------------------------\nINSERT INTO emp VALUES<span class=\"token punctuation\">(</span><span class=\"token number\">7950</span>,<span class=\"token string\">'Lora'</span>,<span class=\"token string\">'trasport'</span>,null,sysdate,9999,9999,10<span class=\"token punctuation\">)</span>\nINSERT INTO emp VALUES<span class=\"token punctuation\">(</span><span class=\"token number\">7951</span>,<span class=\"token string\">'Calde'</span>,<span class=\"token string\">'utillero'</span>,null,sysdate,9999,9999,10<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Para eliminar la auditoría de grano fino:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> BEGIN\n    DBMS_FGA.DROP_POLICY <span class=\"token punctuation\">(</span>\n        object_schema      <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'SCOTT'</span>,\n        object_name        <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'EMP'</span>,\n        policy_name        <span class=\"token operator\">=</span><span class=\"token operator\">></span>  <span class=\"token string\">'mypolicy1'</span>      \n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nEND<span class=\"token punctuation\">;</span>\n/\n\nPL/SQL procedure successfully completed.</code></pre></div>\n<h2 id=\"5-explica-la-diferencia-entre-auditar-una-operación-by-access-o-by-session\"><a href=\"#5-explica-la-diferencia-entre-auditar-una-operaci%C3%B3n-by-access-o-by-session\" aria-label=\"5 explica la diferencia entre auditar una operación by access o by session permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Explica la diferencia entre auditar una operación by access o by session.</h2>\n<p><strong>BY ACCES:</strong> Realiza un registro por cada sentencia auditada.\n<strong>BY SESSION:</strong> Agrupa las sentencias por tipos en un registro por cada sesión iniciada.</p>\n<p>Realizaremos un ejemplo de 'By session':</p>\n<p>Primero activamos la auditoría.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">AUDIT INSERT TABLE, UPDATE TABLE, DELETE TABLE BY SYSTEM BY <span class=\"token environment constant\">SESSION</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Realizaremos una serie de pruebas.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">CONN SCOTT/TIGER\n\nINSERT INTO SCOTT.dept VALUES<span class=\"token punctuation\">(</span><span class=\"token number\">60</span>,<span class=\"token string\">'RRHH'</span>,<span class=\"token string\">'Namibia'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nUPDATE SCOTT.dept SET <span class=\"token assign-left variable\">loc</span><span class=\"token operator\">=</span><span class=\"token string\">'Congo'</span> WHERE <span class=\"token assign-left variable\">deptno</span><span class=\"token operator\">=</span><span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n\nDELETE FROM SCOTT.dept WHERE <span class=\"token assign-left variable\">deptno</span><span class=\"token operator\">=</span><span class=\"token number\">60</span><span class=\"token punctuation\">;</span>\n\nCOMMIT<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Cambiamos al usuario administrador y comparamos registros:</p>\n<p><strong>BY SESSION:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SELECT owner, obj_name, action_name, timestamp, priv_used\nFROM dba_audit_object\nWHERE <span class=\"token assign-left variable\">username</span><span class=\"token operator\">=</span><span class=\"token string\">'SCOTT'</span><span class=\"token punctuation\">;</span>\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nMDSYS\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nMDSYS\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\n\nMDSYS\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nMDSYS\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nMDSYS\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nSCOTT\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\n\nSCOTT\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nSALGRADE\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nSCOTT\nDUMMY\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\n\nSCOTT\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nDEPT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nSCOTT\nDEPT\nUPDATE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nDEPT\nUPDATE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\n\nSCOTT\nDEPT\nDELETE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSCOTT\nDEPT\n\nOWNER\n--------------------------------------------------------------------------------\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP PRIV_USED\n---------------------------- --------- ----------------------------------------\nDELETE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\n<span class=\"token number\">39</span> rows selected.</code></pre></div>\n<p><strong>BY ACCESS:</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> <span class=\"token keyword\">select</span> obj_name,action_name, timestamp\n  <span class=\"token number\">2</span>  from dba_audit_object\n  <span class=\"token number\">3</span>  where <span class=\"token assign-left variable\">username</span><span class=\"token operator\">=</span><span class=\"token string\">'SCOTT'</span><span class=\"token punctuation\">;</span>\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSDO_GEOR_DDL__TABLE<span class=\"token variable\">$$</span>\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nSALGRADE\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDUMMY\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nEMP\nINSERT\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nUPDATE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\nOBJ_NAME\n--------------------------------------------------------------------------------\nACTION_NAME\t\t     TIMESTAMP\n---------------------------- ---------\nDEPT\nUPDATE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nDELETE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\nDEPT\nDELETE\t\t\t     <span class=\"token number\">10</span>-MAR-21\n\n\n<span class=\"token number\">39</span> rows selected.</code></pre></div>\n<p>Como podemos comprobar los registros son muy similares, Oracle recomienda el uso de 'By access'.</p>\n<h2 id=\"6-documenta-las-diferencias-entre-los-valores-db-y-db-extended-del-parámetro-audit_trail-de-oracle-demuéstralas-poniendo-un-ejemplo-de-la-información-sobre-una-operación-concreta-recopilada-con-cada-uno-de-ellos\"><a href=\"#6-documenta-las-diferencias-entre-los-valores-db-y-db-extended-del-par%C3%A1metro-audit_trail-de-oracle-demu%C3%A9stralas-poniendo-un-ejemplo-de-la-informaci%C3%B3n-sobre-una-operaci%C3%B3n-concreta-recopilada-con-cada-uno-de-ellos\" aria-label=\"6 documenta las diferencias entre los valores db y db extended del parámetro audit_trail de oracle demuéstralas poniendo un ejemplo de la información sobre una operación concreta recopilada con cada uno de ellos permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Documenta las diferencias entre los valores db y db, extended del parámetro audit_trail de ORACLE. Demuéstralas poniendo un ejemplo de la información sobre una operación concreta recopilada con cada uno de ellos.</h2>\n<p>Las diferencias son mínimas y es que solo se diferencia en que db extend aparte de almacenarse en SYS.AUD$ también escribe valores en las columnas SQLBIND y SQLTEXT.</p>\n<p><strong>Ejemplo:</strong></p>\n<p>Para este ejemplo lo primero que deberemos hacer es activar las auditorias:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SHOW PARAMETER AUDIT<span class=\"token punctuation\">;</span>\n\nNAME\t\t\t\t     TYPE\t VALUE\n------------------------------------ ----------- ------------------------------\naudit_file_dest \t\t     string\t /opt/oracle/admin/ORCL/adump\naudit_sys_operations\t\t     boolean\t FALSE\naudit_syslog_level\t\t     string\naudit_trail\t\t\t     string\t DB\nunified_audit_sga_queue_size\t     integer\t <span class=\"token number\">1048576</span>\n\nSQL<span class=\"token operator\">></span> ALTER SYSTEM SET audit_trail <span class=\"token operator\">=</span> DB, EXTENDED <span class=\"token assign-left variable\">SCOPE</span><span class=\"token operator\">=</span>SPFILE<span class=\"token punctuation\">;</span>\n\nSystem altered.</code></pre></div>\n<p>Deberemos de reiniciar la base de datos como anteriormente.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> <span class=\"token function\">shutdown</span>\nDatabase closed.\nDatabase dismounted.\nORACLE instance shut down.\nSQL<span class=\"token operator\">></span> startup\nORACLE instance started.\n\nTotal System Global Area  <span class=\"token number\">629145600</span> bytes\nFixed Size\t\t    <span class=\"token number\">8623832</span> bytes\nVariable Size\t\t  <span class=\"token number\">520096040</span> bytes\nDatabase Buffers\t   <span class=\"token number\">92274688</span> bytes\nRedo Buffers\t\t    <span class=\"token number\">8151040</span> bytes\nDatabase mounted.\nDatabase opened.\nSQL<span class=\"token operator\">></span></code></pre></div>\n<p>Y comprobamos como hemos añadido un nuevo valor en la auditoria:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">SQL<span class=\"token operator\">></span> SHOW PARAMETER AUDIT<span class=\"token punctuation\">;</span>\n\nNAME\t\t\t\t     TYPE\t VALUE\n------------------------------------ ----------- ------------------------------\naudit_file_dest \t\t     string\t /opt/oracle/admin/ORCL/adump\naudit_sys_operations\t\t     boolean\t FALSE\naudit_syslog_level\t\t     string\naudit_trail\t\t\t     string\t DB, EXTENDED\nunified_audit_sga_queue_size\t     integer\t <span class=\"token number\">1048576</span></code></pre></div>\n<h2 id=\"7-localiza-en-enterprise-manager-las-posibilidades-para-realizar-una-auditoría-e-intenta-repetir-con-dicha-herramienta-los-apartados-1-3-y-4\"><a href=\"#7-localiza-en-enterprise-manager-las-posibilidades-para-realizar-una-auditor%C3%ADa-e-intenta-repetir-con-dicha-herramienta-los-apartados-1-3-y-4\" aria-label=\"7 localiza en enterprise manager las posibilidades para realizar una auditoría e intenta repetir con dicha herramienta los apartados 1 3 y 4 permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>7. Localiza en Enterprise Manager las posibilidades para realizar una auditoría e intenta repetir con dicha herramienta los apartados 1, 3 y 4.</h2>\n<h2 id=\"8-averigua-si-en-postgres-se-pueden-realizar-los-apartados-1-3-y-4-si-es-así-documenta-el-proceso-adecuadamente\"><a href=\"#8-averigua-si-en-postgres-se-pueden-realizar-los-apartados-1-3-y-4-si-es-as%C3%AD-documenta-el-proceso-adecuadamente\" aria-label=\"8 averigua si en postgres se pueden realizar los apartados 1 3 y 4 si es así documenta el proceso adecuadamente permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>8. Averigua si en Postgres se pueden realizar los apartados 1, 3 y 4. Si es así, documenta el proceso adecuadamente.</h2>\n<p>En Postgres no existen auditorías como tal, y deberemos hacer uso de procedimientos y funciones para realizar una función similar.</p>\n<p>Para crear un caso hipotético de una tabla de históricos haremos lo siguiente:</p>\n<p>Primero crearemos una tabla para la auditoría.\nSegundo, crearemos una funcion que actualice los datos de la tabla creada.\nTercero, crearemos un trigger que dispare la funcion anterior cuando se produzcan cambios en la tabla original.</p>\n<p>Si queremos una guia mas detallada podemos obtener información en <a href=\"https://usuarioperu.com/2018/07/23/auditoria-de-tablas-en-postgresql-i/\">https://usuarioperu.com/2018/07/23/auditoria-de-tablas-en-postgresql-i/</a></p>\n<h2 id=\"9-averigua-si-en-mysql-se-pueden-realizar-los-apartados-1-3-y-4-si-es-así-documenta-el-proceso-adecuadamente\"><a href=\"#9-averigua-si-en-mysql-se-pueden-realizar-los-apartados-1-3-y-4-si-es-as%C3%AD-documenta-el-proceso-adecuadamente\" aria-label=\"9 averigua si en mysql se pueden realizar los apartados 1 3 y 4 si es así documenta el proceso adecuadamente permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>9. Averigua si en MySQL se pueden realizar los apartados 1, 3 y 4. Si es así, documenta el proceso adecuadamente.</h2>\n<p>Creamos una base de datos y una tabla.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">MariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database actividad9<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">1</span> row affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> use actividad9<span class=\"token punctuation\">;</span>\nDatabase changed\n\nMariaDB <span class=\"token punctuation\">[</span>actividad9<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create table usuarios<span class=\"token punctuation\">(</span>\n    -<span class=\"token operator\">></span> dni varchar<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>,\n    -<span class=\"token operator\">></span> nombre varchar<span class=\"token punctuation\">(</span><span class=\"token number\">25</span><span class=\"token punctuation\">)</span>,\n    -<span class=\"token operator\">></span> apellido varchar<span class=\"token punctuation\">(</span><span class=\"token number\">45</span><span class=\"token punctuation\">)</span>,\n    -<span class=\"token operator\">></span> telefono varchar<span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">)</span>,\n    -<span class=\"token operator\">></span> constraint pk_dni primary key <span class=\"token punctuation\">(</span>dni<span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected, <span class=\"token number\">1</span> warning <span class=\"token punctuation\">(</span><span class=\"token number\">0.032</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Crearemos una base de datos para las auditorias y una tabla para que almacene la salida del trigger:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">MariaDB <span class=\"token punctuation\">[</span>actividad9<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> create database auditorias<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">1</span> row affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span>actividad9<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> use auditorias\nDatabase changed\nMariaDB <span class=\"token punctuation\">[</span>auditorias<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> \n\nMariaDB <span class=\"token punctuation\">[</span>auditorias<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> CREATE TABLE accesos\n    -<span class=\"token operator\">></span>  <span class=\"token punctuation\">(</span>\n    -<span class=\"token operator\">></span>    codigo int<span class=\"token punctuation\">(</span><span class=\"token number\">11</span><span class=\"token punctuation\">)</span> NOT NULL AUTO_INCREMENT,\n    -<span class=\"token operator\">></span>    usuario varchar<span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>,\n    -<span class=\"token operator\">></span>    fecha datetime,\n    -<span class=\"token operator\">></span>    PRIMARY KEY <span class=\"token punctuation\">(</span><span class=\"token variable\"><span class=\"token variable\">`</span>codigo<span class=\"token variable\">`</span></span><span class=\"token punctuation\">)</span>\n    -<span class=\"token operator\">></span>  <span class=\"token punctuation\">)</span>\n    -<span class=\"token operator\">></span>  <span class=\"token assign-left variable\">ENGINE</span><span class=\"token operator\">=</span>MyISAM <span class=\"token assign-left variable\">AUTO_INCREMENT</span><span class=\"token operator\">=</span><span class=\"token number\">1</span> DEFAULT <span class=\"token assign-left variable\">CHARSET</span><span class=\"token operator\">=</span>latin1<span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.004</span> sec<span class=\"token punctuation\">)</span>\n\nMariaDB <span class=\"token punctuation\">[</span>auditorias<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> delimiter <span class=\"token variable\">$$</span>\nMariaDB <span class=\"token punctuation\">[</span>auditorias<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> CREATE TRIGGER actividad9.root\n    -<span class=\"token operator\">></span> BEFORE INSERT ON actividad9.usuarios\n    -<span class=\"token operator\">></span> FOR EACH ROW\n    -<span class=\"token operator\">></span> BEGIN\n    -<span class=\"token operator\">></span> INSERT INTO auditorias.accesos <span class=\"token punctuation\">(</span>usuario, fecha<span class=\"token punctuation\">)</span>\n    -<span class=\"token operator\">></span> values <span class=\"token punctuation\">(</span>CURRENT_USER<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>, NOW<span class=\"token punctuation\">(</span><span class=\"token punctuation\">))</span><span class=\"token punctuation\">;</span>\n    -<span class=\"token operator\">></span> END<span class=\"token variable\">$$</span>\nQuery OK, <span class=\"token number\">0</span> rows affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.005</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Ahora procederemos a probar los cambios realizados, añadiremos un registro nuevo en la base de datos <strong>actividad9</strong>.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">MariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> use actividad9\nReading table information <span class=\"token keyword\">for</span> completion of table and <span class=\"token function\">column</span> names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\n\nMariaDB <span class=\"token punctuation\">[</span>actividad9<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> insert into usuarios\n    -<span class=\"token operator\">></span> values <span class=\"token punctuation\">(</span><span class=\"token string\">'49132054Y'</span>,<span class=\"token string\">'Francisco Javier'</span>,<span class=\"token string\">'Madueño Jurado'</span>,<span class=\"token string\">'651127289'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nQuery OK, <span class=\"token number\">1</span> row affected <span class=\"token punctuation\">(</span><span class=\"token number\">0.003</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Vamos a ver si se ha realizado bien el trigger checkeando la tabla de accesos:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">MariaDB <span class=\"token punctuation\">[</span><span class=\"token punctuation\">(</span>none<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> use auditorias\nReading table information <span class=\"token keyword\">for</span> completion of table and <span class=\"token function\">column</span> names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMariaDB <span class=\"token punctuation\">[</span>auditorias<span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token keyword\">select</span> * from accesos<span class=\"token punctuation\">;</span>\n+--------+----------------+---------------------+\n<span class=\"token operator\">|</span> codigo <span class=\"token operator\">|</span> usuario        <span class=\"token operator\">|</span> fecha               <span class=\"token operator\">|</span>\n+--------+----------------+---------------------+\n<span class=\"token operator\">|</span>      <span class=\"token number\">1</span> <span class=\"token operator\">|</span> root@localhost <span class=\"token operator\">|</span> <span class=\"token number\">2021</span>-03-11 <span class=\"token number\">20</span>:09:34 <span class=\"token operator\">|</span>\n+--------+----------------+---------------------+\n<span class=\"token number\">1</span> row <span class=\"token keyword\">in</span> <span class=\"token builtin class-name\">set</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.001</span> sec<span class=\"token punctuation\">)</span></code></pre></div>\n<p>Como podemos ver la practica es similar a postgres y a su vez bastante diferente a Oracle, Oracle cuenta con auditorias integradas mientras que Postgres y Mariadb es necesario la utilizacion de triggers y/o procedimeintos.</p>\n<h2 id=\"10--averigua-las-posibilidades-que-ofrece-mongodb-para-auditar-los-cambios-que-va-sufriendo-un-documento\"><a href=\"#10--averigua-las-posibilidades-que-ofrece-mongodb-para-auditar-los-cambios-que-va-sufriendo-un-documento\" aria-label=\"10  averigua las posibilidades que ofrece mongodb para auditar los cambios que va sufriendo un documento permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>10.  Averigua las posibilidades que ofrece MongoDB para auditar los cambios que va sufriendo un documento.</h2>\n<p>Para comprobar en mongo el tipo de autorias que dispone utilizaremos el siguiente comando:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">--auditFilter</code></pre></div>\n<p>Para auditar las acciones createColletion y dropCollection:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">{</span> atype: <span class=\"token punctuation\">{</span> <span class=\"token variable\">$in</span><span class=\"token builtin class-name\">:</span> <span class=\"token punctuation\">[</span> <span class=\"token string\">\"createCollection\"</span>, <span class=\"token string\">\"dropCollection\"</span> <span class=\"token punctuation\">]</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Filtros:</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mongod --dbpath data/db --auditDestination <span class=\"token function\">file</span> --auditFilter <span class=\"token string\">'{ atype: { <span class=\"token variable\">$in</span>: [ \"createCollection\", \"dropCollection\" ] } }'</span> --auditFormat BSON --auditPath data/db/auditLog.bson</code></pre></div>\n<ul>\n<li><a href=\"https://docs.mongodb.com/manual/tutorial/configure-audit-filters/\">Documentación oficial.</a></li>\n</ul>\n<h2 id=\"11--averigua-si-en-mongodb-se-pueden-auditar-los-accesos-al-sistema\"><a href=\"#11--averigua-si-en-mongodb-se-pueden-auditar-los-accesos-al-sistema\" aria-label=\"11  averigua si en mongodb se pueden auditar los accesos al sistema permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>11.  Averigua si en MongoDB se pueden auditar los accesos al sistema.</h2>\n<p>Es posible,cambiando los parámetros de los comandos expuestos anteriormente.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token punctuation\">{</span> atype: <span class=\"token string\">\"authenticate\"</span>, <span class=\"token string\">\"param.db\"</span><span class=\"token builtin class-name\">:</span> <span class=\"token string\">\"test\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>Podemos usarlos como una cadena si lo ponemos entre comillas simples.</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">mongod --dbpath data/db --auth --auditDestination <span class=\"token function\">file</span> --auditFilter <span class=\"token string\">'{ atype: \"authenticate\", \"param.db\": \"test\" }'</span> --auditFormat BSON --auditPath data/db/auditLog.bson</code></pre></div>","timeToRead":14,"excerpt":"Realiza y documenta adecuadamente las siguientes operaciones: 1. Activa desde SQL*Plus la auditoría de los intentos de acceso fallidos al…","frontmatter":{"title":"[ABD] Práctica 7 - Auditorías","cover":"https://img.icons8.com/ios/452/work.png","date":"2021-03-09T00:00:00.000Z","categories":["ABD"],"tags":["Auditorías"]},"fields":{"slug":"/abd-practica-7-auditorias","date":"March 08, 2021"}}},"pageContext":{"slug":"/abd-practica-7-auditorias","nexttitle":"[ABD] - Práctica 6 Almacenamiento","nextslug":"/abd-practica-6-almacenamiento","prevtitle":"Práctica 2: rclone - Gestionando nuestro almacenamiento en la nube (unidad 1)","prevslug":"/practica-2-rclone-gestionando-nuestro-almacenamiento-en-la-nube-unidad-1"}}}